!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.elliptic=a()}}(function(){return function(){function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}return a}()({1:[function(a,b,c){"use strict";var d=c;d.version=a("../package.json").version,d.utils=a("./elliptic/utils"),d.curve=a("./elliptic/curve"),d.curves=a("./elliptic/curves"),d.ec=a("./elliptic/ec"),d.eddsa=a("./elliptic/eddsa")},{"../package.json":83,"./elliptic/curve":4,"./elliptic/curves":7,"./elliptic/ec":8,"./elliptic/eddsa":11,"./elliptic/utils":15}],2:[function(a,b,c){"use strict";function d(a,b){this.type=a,this.p=new f(b.p,16),this.red=b.prime?f.red(b.prime):f.mont(this.p),this.zero=new f(0).toRed(this.red),this.one=new f(1).toRed(this.red),this.two=new f(2).toRed(this.red),this.n=b.n&&new f(b.n,16),this.g=b.g&&this.pointFromJSON(b.g,b.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var c=this.n&&this.p.div(this.n);!c||c.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function e(a,b){this.curve=a,this.type=b,this.precomputed=null}var f=a("bn.js"),g=a("../utils"),h=g.getNAF,i=g.getJSF,j=g.assert;b.exports=d,d.prototype.point=function(){throw new Error("Not implemented")},d.prototype.validate=function(){throw new Error("Not implemented")},d.prototype._fixedNafMul=function(a,b){j(a.precomputed);var c=a._getDoubles(),d=h(b,1,this._bitLength),e=(1<<c.step+1)-(c.step%2===0?2:1);e/=3;for(var f=[],g=0;g<d.length;g+=c.step){for(var i=0,b=g+c.step-1;b>=g;b--)i=(i<<1)+d[b];f.push(i)}for(var k=this.jpoint(null,null,null),l=this.jpoint(null,null,null),m=e;m>0;m--){for(var g=0;g<f.length;g++){var i=f[g];i===m?l=l.mixedAdd(c.points[g]):i===-m&&(l=l.mixedAdd(c.points[g].neg()))}k=k.add(l)}return k.toP()},d.prototype._wnafMul=function(a,b){var c=4,d=a._getNAFPoints(c);c=d.wnd;for(var e=d.points,f=h(b,c,this._bitLength),g=this.jpoint(null,null,null),i=f.length-1;i>=0;i--){for(var b=0;i>=0&&0===f[i];i--)b++;if(i>=0&&b++,g=g.dblp(b),i<0)break;var k=f[i];j(0!==k),g="affine"===a.type?k>0?g.mixedAdd(e[k-1>>1]):g.mixedAdd(e[-k-1>>1].neg()):k>0?g.add(e[k-1>>1]):g.add(e[-k-1>>1].neg())}return"affine"===a.type?g.toP():g},d.prototype._wnafMulAdd=function(a,b,c,d,e){for(var f=this._wnafT1,g=this._wnafT2,j=this._wnafT3,k=0,l=0;l<d;l++){var m=b[l],n=m._getNAFPoints(a);f[l]=n.wnd,g[l]=n.points}for(var l=d-1;l>=1;l-=2){var o=l-1,p=l;if(1===f[o]&&1===f[p]){var q=[b[o],null,null,b[p]];0===b[o].y.cmp(b[p].y)?(q[1]=b[o].add(b[p]),q[2]=b[o].toJ().mixedAdd(b[p].neg())):0===b[o].y.cmp(b[p].y.redNeg())?(q[1]=b[o].toJ().mixedAdd(b[p]),q[2]=b[o].add(b[p].neg())):(q[1]=b[o].toJ().mixedAdd(b[p]),q[2]=b[o].toJ().mixedAdd(b[p].neg()));var r=[-3,-1,-5,-7,0,7,5,1,3],s=i(c[o],c[p]);k=Math.max(s[0].length,k),j[o]=new Array(k),j[p]=new Array(k);for(var t=0;t<k;t++){var u=0|s[0][t],v=0|s[1][t];j[o][t]=r[3*(u+1)+(v+1)],j[p][t]=0,g[o]=q}}else j[o]=h(c[o],f[o],this._bitLength),j[p]=h(c[p],f[p],this._bitLength),k=Math.max(j[o].length,k),k=Math.max(j[p].length,k)}for(var w=this.jpoint(null,null,null),x=this._wnafT4,l=k;l>=0;l--){for(var y=0;l>=0;){for(var z=!0,t=0;t<d;t++)x[t]=0|j[t][l],0!==x[t]&&(z=!1);if(!z)break;y++,l--}if(l>=0&&y++,w=w.dblp(y),l<0)break;for(var t=0;t<d;t++){var m,A=x[t];0!==A&&(A>0?m=g[t][A-1>>1]:A<0&&(m=g[t][-A-1>>1].neg()),w="affine"===m.type?w.mixedAdd(m):w.add(m))}}for(var l=0;l<d;l++)g[l]=null;return e?w:w.toP()},d.BasePoint=e,e.prototype.eq=function(){throw new Error("Not implemented")},e.prototype.validate=function(){return this.curve.validate(this)},d.prototype.decodePoint=function(a,b){a=g.toArray(a,b);var c=this.p.byteLength();if((4===a[0]||6===a[0]||7===a[0])&&a.length-1===2*c){6===a[0]?j(a[a.length-1]%2===0):7===a[0]&&j(a[a.length-1]%2===1);var d=this.point(a.slice(1,1+c),a.slice(1+c,1+2*c));return d}if((2===a[0]||3===a[0])&&a.length-1===c)return this.pointFromX(a.slice(1,1+c),3===a[0]);throw new Error("Unknown point format")},e.prototype.encodeCompressed=function(a){return this.encode(a,!0)},e.prototype._encode=function(a){var b=this.curve.p.byteLength(),c=this.getX().toArray("be",b);return a?[this.getY().isEven()?2:3].concat(c):[4].concat(c,this.getY().toArray("be",b))},e.prototype.encode=function(a,b){return g.encode(this._encode(b),a)},e.prototype.precompute=function(a){if(this.precomputed)return this;var b={doubles:null,naf:null,beta:null};return b.naf=this._getNAFPoints(8),b.doubles=this._getDoubles(4,a),b.beta=this._getBeta(),this.precomputed=b,this},e.prototype._hasDoubles=function(a){if(!this.precomputed)return!1;var b=this.precomputed.doubles;return!!b&&b.points.length>=Math.ceil((a.bitLength()+1)/b.step)},e.prototype._getDoubles=function(a,b){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var c=[this],d=this,e=0;e<b;e+=a){for(var f=0;f<a;f++)d=d.dbl();c.push(d)}return{step:a,points:c}},e.prototype._getNAFPoints=function(a){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var b=[this],c=(1<<a)-1,d=1===c?null:this.dbl(),e=1;e<c;e++)b[e]=b[e-1].add(d);return{wnd:a,points:b}},e.prototype._getBeta=function(){return null},e.prototype.dblp=function(a){for(var b=this,c=0;c<a;c++)b=b.dbl();return b}},{"../utils":15,"bn.js":17}],3:[function(a,b,c){"use strict";function d(a){this.twisted=1!==(0|a.a),this.mOneA=this.twisted&&(0|a.a)===-1,this.extended=this.mOneA,i.call(this,"edwards",a),this.a=new g(a.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new g(a.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new g(a.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),j(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1===(0|a.c)}function e(a,b,c,d,e){i.BasePoint.call(this,a,"projective"),null===b&&null===c&&null===d?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new g(b,16),this.y=new g(c,16),this.z=d?new g(d,16):this.curve.one,this.t=e&&new g(e,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}var f=a("../utils"),g=a("bn.js"),h=a("inherits"),i=a("./base"),j=f.assert;h(d,i),b.exports=d,d.prototype._mulA=function(a){return this.mOneA?a.redNeg():this.a.redMul(a)},d.prototype._mulC=function(a){return this.oneC?a:this.c.redMul(a)},d.prototype.jpoint=function(a,b,c,d){return this.point(a,b,c,d)},d.prototype.pointFromX=function(a,b){a=new g(a,16),a.red||(a=a.toRed(this.red));var c=a.redSqr(),d=this.c2.redSub(this.a.redMul(c)),e=this.one.redSub(this.c2.redMul(this.d).redMul(c)),f=d.redMul(e.redInvm()),h=f.redSqrt();if(0!==h.redSqr().redSub(f).cmp(this.zero))throw new Error("invalid point");var i=h.fromRed().isOdd();return(b&&!i||!b&&i)&&(h=h.redNeg()),this.point(a,h)},d.prototype.pointFromY=function(a,b){a=new g(a,16),a.red||(a=a.toRed(this.red));var c=a.redSqr(),d=c.redSub(this.c2),e=c.redMul(this.d).redMul(this.c2).redSub(this.a),f=d.redMul(e.redInvm());if(0===f.cmp(this.zero)){if(b)throw new Error("invalid point");return this.point(this.zero,a)}var h=f.redSqrt();if(0!==h.redSqr().redSub(f).cmp(this.zero))throw new Error("invalid point");return h.fromRed().isOdd()!==b&&(h=h.redNeg()),this.point(h,a)},d.prototype.validate=function(a){if(a.isInfinity())return!0;a.normalize();var b=a.x.redSqr(),c=a.y.redSqr(),d=b.redMul(this.a).redAdd(c),e=this.c2.redMul(this.one.redAdd(this.d.redMul(b).redMul(c)));return 0===d.cmp(e)},h(e,i.BasePoint),d.prototype.pointFromJSON=function(a){return e.fromJSON(this,a)},d.prototype.point=function(a,b,c,d){return new e(this,a,b,c,d)},e.fromJSON=function(a,b){return new e(a,b[0],b[1],b[2])},e.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},e.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},e.prototype._extDbl=function(){var a=this.x.redSqr(),b=this.y.redSqr(),c=this.z.redSqr();c=c.redIAdd(c);var d=this.curve._mulA(a),e=this.x.redAdd(this.y).redSqr().redISub(a).redISub(b),f=d.redAdd(b),g=f.redSub(c),h=d.redSub(b),i=e.redMul(g),j=f.redMul(h),k=e.redMul(h),l=g.redMul(f);return this.curve.point(i,j,l,k)},e.prototype._projDbl=function(){var a,b,c,d=this.x.redAdd(this.y).redSqr(),e=this.x.redSqr(),f=this.y.redSqr();if(this.curve.twisted){var g=this.curve._mulA(e),h=g.redAdd(f);if(this.zOne)a=d.redSub(e).redSub(f).redMul(h.redSub(this.curve.two)),b=h.redMul(g.redSub(f)),c=h.redSqr().redSub(h).redSub(h);else{var i=this.z.redSqr(),j=h.redSub(i).redISub(i);a=d.redSub(e).redISub(f).redMul(j),b=h.redMul(g.redSub(f)),c=h.redMul(j)}}else{var g=e.redAdd(f),i=this.curve._mulC(this.z).redSqr(),j=g.redSub(i).redSub(i);a=this.curve._mulC(d.redISub(g)).redMul(j),b=this.curve._mulC(g).redMul(e.redISub(f)),c=g.redMul(j)}return this.curve.point(a,b,c)},e.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},e.prototype._extAdd=function(a){var b=this.y.redSub(this.x).redMul(a.y.redSub(a.x)),c=this.y.redAdd(this.x).redMul(a.y.redAdd(a.x)),d=this.t.redMul(this.curve.dd).redMul(a.t),e=this.z.redMul(a.z.redAdd(a.z)),f=c.redSub(b),g=e.redSub(d),h=e.redAdd(d),i=c.redAdd(b),j=f.redMul(g),k=h.redMul(i),l=f.redMul(i),m=g.redMul(h);return this.curve.point(j,k,m,l)},e.prototype._projAdd=function(a){var b,c,d=this.z.redMul(a.z),e=d.redSqr(),f=this.x.redMul(a.x),g=this.y.redMul(a.y),h=this.curve.d.redMul(f).redMul(g),i=e.redSub(h),j=e.redAdd(h),k=this.x.redAdd(this.y).redMul(a.x.redAdd(a.y)).redISub(f).redISub(g),l=d.redMul(i).redMul(k);return this.curve.twisted?(b=d.redMul(j).redMul(g.redSub(this.curve._mulA(f))),c=i.redMul(j)):(b=d.redMul(j).redMul(g.redSub(f)),c=this.curve._mulC(i).redMul(j)),this.curve.point(l,b,c)},e.prototype.add=function(a){return this.isInfinity()?a:a.isInfinity()?this:this.curve.extended?this._extAdd(a):this._projAdd(a)},e.prototype.mul=function(a){return this._hasDoubles(a)?this.curve._fixedNafMul(this,a):this.curve._wnafMul(this,a)},e.prototype.mulAdd=function(a,b,c){return this.curve._wnafMulAdd(1,[this,b],[a,c],2,!1)},e.prototype.jmulAdd=function(a,b,c){return this.curve._wnafMulAdd(1,[this,b],[a,c],2,!0)},e.prototype.normalize=function(){if(this.zOne)return this;var a=this.z.redInvm();return this.x=this.x.redMul(a),this.y=this.y.redMul(a),this.t&&(this.t=this.t.redMul(a)),this.z=this.curve.one,this.zOne=!0,this},e.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},e.prototype.getX=function(){return this.normalize(),this.x.fromRed()},e.prototype.getY=function(){return this.normalize(),this.y.fromRed()},e.prototype.eq=function(a){return this===a||0===this.getX().cmp(a.getX())&&0===this.getY().cmp(a.getY())},e.prototype.eqXToP=function(a){var b=a.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(b))return!0;for(var c=a.clone(),d=this.curve.redN.redMul(this.z);;){if(c.iadd(this.curve.n),c.cmp(this.curve.p)>=0)return!1;if(b.redIAdd(d),0===this.x.cmp(b))return!0}},e.prototype.toP=e.prototype.normalize,e.prototype.mixedAdd=e.prototype.add},{"../utils":15,"./base":2,"bn.js":17,inherits:34}],4:[function(a,b,c){"use strict";var d=c;d.base=a("./base"),d["short"]=a("./short"),d.mont=a("./mont"),d.edwards=a("./edwards")},{"./base":2,"./edwards":3,"./mont":5,"./short":6}],5:[function(a,b,c){"use strict";function d(a){h.call(this,"mont",a),this.a=new f(a.a,16).toRed(this.red),this.b=new f(a.b,16).toRed(this.red),this.i4=new f(4).toRed(this.red).redInvm(),this.two=new f(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function e(a,b,c){h.BasePoint.call(this,a,"projective"),null===b&&null===c?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new f(b,16),this.z=new f(c,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}var f=a("bn.js"),g=a("inherits"),h=a("./base"),i=a("../utils");g(d,h),b.exports=d,d.prototype.validate=function(a){var b=a.normalize().x,c=b.redSqr(),d=c.redMul(b).redAdd(c.redMul(this.a)).redAdd(b),e=d.redSqrt();return 0===e.redSqr().cmp(d)},g(e,h.BasePoint),d.prototype.decodePoint=function(a,b){return this.point(i.toArray(a,b),1)},d.prototype.point=function(a,b){return new e(this,a,b)},d.prototype.pointFromJSON=function(a){return e.fromJSON(this,a)},e.prototype.precompute=function(){},e.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},e.fromJSON=function(a,b){return new e(a,b[0],b[1]||a.one)},e.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},e.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},e.prototype.dbl=function(){var a=this.x.redAdd(this.z),b=a.redSqr(),c=this.x.redSub(this.z),d=c.redSqr(),e=b.redSub(d),f=b.redMul(d),g=e.redMul(d.redAdd(this.curve.a24.redMul(e)));return this.curve.point(f,g)},e.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},e.prototype.diffAdd=function(a,b){var c=this.x.redAdd(this.z),d=this.x.redSub(this.z),e=a.x.redAdd(a.z),f=a.x.redSub(a.z),g=f.redMul(c),h=e.redMul(d),i=b.z.redMul(g.redAdd(h).redSqr()),j=b.x.redMul(g.redISub(h).redSqr());return this.curve.point(i,j)},e.prototype.mul=function(a){for(var b=a.clone(),c=this,d=this.curve.point(null,null),e=this,f=[];0!==b.cmpn(0);b.iushrn(1))f.push(b.andln(1));for(var g=f.length-1;g>=0;g--)0===f[g]?(c=c.diffAdd(d,e),d=d.dbl()):(d=c.diffAdd(d,e),c=c.dbl());return d},e.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},e.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},e.prototype.eq=function(a){return 0===this.getX().cmp(a.getX())},e.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},e.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":15,"./base":2,"bn.js":17,inherits:34}],6:[function(a,b,c){"use strict";function d(a){j.call(this,"short",a),this.a=new h(a.a,16).toRed(this.red),this.b=new h(a.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(a),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function e(a,b,c,d){j.BasePoint.call(this,a,"affine"),null===b&&null===c?(this.x=null,this.y=null,this.inf=!0):(this.x=new h(b,16),this.y=new h(c,16),d&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function f(a,b,c,d){j.BasePoint.call(this,a,"jacobian"),null===b&&null===c&&null===d?(this.x=this.curve.one,this.y=this.curve.one,this.z=new h(0)):(this.x=new h(b,16),this.y=new h(c,16),this.z=new h(d,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}var g=a("../utils"),h=a("bn.js"),i=a("inherits"),j=a("./base"),k=g.assert;i(d,j),b.exports=d,d.prototype._getEndomorphism=function(a){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var b,c;if(a.beta)b=new h(a.beta,16).toRed(this.red);else{var d=this._getEndoRoots(this.p);b=d[0].cmp(d[1])<0?d[0]:d[1],b=b.toRed(this.red)}if(a.lambda)c=new h(a.lambda,16);else{var e=this._getEndoRoots(this.n);0===this.g.mul(e[0]).x.cmp(this.g.x.redMul(b))?c=e[0]:(c=e[1],k(0===this.g.mul(c).x.cmp(this.g.x.redMul(b))))}var f;return f=a.basis?a.basis.map(function(a){return{a:new h(a.a,16),b:new h(a.b,16)}}):this._getEndoBasis(c),{beta:b,lambda:c,basis:f}}},d.prototype._getEndoRoots=function(a){var b=a===this.p?this.red:h.mont(a),c=new h(2).toRed(b).redInvm(),d=c.redNeg(),e=new h(3).toRed(b).redNeg().redSqrt().redMul(c),f=d.redAdd(e).fromRed(),g=d.redSub(e).fromRed();return[f,g]},d.prototype._getEndoBasis=function(a){for(var b,c,d,e,f,g,i,j,k,l=this.n.ushrn(Math.floor(this.n.bitLength()/2)),m=a,n=this.n.clone(),o=new h(1),p=new h(0),q=new h(0),r=new h(1),s=0;0!==m.cmpn(0);){var t=n.div(m);j=n.sub(t.mul(m)),k=q.sub(t.mul(o));var u=r.sub(t.mul(p));if(!d&&j.cmp(l)<0)b=i.neg(),c=o,d=j.neg(),e=k;else if(d&&2===++s)break;i=j,n=m,m=j,q=o,o=k,r=p,p=u}f=j.neg(),g=k;var v=d.sqr().add(e.sqr()),w=f.sqr().add(g.sqr());return w.cmp(v)>=0&&(f=b,g=c),d.negative&&(d=d.neg(),e=e.neg()),f.negative&&(f=f.neg(),g=g.neg()),[{a:d,b:e},{a:f,b:g}]},d.prototype._endoSplit=function(a){var b=this.endo.basis,c=b[0],d=b[1],e=d.b.mul(a).divRound(this.n),f=c.b.neg().mul(a).divRound(this.n),g=e.mul(c.a),h=f.mul(d.a),i=e.mul(c.b),j=f.mul(d.b),k=a.sub(g).sub(h),l=i.add(j).neg();return{k1:k,k2:l}},d.prototype.pointFromX=function(a,b){a=new h(a,16),a.red||(a=a.toRed(this.red));var c=a.redSqr().redMul(a).redIAdd(a.redMul(this.a)).redIAdd(this.b),d=c.redSqrt();if(0!==d.redSqr().redSub(c).cmp(this.zero))throw new Error("invalid point");var e=d.fromRed().isOdd();return(b&&!e||!b&&e)&&(d=d.redNeg()),this.point(a,d)},d.prototype.validate=function(a){if(a.inf)return!0;var b=a.x,c=a.y,d=this.a.redMul(b),e=b.redSqr().redMul(b).redIAdd(d).redIAdd(this.b);return 0===c.redSqr().redISub(e).cmpn(0)},d.prototype._endoWnafMulAdd=function(a,b,c){for(var d=this._endoWnafT1,e=this._endoWnafT2,f=0;f<a.length;f++){var g=this._endoSplit(b[f]),h=a[f],i=h._getBeta();g.k1.negative&&(g.k1.ineg(),h=h.neg(!0)),g.k2.negative&&(g.k2.ineg(),i=i.neg(!0)),d[2*f]=h,d[2*f+1]=i,e[2*f]=g.k1,e[2*f+1]=g.k2}for(var j=this._wnafMulAdd(1,d,e,2*f,c),k=0;k<2*f;k++)d[k]=null,e[k]=null;return j},i(e,j.BasePoint),d.prototype.point=function(a,b,c){return new e(this,a,b,c)},d.prototype.pointFromJSON=function(a,b){return e.fromJSON(this,a,b)},e.prototype._getBeta=function(){if(this.curve.endo){var a=this.precomputed;if(a&&a.beta)return a.beta;var b=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(a){var c=this.curve,d=function(a){return c.point(a.x.redMul(c.endo.beta),a.y)};a.beta=b,b.precomputed={beta:null,naf:a.naf&&{wnd:a.naf.wnd,points:a.naf.points.map(d)},doubles:a.doubles&&{step:a.doubles.step,points:a.doubles.points.map(d)}}}return b}},e.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},e.fromJSON=function(a,b,c){function d(b){return a.point(b[0],b[1],c)}"string"==typeof b&&(b=JSON.parse(b));var e=a.point(b[0],b[1],c);if(!b[2])return e;var f=b[2];return e.precomputed={beta:null,doubles:f.doubles&&{step:f.doubles.step,points:[e].concat(f.doubles.points.map(d))},naf:f.naf&&{wnd:f.naf.wnd,points:[e].concat(f.naf.points.map(d))}},e},e.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},e.prototype.isInfinity=function(){return this.inf},e.prototype.add=function(a){if(this.inf)return a;if(a.inf)return this;if(this.eq(a))return this.dbl();if(this.neg().eq(a))return this.curve.point(null,null);if(0===this.x.cmp(a.x))return this.curve.point(null,null);var b=this.y.redSub(a.y);0!==b.cmpn(0)&&(b=b.redMul(this.x.redSub(a.x).redInvm()));var c=b.redSqr().redISub(this.x).redISub(a.x),d=b.redMul(this.x.redSub(c)).redISub(this.y);return this.curve.point(c,d)},e.prototype.dbl=function(){if(this.inf)return this;var a=this.y.redAdd(this.y);if(0===a.cmpn(0))return this.curve.point(null,null);var b=this.curve.a,c=this.x.redSqr(),d=a.redInvm(),e=c.redAdd(c).redIAdd(c).redIAdd(b).redMul(d),f=e.redSqr().redISub(this.x.redAdd(this.x)),g=e.redMul(this.x.redSub(f)).redISub(this.y);return this.curve.point(f,g)},e.prototype.getX=function(){return this.x.fromRed()},e.prototype.getY=function(){return this.y.fromRed()},e.prototype.mul=function(a){return a=new h(a,16),this.isInfinity()?this:this._hasDoubles(a)?this.curve._fixedNafMul(this,a):this.curve.endo?this.curve._endoWnafMulAdd([this],[a]):this.curve._wnafMul(this,a)},e.prototype.mulAdd=function(a,b,c){var d=[this,b],e=[a,c];return this.curve.endo?this.curve._endoWnafMulAdd(d,e):this.curve._wnafMulAdd(1,d,e,2)},e.prototype.jmulAdd=function(a,b,c){var d=[this,b],e=[a,c];return this.curve.endo?this.curve._endoWnafMulAdd(d,e,!0):this.curve._wnafMulAdd(1,d,e,2,!0)},e.prototype.eq=function(a){return this===a||this.inf===a.inf&&(this.inf||0===this.x.cmp(a.x)&&0===this.y.cmp(a.y))},e.prototype.neg=function(a){if(this.inf)return this;var b=this.curve.point(this.x,this.y.redNeg());if(a&&this.precomputed){var c=this.precomputed,d=function(a){return a.neg()};b.precomputed={naf:c.naf&&{wnd:c.naf.wnd,points:c.naf.points.map(d)},doubles:c.doubles&&{step:c.doubles.step,points:c.doubles.points.map(d)}}}return b},e.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var a=this.curve.jpoint(this.x,this.y,this.curve.one);return a},i(f,j.BasePoint),d.prototype.jpoint=function(a,b,c){return new f(this,a,b,c)},f.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var a=this.z.redInvm(),b=a.redSqr(),c=this.x.redMul(b),d=this.y.redMul(b).redMul(a);return this.curve.point(c,d)},f.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},f.prototype.add=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var b=a.z.redSqr(),c=this.z.redSqr(),d=this.x.redMul(b),e=a.x.redMul(c),f=this.y.redMul(b.redMul(a.z)),g=a.y.redMul(c.redMul(this.z)),h=d.redSub(e),i=f.redSub(g);if(0===h.cmpn(0))return 0!==i.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var j=h.redSqr(),k=j.redMul(h),l=d.redMul(j),m=i.redSqr().redIAdd(k).redISub(l).redISub(l),n=i.redMul(l.redISub(m)).redISub(f.redMul(k)),o=this.z.redMul(a.z).redMul(h);return this.curve.jpoint(m,n,o)},f.prototype.mixedAdd=function(a){if(this.isInfinity())return a.toJ();if(a.isInfinity())return this;var b=this.z.redSqr(),c=this.x,d=a.x.redMul(b),e=this.y,f=a.y.redMul(b).redMul(this.z),g=c.redSub(d),h=e.redSub(f);if(0===g.cmpn(0))return 0!==h.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var i=g.redSqr(),j=i.redMul(g),k=c.redMul(i),l=h.redSqr().redIAdd(j).redISub(k).redISub(k),m=h.redMul(k.redISub(l)).redISub(e.redMul(j)),n=this.z.redMul(g);return this.curve.jpoint(l,m,n)},f.prototype.dblp=function(a){if(0===a)return this;if(this.isInfinity())return this;if(!a)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var b=this,c=0;c<a;c++)b=b.dbl();return b}for(var d=this.curve.a,e=this.curve.tinv,f=this.x,g=this.y,h=this.z,i=h.redSqr().redSqr(),j=g.redAdd(g),c=0;c<a;c++){var k=f.redSqr(),l=j.redSqr(),m=l.redSqr(),n=k.redAdd(k).redIAdd(k).redIAdd(d.redMul(i)),o=f.redMul(l),p=n.redSqr().redISub(o.redAdd(o)),q=o.redISub(p),r=n.redMul(q);r=r.redIAdd(r).redISub(m);var s=j.redMul(h);c+1<a&&(i=i.redMul(m)),f=p,h=s,j=r}return this.curve.jpoint(f,j.redMul(e),h)},f.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},f.prototype._zeroDbl=function(){var a,b,c;if(this.zOne){var d=this.x.redSqr(),e=this.y.redSqr(),f=e.redSqr(),g=this.x.redAdd(e).redSqr().redISub(d).redISub(f);g=g.redIAdd(g);var h=d.redAdd(d).redIAdd(d),i=h.redSqr().redISub(g).redISub(g),j=f.redIAdd(f);j=j.redIAdd(j),j=j.redIAdd(j),a=i,b=h.redMul(g.redISub(i)).redISub(j),c=this.y.redAdd(this.y)}else{var k=this.x.redSqr(),l=this.y.redSqr(),m=l.redSqr(),n=this.x.redAdd(l).redSqr().redISub(k).redISub(m);n=n.redIAdd(n);var o=k.redAdd(k).redIAdd(k),p=o.redSqr(),q=m.redIAdd(m);q=q.redIAdd(q),q=q.redIAdd(q),a=p.redISub(n).redISub(n),b=o.redMul(n.redISub(a)).redISub(q),c=this.y.redMul(this.z),c=c.redIAdd(c)}return this.curve.jpoint(a,b,c)},f.prototype._threeDbl=function(){var a,b,c;if(this.zOne){var d=this.x.redSqr(),e=this.y.redSqr(),f=e.redSqr(),g=this.x.redAdd(e).redSqr().redISub(d).redISub(f);g=g.redIAdd(g);var h=d.redAdd(d).redIAdd(d).redIAdd(this.curve.a),i=h.redSqr().redISub(g).redISub(g);a=i;var j=f.redIAdd(f);j=j.redIAdd(j),j=j.redIAdd(j),b=h.redMul(g.redISub(i)).redISub(j),c=this.y.redAdd(this.y)}else{var k=this.z.redSqr(),l=this.y.redSqr(),m=this.x.redMul(l),n=this.x.redSub(k).redMul(this.x.redAdd(k));n=n.redAdd(n).redIAdd(n);var o=m.redIAdd(m);o=o.redIAdd(o);var p=o.redAdd(o);a=n.redSqr().redISub(p),c=this.y.redAdd(this.z).redSqr().redISub(l).redISub(k);var q=l.redSqr();q=q.redIAdd(q),q=q.redIAdd(q),q=q.redIAdd(q),b=n.redMul(o.redISub(a)).redISub(q)}return this.curve.jpoint(a,b,c)},f.prototype._dbl=function(){var a=this.curve.a,b=this.x,c=this.y,d=this.z,e=d.redSqr().redSqr(),f=b.redSqr(),g=c.redSqr(),h=f.redAdd(f).redIAdd(f).redIAdd(a.redMul(e)),i=b.redAdd(b);i=i.redIAdd(i);var j=i.redMul(g),k=h.redSqr().redISub(j.redAdd(j)),l=j.redISub(k),m=g.redSqr();m=m.redIAdd(m),m=m.redIAdd(m),m=m.redIAdd(m);var n=h.redMul(l).redISub(m),o=c.redAdd(c).redMul(d);return this.curve.jpoint(k,n,o)},f.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var a=this.x.redSqr(),b=this.y.redSqr(),c=this.z.redSqr(),d=b.redSqr(),e=a.redAdd(a).redIAdd(a),f=e.redSqr(),g=this.x.redAdd(b).redSqr().redISub(a).redISub(d);g=g.redIAdd(g),g=g.redAdd(g).redIAdd(g),g=g.redISub(f);var h=g.redSqr(),i=d.redIAdd(d);i=i.redIAdd(i),i=i.redIAdd(i),i=i.redIAdd(i);var j=e.redIAdd(g).redSqr().redISub(f).redISub(h).redISub(i),k=b.redMul(j);k=k.redIAdd(k),k=k.redIAdd(k);var l=this.x.redMul(h).redISub(k);l=l.redIAdd(l),l=l.redIAdd(l);var m=this.y.redMul(j.redMul(i.redISub(j)).redISub(g.redMul(h)));m=m.redIAdd(m),m=m.redIAdd(m),m=m.redIAdd(m);var n=this.z.redAdd(g).redSqr().redISub(c).redISub(h);return this.curve.jpoint(l,m,n)},f.prototype.mul=function(a,b){return a=new h(a,b),this.curve._wnafMul(this,a)},f.prototype.eq=function(a){if("affine"===a.type)return this.eq(a.toJ());if(this===a)return!0;var b=this.z.redSqr(),c=a.z.redSqr();if(0!==this.x.redMul(c).redISub(a.x.redMul(b)).cmpn(0))return!1;var d=b.redMul(this.z),e=c.redMul(a.z);return 0===this.y.redMul(e).redISub(a.y.redMul(d)).cmpn(0)},f.prototype.eqXToP=function(a){var b=this.z.redSqr(),c=a.toRed(this.curve.red).redMul(b);if(0===this.x.cmp(c))return!0;for(var d=a.clone(),e=this.curve.redN.redMul(b);;){if(d.iadd(this.curve.n),d.cmp(this.curve.p)>=0)return!1;if(c.redIAdd(e),0===this.x.cmp(c))return!0}},f.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},f.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},{"../utils":15,"./base":2,"bn.js":17,inherits:34}],7:[function(a,b,c){"use strict";function d(a){"short"===a.type?this.curve=new h["short"](a):"edwards"===a.type?this.curve=new h.edwards(a):this.curve=new h.mont(a),this.g=this.curve.g,this.n=this.curve.n,this.hash=a.hash,j(this.g.validate(),"Invalid curve"),j(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function e(a,b){Object.defineProperty(f,a,{configurable:!0,enumerable:!0,get:function(){var c=new d(b);return Object.defineProperty(f,a,{configurable:!0,enumerable:!0,value:c}),c}})}var f=c,g=a("hash.js"),h=a("./curve"),i=a("./utils"),j=i.assert;f.PresetCurve=d,e("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:g.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),e("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:g.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),e("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:g.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),e("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:g.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),e("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:g.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),e("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:g.sha256,gRed:!1,g:["9"]}),e("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:g.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var k;try{k=a("./precomputed/secp256k1");
}catch(l){k=void 0}e("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:g.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",k]})},{"./curve":4,"./precomputed/secp256k1":14,"./utils":15,"hash.js":20}],8:[function(a,b,c){"use strict";function d(a){return this instanceof d?("string"==typeof a&&(i(h.hasOwnProperty(a),"Unknown curve "+a),a=h[a]),a instanceof h.PresetCurve&&(a={curve:a}),this.curve=a.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=a.curve.g,this.g.precompute(a.curve.n.bitLength()+1),void(this.hash=a.hash||a.curve.hash)):new d(a)}var e=a("bn.js"),f=a("hmac-drbg"),g=a("../utils"),h=a("../curves"),i=g.assert,j=a("node-forge"),k=a("buffer/").Buffer,l=a("./key"),m=a("./signature");b.exports=d,d.prototype.keyPair=function(a){return new l(this,a)},d.prototype.keyFromPrivate=function(a,b){return l.fromPrivate(this,a,b)},d.prototype.keyFromPublic=function(a,b){return l.fromPublic(this,a,b)},d.prototype.genKeyPair=function(a){a||(a={});for(var b=j.random.getBytesSync(this.hash.hmacStrength),c=j.util.createBuffer(b,"raw"),d=k.from(c.getBytes(),"binary"),g=new f({hash:this.hash,pers:a.pers,persEnc:a.persEnc||"utf8",entropy:a.entropy||d,entropyEnc:a.entropy&&a.entropyEnc||"utf8",nonce:this.n.toArray()}),b=this.n.byteLength(),h=this.n.sub(new e(2));;){var i=new e(g.generate(b));if(!(i.cmp(h)>0))return i.iaddn(1),this.keyFromPrivate(i)}},d.prototype._truncateToN=function(a,b){var c=8*a.byteLength()-this.n.bitLength();return c>0&&(a=a.ushrn(c)),!b&&a.cmp(this.n)>=0?a.sub(this.n):a},d.prototype.sign=function(a,b,c,d){"object"==typeof c&&(d=c,c=null),d||(d={}),b=this.keyFromPrivate(b,c),a=this._truncateToN(new e(a,16));for(var g=this.n.byteLength(),h=b.getPrivate().toArray("be",g),i=a.toArray("be",g),j=new f({hash:this.hash,entropy:h,nonce:i,pers:d.pers,persEnc:d.persEnc||"utf8"}),k=this.n.sub(new e(1)),l=0;!0;l++){var n=d.k?d.k(l):new e(j.generate(this.n.byteLength()));if(n=this._truncateToN(n,!0),!(n.cmpn(1)<=0||n.cmp(k)>=0)){var o=this.g.mul(n);if(!o.isInfinity()){var p=o.getX(),q=p.umod(this.n);if(0!==q.cmpn(0)){var r=n.invm(this.n).mul(q.mul(b.getPrivate()).iadd(a));if(r=r.umod(this.n),0!==r.cmpn(0)){var s=(o.getY().isOdd()?1:0)|(0!==p.cmp(q)?2:0);return d.canonical&&r.cmp(this.nh)>0&&(r=this.n.sub(r),s^=1),new m({r:q,s:r,recoveryParam:s})}}}}}},d.prototype.verify=function(a,b,c,d){a=this._truncateToN(new e(a,16)),c=this.keyFromPublic(c,d),b=new m(b,"hex");var f=b.r,g=b.s;if(f.cmpn(1)<0||f.cmp(this.n)>=0)return!1;if(g.cmpn(1)<0||g.cmp(this.n)>=0)return!1;var h=g.invm(this.n),i=h.mul(a).umod(this.n),j=h.mul(f).umod(this.n);if(!this.curve._maxwellTrick){var k=this.g.mulAdd(i,c.getPublic(),j);return!k.isInfinity()&&0===k.getX().umod(this.n).cmp(f)}var k=this.g.jmulAdd(i,c.getPublic(),j);return!k.isInfinity()&&k.eqXToP(f)},d.prototype.recoverPubKey=function(a,b,c,d){i((3&c)===c,"The recovery param is more than two bits"),b=new m(b,d);var f=this.n,g=new e(a),h=b.r,j=b.s,k=1&c,l=c>>1;if(h.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");h=l?this.curve.pointFromX(h.add(this.curve.n),k):this.curve.pointFromX(h,k);var n=b.r.invm(f),o=f.sub(g).mul(n).umod(f),p=j.mul(n).umod(f);return this.g.mulAdd(o,h,p)},d.prototype.getKeyRecoveryParam=function(a,b,c,d){if(b=new m(b,d),null!==b.recoveryParam)return b.recoveryParam;for(var e=0;e<4;e++){var f;try{f=this.recoverPubKey(a,b,e)}catch(a){continue}if(f.eq(c))return e}throw new Error("Unable to find valid recovery factor")}},{"../curves":7,"../utils":15,"./key":9,"./signature":10,"bn.js":17,"buffer/":19,"hmac-drbg":32,"node-forge":49}],9:[function(a,b,c){"use strict";function d(a,b){this.ec=a,this.priv=null,this.pub=null,b.priv&&this._importPrivate(b.priv,b.privEnc),b.pub&&this._importPublic(b.pub,b.pubEnc)}var e=a("bn.js"),f=a("../utils"),g=f.assert;b.exports=d,d.fromPublic=function(a,b,c){return b instanceof d?b:new d(a,{pub:b,pubEnc:c})},d.fromPrivate=function(a,b,c){return b instanceof d?b:new d(a,{priv:b,privEnc:c})},d.prototype.validate=function(){var a=this.getPublic();return a.isInfinity()?{result:!1,reason:"Invalid public key"}:a.validate()?a.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},d.prototype.getPublic=function(a,b){return"string"==typeof a&&(b=a,a=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),b?this.pub.encode(b,a):this.pub},d.prototype.getPrivate=function(a){return"hex"===a?this.priv.toString(16,2):this.priv},d.prototype._importPrivate=function(a,b){this.priv=new e(a,b||16),this.priv=this.priv.umod(this.ec.curve.n)},d.prototype._importPublic=function(a,b){return a.x||a.y?("mont"===this.ec.curve.type?g(a.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||g(a.x&&a.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(a.x,a.y))):void(this.pub=this.ec.curve.decodePoint(a,b))},d.prototype.derive=function(a){return a.mul(this.priv).getX()},d.prototype.sign=function(a,b,c){return this.ec.sign(a,this,b,c)},d.prototype.verify=function(a,b){return this.ec.verify(a,b,this)},d.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":15,"bn.js":17}],10:[function(a,b,c){"use strict";function d(a,b){return a instanceof d?a:void(this._importDER(a,b)||(k(a.r&&a.s,"Signature without r or s"),this.r=new i(a.r,16),this.s=new i(a.s,16),void 0===a.recoveryParam?this.recoveryParam=null:this.recoveryParam=a.recoveryParam))}function e(){this.place=0}function f(a,b){var c=a[b.place++];if(!(128&c))return c;for(var d=15&c,e=0,f=0,g=b.place;f<d;f++,g++)e<<=8,e|=a[g];return b.place=g,e}function g(a){for(var b=0,c=a.length-1;!a[b]&&!(128&a[b+1])&&b<c;)b++;return 0===b?a:a.slice(b)}function h(a,b){if(b<128)return void a.push(b);var c=1+(Math.log(b)/Math.LN2>>>3);for(a.push(128|c);--c;)a.push(b>>>(c<<3)&255);a.push(b)}var i=a("bn.js"),j=a("../utils"),k=j.assert;b.exports=d,d.prototype._importDER=function(a,b){a=j.toArray(a,b);var c=new e;if(48!==a[c.place++])return!1;var d=f(a,c);if(d+c.place!==a.length)return!1;if(2!==a[c.place++])return!1;var g=f(a,c),h=a.slice(c.place,g+c.place);if(c.place+=g,2!==a[c.place++])return!1;var k=f(a,c);if(a.length!==k+c.place)return!1;var l=a.slice(c.place,k+c.place);return 0===h[0]&&128&h[1]&&(h=h.slice(1)),0===l[0]&&128&l[1]&&(l=l.slice(1)),this.r=new i(h),this.s=new i(l),this.recoveryParam=null,!0},d.prototype.toDER=function(a){var b=this.r.toArray(),c=this.s.toArray();for(128&b[0]&&(b=[0].concat(b)),128&c[0]&&(c=[0].concat(c)),b=g(b),c=g(c);!(c[0]||128&c[1]);)c=c.slice(1);var d=[2];h(d,b.length),d=d.concat(b),d.push(2),h(d,c.length);var e=d.concat(c),f=[48];return h(f,e.length),f=f.concat(e),j.encode(f,a)}},{"../utils":15,"bn.js":17}],11:[function(a,b,c){"use strict";function d(a){if(h("ed25519"===a,"only tested with ed25519 so far"),!(this instanceof d))return new d(a);var a=f[a].curve;this.curve=a,this.g=a.g,this.g.precompute(a.n.bitLength()+1),this.pointClass=a.point().constructor,this.encodingLength=Math.ceil(a.n.bitLength()/8),this.hash=e.sha512}var e=a("hash.js"),f=a("../curves"),g=a("../utils"),h=g.assert,i=g.parseBytes,j=a("./key"),k=a("./signature");b.exports=d,d.prototype.sign=function(a,b){a=i(a);var c=this.keyFromSecret(b),d=this.hashInt(c.messagePrefix(),a),e=this.g.mul(d),f=this.encodePoint(e),g=this.hashInt(f,c.pubBytes(),a).mul(c.priv()),h=d.add(g).umod(this.curve.n);return this.makeSignature({R:e,S:h,Rencoded:f})},d.prototype.verify=function(a,b,c){a=i(a),b=this.makeSignature(b);var d=this.keyFromPublic(c),e=this.hashInt(b.Rencoded(),d.pubBytes(),a),f=this.g.mul(b.S()),g=b.R().add(d.pub().mul(e));return g.eq(f)},d.prototype.hashInt=function(){for(var a=this.hash(),b=0;b<arguments.length;b++)a.update(arguments[b]);return g.intFromLE(a.digest()).umod(this.curve.n)},d.prototype.keyFromPublic=function(a){return j.fromPublic(this,a)},d.prototype.keyFromSecret=function(a){return j.fromSecret(this,a)},d.prototype.makeSignature=function(a){return a instanceof k?a:new k(this,a)},d.prototype.encodePoint=function(a){var b=a.getY().toArray("le",this.encodingLength);return b[this.encodingLength-1]|=a.getX().isOdd()?128:0,b},d.prototype.decodePoint=function(a){a=g.parseBytes(a);var b=a.length-1,c=a.slice(0,b).concat(a[b]&-129),d=0!==(128&a[b]),e=g.intFromLE(c);return this.curve.pointFromY(e,d)},d.prototype.encodeInt=function(a){return a.toArray("le",this.encodingLength)},d.prototype.decodeInt=function(a){return g.intFromLE(a)},d.prototype.isPoint=function(a){return a instanceof this.pointClass}},{"../curves":7,"../utils":15,"./key":12,"./signature":13,"hash.js":20}],12:[function(a,b,c){"use strict";function d(a,b){this.eddsa=a,this._secret=g(b.secret),a.isPoint(b.pub)?this._pub=b.pub:this._pubBytes=g(b.pub)}var e=a("../utils"),f=e.assert,g=e.parseBytes,h=e.cachedProperty;d.fromPublic=function(a,b){return b instanceof d?b:new d(a,{pub:b})},d.fromSecret=function(a,b){return b instanceof d?b:new d(a,{secret:b})},d.prototype.secret=function(){return this._secret},h(d,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),h(d,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),h(d,"privBytes",function(){var a=this.eddsa,b=this.hash(),c=a.encodingLength-1,d=b.slice(0,a.encodingLength);return d[0]&=248,d[c]&=127,d[c]|=64,d}),h(d,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),h(d,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),h(d,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),d.prototype.sign=function(a){return f(this._secret,"KeyPair can only verify"),this.eddsa.sign(a,this)},d.prototype.verify=function(a,b){return this.eddsa.verify(a,b,this)},d.prototype.getSecret=function(a){return f(this._secret,"KeyPair is public only"),e.encode(this.secret(),a)},d.prototype.getPublic=function(a){return e.encode(this.pubBytes(),a)},b.exports=d},{"../utils":15}],13:[function(a,b,c){"use strict";function d(a,b){this.eddsa=a,"object"!=typeof b&&(b=i(b)),Array.isArray(b)&&(b={R:b.slice(0,a.encodingLength),S:b.slice(a.encodingLength)}),g(b.R&&b.S,"Signature without R or S"),a.isPoint(b.R)&&(this._R=b.R),b.S instanceof e&&(this._S=b.S),this._Rencoded=Array.isArray(b.R)?b.R:b.Rencoded,this._Sencoded=Array.isArray(b.S)?b.S:b.Sencoded}var e=a("bn.js"),f=a("../utils"),g=f.assert,h=f.cachedProperty,i=f.parseBytes;h(d,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),h(d,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),h(d,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),h(d,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),d.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},d.prototype.toHex=function(){return f.encode(this.toBytes(),"hex").toUpperCase()},b.exports=d},{"../utils":15,"bn.js":17}],14:[function(a,b,c){b.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]
}}},{}],15:[function(a,b,c){"use strict";function d(a,b,c){var d=new Array(Math.max(a.bitLength(),c)+1);d.fill(0);for(var e=1<<b+1,f=a.clone(),g=0;g<d.length;g++){var h,i=f.andln(e-1);f.isOdd()?(h=i>(e>>1)-1?(e>>1)-i:i,f.isubn(h)):h=0,d[g]=h,f.iushrn(1)}return d}function e(a,b){var c=[[],[]];a=a.clone(),b=b.clone();for(var d=0,e=0;a.cmpn(-d)>0||b.cmpn(-e)>0;){var f=a.andln(3)+d&3,g=b.andln(3)+e&3;3===f&&(f=-1),3===g&&(g=-1);var h;if(0===(1&f))h=0;else{var i=a.andln(7)+d&7;h=3!==i&&5!==i||2!==g?f:-f}c[0].push(h);var j;if(0===(1&g))j=0;else{var i=b.andln(7)+e&7;j=3!==i&&5!==i||2!==f?g:-g}c[1].push(j),2*d===h+1&&(d=1-d),2*e===j+1&&(e=1-e),a.iushrn(1),b.iushrn(1)}return c}function f(a,b,c){var d="_"+b;a.prototype[b]=function(){return void 0!==this[d]?this[d]:this[d]=c.call(this)}}function g(a){return"string"==typeof a?i.toArray(a,"hex"):a}function h(a){return new j(a,"hex","le")}var i=c,j=a("bn.js"),k=a("minimalistic-assert"),l=a("minimalistic-crypto-utils");i.assert=k,i.toArray=l.toArray,i.zero2=l.zero2,i.toHex=l.toHex,i.encode=l.encode,i.getNAF=d,i.getJSF=e,i.cachedProperty=f,i.parseBytes=g,i.intFromLE=h},{"bn.js":17,"minimalistic-assert":35,"minimalistic-crypto-utils":36}],16:[function(a,b,c){"use strict";function d(a){var b=a.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");c===-1&&(c=b);var d=c===b?0:4-c%4;return[c,d]}function e(a){var b=d(a),c=b[0],e=b[1];return 3*(c+e)/4-e}function f(a,b,c){return 3*(b+c)/4-c}function g(a){var b,c,e=d(a),g=e[0],h=e[1],i=new m(f(a,g,h)),j=0,k=h>0?g-4:g;for(c=0;c<k;c+=4)b=l[a.charCodeAt(c)]<<18|l[a.charCodeAt(c+1)]<<12|l[a.charCodeAt(c+2)]<<6|l[a.charCodeAt(c+3)],i[j++]=b>>16&255,i[j++]=b>>8&255,i[j++]=255&b;return 2===h&&(b=l[a.charCodeAt(c)]<<2|l[a.charCodeAt(c+1)]>>4,i[j++]=255&b),1===h&&(b=l[a.charCodeAt(c)]<<10|l[a.charCodeAt(c+1)]<<4|l[a.charCodeAt(c+2)]>>2,i[j++]=b>>8&255,i[j++]=255&b),i}function h(a){return k[a>>18&63]+k[a>>12&63]+k[a>>6&63]+k[63&a]}function i(a,b,c){for(var d,e=[],f=b;f<c;f+=3)d=(a[f]<<16&16711680)+(a[f+1]<<8&65280)+(255&a[f+2]),e.push(h(d));return e.join("")}function j(a){for(var b,c=a.length,d=c%3,e=[],f=16383,g=0,h=c-d;g<h;g+=f)e.push(i(a,g,g+f>h?h:g+f));return 1===d?(b=a[c-1],e.push(k[b>>2]+k[b<<4&63]+"==")):2===d&&(b=(a[c-2]<<8)+a[c-1],e.push(k[b>>10]+k[b>>4&63]+k[b<<2&63]+"=")),e.join("")}c.byteLength=e,c.toByteArray=g,c.fromByteArray=j;for(var k=[],l=[],m="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,p=n.length;o<p;++o)k[o]=n[o],l[n.charCodeAt(o)]=o;l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},{}],17:[function(a,b,c){!function(b,c){"use strict";function d(a,b){if(!a)throw new Error(b||"Assertion failed")}function e(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}function f(a,b,c){return f.isBN(a)?a:(this.negative=0,this.words=null,this.length=0,this.red=null,void(null!==a&&("le"!==b&&"be"!==b||(c=b,b=10),this._init(a||0,b||10,c||"be"))))}function g(a,b,c){for(var e=0,f=Math.min(a.length,c),g=0,h=b;h<f;h++){var i=a.charCodeAt(h)-48;e<<=4;var j;j=i>=49&&i<=54?i-49+10:i>=17&&i<=22?i-17+10:i,e|=j,g|=j}return d(!(240&g),"Invalid character in "+a),e}function h(a,b,c,e){for(var f=0,g=0,h=Math.min(a.length,c),i=b;i<h;i++){var j=a.charCodeAt(i)-48;f*=e,g=j>=49?j-49+10:j>=17?j-17+10:j,d(j>=0&&g<e,"Invalid character"),f+=g}return f}function i(a,b){a.words=b.words,a.length=b.length,a.negative=b.negative,a.red=b.red}function j(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}function k(a){for(var b=new Array(a.bitLength()),c=0;c<b.length;c++){var d=c/26|0,e=c%26;b[c]=a.words[d]>>>e&1}return b}function l(a,b,c){c.negative=b.negative^a.negative;var d=a.length+b.length|0;c.length=d,d=d-1|0;var e=0|a.words[0],f=0|b.words[0],g=e*f,h=67108863&g,i=g/67108864|0;c.words[0]=h;for(var j=1;j<d;j++){for(var k=i>>>26,l=67108863&i,m=Math.min(j,b.length-1),n=Math.max(0,j-a.length+1);n<=m;n++){var o=j-n|0;e=0|a.words[o],f=0|b.words[n],g=e*f+l,k+=g/67108864|0,l=67108863&g}c.words[j]=0|l,i=0|k}return 0!==i?c.words[j]=0|i:c.length--,c._strip()}function m(a,b,c){c.negative=b.negative^a.negative,c.length=a.length+b.length;for(var d=0,e=0,f=0;f<c.length-1;f++){var g=e;e=0;for(var h=67108863&d,i=Math.min(f,b.length-1),j=Math.max(0,f-a.length+1);j<=i;j++){var k=f-j,l=0|a.words[k],m=0|b.words[j],n=l*m,o=67108863&n;g=g+(n/67108864|0)|0,o=o+h|0,h=67108863&o,g=g+(o>>>26)|0,e+=g>>>26,g&=67108863}c.words[f]=h,d=g,g=e}return 0!==d?c.words[f]=d:c.length--,c._strip()}function n(a,b,c){return m(a,b,c)}function o(a,b){this.x=a,this.y=b}function p(a,b){this.name=a,this.p=new f(b,16),this.n=this.p.bitLength(),this.k=new f(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function q(){p.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function r(){p.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function s(){p.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function t(){p.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function u(a){if("string"==typeof a){var b=f._prime(a);this.m=b.p,this.prime=b}else d(a.gtn(1),"modulus must be greater than 1"),this.m=a,this.prime=null}function v(a){u.call(this,a),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new f(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof b?b.exports=f:c.BN=f,f.BN=f,f.wordSize=26;var w;try{w=a("buffer").Buffer}catch(x){}f.isBN=function(a){return a instanceof f||null!==a&&"object"==typeof a&&a.constructor.wordSize===f.wordSize&&Array.isArray(a.words)},f.max=function(a,b){return a.cmp(b)>0?a:b},f.min=function(a,b){return a.cmp(b)<0?a:b},f.prototype._init=function(a,b,c){if("number"==typeof a)return this._initNumber(a,b,c);if("object"==typeof a)return this._initArray(a,b,c);"hex"===b&&(b=16),d(b===(0|b)&&b>=2&&b<=36),a=a.toString().replace(/\s+/g,"");var e=0;"-"===a[0]&&e++,16===b?this._parseHex(a,e):this._parseBase(a,b,e),"-"===a[0]&&(this.negative=1),this._strip(),"le"===c&&this._initArray(this.toArray(),b,c)},f.prototype._initNumber=function(a,b,c){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[67108863&a],this.length=1):a<4503599627370496?(this.words=[67108863&a,a/67108864&67108863],this.length=2):(d(a<9007199254740992),this.words=[67108863&a,a/67108864&67108863,1],this.length=3),"le"===c&&this._initArray(this.toArray(),b,c)},f.prototype._initArray=function(a,b,c){if(d("number"==typeof a.length),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var e=0;e<this.length;e++)this.words[e]=0;var f,g,h=0;if("be"===c)for(e=a.length-1,f=0;e>=0;e-=3)g=a[e]|a[e-1]<<8|a[e-2]<<16,this.words[f]|=g<<h&67108863,this.words[f+1]=g>>>26-h&67108863,h+=24,h>=26&&(h-=26,f++);else if("le"===c)for(e=0,f=0;e<a.length;e+=3)g=a[e]|a[e+1]<<8|a[e+2]<<16,this.words[f]|=g<<h&67108863,this.words[f+1]=g>>>26-h&67108863,h+=24,h>=26&&(h-=26,f++);return this._strip()},f.prototype._parseHex=function(a,b){this.length=Math.ceil((a.length-b)/6),this.words=new Array(this.length);for(var c=0;c<this.length;c++)this.words[c]=0;var d,e,f=0;for(c=a.length-6,d=0;c>=b;c-=6)e=g(a,c,c+6),this.words[d]|=e<<f&67108863,this.words[d+1]|=e>>>26-f&4194303,f+=24,f>=26&&(f-=26,d++);c+6!==b&&(e=g(a,b,c+6),this.words[d]|=e<<f&67108863,this.words[d+1]|=e>>>26-f&4194303),this._strip()},f.prototype._parseBase=function(a,b,c){this.words=[0],this.length=1;for(var d=0,e=1;e<=67108863;e*=b)d++;d--,e=e/b|0;for(var f=a.length-c,g=f%d,i=Math.min(f,f-g)+c,j=0,k=c;k<i;k+=d)j=h(a,k,k+d,b),this.imuln(e),this.words[0]+j<67108864?this.words[0]+=j:this._iaddn(j);if(0!==g){var l=1;for(j=h(a,k,a.length,b),k=0;k<g;k++)l*=b;this.imuln(l),this.words[0]+j<67108864?this.words[0]+=j:this._iaddn(j)}},f.prototype.copy=function(a){a.words=new Array(this.length);for(var b=0;b<this.length;b++)a.words[b]=this.words[b];a.length=this.length,a.negative=this.negative,a.red=this.red},f.prototype._move=function(a){i(a,this)},f.prototype.clone=function(){var a=new f(null);return this.copy(a),a},f.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},f.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},f.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol["for"]?f.prototype[Symbol["for"]("nodejs.util.inspect.custom")]=j:f.prototype.inspect=j;var y=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],z=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],A=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];f.prototype.toString=function(a,b){a=a||10,b=0|b||1;var c;if(16===a||"hex"===a){c="";for(var e=0,f=0,g=0;g<this.length;g++){var h=this.words[g],i=(16777215&(h<<e|f)).toString(16);f=h>>>24-e&16777215,c=0!==f||g!==this.length-1?y[6-i.length]+i+c:i+c,e+=2,e>=26&&(e-=26,g--)}for(0!==f&&(c=f.toString(16)+c);c.length%b!==0;)c="0"+c;return 0!==this.negative&&(c="-"+c),c}if(a===(0|a)&&a>=2&&a<=36){var j=z[a],k=A[a];c="";var l=this.clone();for(l.negative=0;!l.isZero();){var m=l.modrn(k).toString(a);l=l.idivn(k),c=l.isZero()?m+c:y[j-m.length]+m+c}for(this.isZero()&&(c="0"+c);c.length%b!==0;)c="0"+c;return 0!==this.negative&&(c="-"+c),c}d(!1,"Base should be between 2 and 36")},f.prototype.toNumber=function(){var a=this.words[0];return 2===this.length?a+=67108864*this.words[1]:3===this.length&&1===this.words[2]?a+=4503599627370496+67108864*this.words[1]:this.length>2&&d(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-a:a},f.prototype.toJSON=function(){return this.toString(16,2)},w&&(f.prototype.toBuffer=function(a,b){return this.toArrayLike(w,a,b)}),f.prototype.toArray=function(a,b){return this.toArrayLike(Array,a,b)};var B=function(a,b){return a.allocUnsafe?a.allocUnsafe(b):new a(b)};f.prototype.toArrayLike=function(a,b,c){this._strip();var e=this.byteLength(),f=c||Math.max(1,e);d(e<=f,"byte array longer than desired length"),d(f>0,"Requested array length <= 0");var g=B(a,f),h="le"===b?"LE":"BE";return this["_toArrayLike"+h](g,e),g},f.prototype._toArrayLikeLE=function(a,b){for(var c=0,d=0,e=0,f=0;e<this.length;e++){var g=this.words[e]<<f|d;a[c++]=255&g,c<a.length&&(a[c++]=g>>8&255),c<a.length&&(a[c++]=g>>16&255),6===f?(c<a.length&&(a[c++]=g>>24&255),d=0,f=0):(d=g>>>24,f+=2)}if(c<a.length)for(a[c++]=d;c<a.length;)a[c++]=0},f.prototype._toArrayLikeBE=function(a,b){for(var c=a.length-1,d=0,e=0,f=0;e<this.length;e++){var g=this.words[e]<<f|d;a[c--]=255&g,c>=0&&(a[c--]=g>>8&255),c>=0&&(a[c--]=g>>16&255),6===f?(c>=0&&(a[c--]=g>>24&255),d=0,f=0):(d=g>>>24,f+=2)}if(c>=0)for(a[c--]=d;c>=0;)a[c--]=0},Math.clz32?f.prototype._countBits=function(a){return 32-Math.clz32(a)}:f.prototype._countBits=function(a){var b=a,c=0;return b>=4096&&(c+=13,b>>>=13),b>=64&&(c+=7,b>>>=7),b>=8&&(c+=4,b>>>=4),b>=2&&(c+=2,b>>>=2),c+b},f.prototype._zeroBits=function(a){if(0===a)return 26;var b=a,c=0;return 0===(8191&b)&&(c+=13,b>>>=13),0===(127&b)&&(c+=7,b>>>=7),0===(15&b)&&(c+=4,b>>>=4),0===(3&b)&&(c+=2,b>>>=2),0===(1&b)&&c++,c},f.prototype.bitLength=function(){var a=this.words[this.length-1],b=this._countBits(a);return 26*(this.length-1)+b},f.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,b=0;b<this.length;b++){var c=this._zeroBits(this.words[b]);if(a+=c,26!==c)break}return a},f.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},f.prototype.toTwos=function(a){return 0!==this.negative?this.abs().inotn(a).iaddn(1):this.clone()},f.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},f.prototype.isNeg=function(){return 0!==this.negative},f.prototype.neg=function(){return this.clone().ineg()},f.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},f.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var b=0;b<a.length;b++)this.words[b]=this.words[b]|a.words[b];return this._strip()},f.prototype.ior=function(a){return d(0===(this.negative|a.negative)),this.iuor(a)},f.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},f.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},f.prototype.iuand=function(a){var b;b=this.length>a.length?a:this;for(var c=0;c<b.length;c++)this.words[c]=this.words[c]&a.words[c];return this.length=b.length,this._strip()},f.prototype.iand=function(a){return d(0===(this.negative|a.negative)),this.iuand(a)},f.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},f.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},f.prototype.iuxor=function(a){var b,c;this.length>a.length?(b=this,c=a):(b=a,c=this);for(var d=0;d<c.length;d++)this.words[d]=b.words[d]^c.words[d];if(this!==b)for(;d<b.length;d++)this.words[d]=b.words[d];return this.length=b.length,this._strip()},f.prototype.ixor=function(a){return d(0===(this.negative|a.negative)),this.iuxor(a)},f.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},f.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},f.prototype.inotn=function(a){d("number"==typeof a&&a>=0);var b=0|Math.ceil(a/26),c=a%26;this._expand(b),c>0&&b--;for(var e=0;e<b;e++)this.words[e]=67108863&~this.words[e];return c>0&&(this.words[e]=~this.words[e]&67108863>>26-c),this._strip()},f.prototype.notn=function(a){return this.clone().inotn(a)},f.prototype.setn=function(a,b){d("number"==typeof a&&a>=0);var c=a/26|0,e=a%26;return this._expand(c+1),b?this.words[c]=this.words[c]|1<<e:this.words[c]=this.words[c]&~(1<<e),this._strip()},f.prototype.iadd=function(a){var b;if(0!==this.negative&&0===a.negative)return this.negative=0,b=this.isub(a),this.negative^=1,this._normSign();if(0===this.negative&&0!==a.negative)return a.negative=0,b=this.isub(a),a.negative=1,b._normSign();var c,d;this.length>a.length?(c=this,d=a):(c=a,d=this);for(var e=0,f=0;f<d.length;f++)b=(0|c.words[f])+(0|d.words[f])+e,this.words[f]=67108863&b,e=b>>>26;for(;0!==e&&f<c.length;f++)b=(0|c.words[f])+e,this.words[f]=67108863&b,e=b>>>26;if(this.length=c.length,0!==e)this.words[this.length]=e,this.length++;else if(c!==this)for(;f<c.length;f++)this.words[f]=c.words[f];return this},f.prototype.add=function(a){var b;return 0!==a.negative&&0===this.negative?(a.negative=0,b=this.sub(a),a.negative^=1,b):0===a.negative&&0!==this.negative?(this.negative=0,b=a.sub(this),this.negative=1,b):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},f.prototype.isub=function(a){if(0!==a.negative){a.negative=0;var b=this.iadd(a);return a.negative=1,b._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var c=this.cmp(a);if(0===c)return this.negative=0,this.length=1,this.words[0]=0,this;var d,e;c>0?(d=this,e=a):(d=a,e=this);for(var f=0,g=0;g<e.length;g++)b=(0|d.words[g])-(0|e.words[g])+f,f=b>>26,this.words[g]=67108863&b;for(;0!==f&&g<d.length;g++)b=(0|d.words[g])+f,f=b>>26,this.words[g]=67108863&b;if(0===f&&g<d.length&&d!==this)for(;g<d.length;g++)this.words[g]=d.words[g];return this.length=Math.max(this.length,g),d!==this&&(this.negative=1),this._strip()},f.prototype.sub=function(a){return this.clone().isub(a)};var C=function(a,b,c){var d,e,f,g=a.words,h=b.words,i=c.words,j=0,k=0|g[0],l=8191&k,m=k>>>13,n=0|g[1],o=8191&n,p=n>>>13,q=0|g[2],r=8191&q,s=q>>>13,t=0|g[3],u=8191&t,v=t>>>13,w=0|g[4],x=8191&w,y=w>>>13,z=0|g[5],A=8191&z,B=z>>>13,C=0|g[6],D=8191&C,E=C>>>13,F=0|g[7],G=8191&F,H=F>>>13,I=0|g[8],J=8191&I,K=I>>>13,L=0|g[9],M=8191&L,N=L>>>13,O=0|h[0],P=8191&O,Q=O>>>13,R=0|h[1],S=8191&R,T=R>>>13,U=0|h[2],V=8191&U,W=U>>>13,X=0|h[3],Y=8191&X,Z=X>>>13,$=0|h[4],_=8191&$,aa=$>>>13,ba=0|h[5],ca=8191&ba,da=ba>>>13,ea=0|h[6],fa=8191&ea,ga=ea>>>13,ha=0|h[7],ia=8191&ha,ja=ha>>>13,ka=0|h[8],la=8191&ka,ma=ka>>>13,na=0|h[9],oa=8191&na,pa=na>>>13;c.negative=a.negative^b.negative,c.length=19,d=Math.imul(l,P),e=Math.imul(l,Q),e=e+Math.imul(m,P)|0,f=Math.imul(m,Q);var qa=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(qa>>>26)|0,qa&=67108863,d=Math.imul(o,P),e=Math.imul(o,Q),e=e+Math.imul(p,P)|0,f=Math.imul(p,Q),d=d+Math.imul(l,S)|0,e=e+Math.imul(l,T)|0,e=e+Math.imul(m,S)|0,f=f+Math.imul(m,T)|0;var ra=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(ra>>>26)|0,ra&=67108863,d=Math.imul(r,P),e=Math.imul(r,Q),e=e+Math.imul(s,P)|0,f=Math.imul(s,Q),d=d+Math.imul(o,S)|0,e=e+Math.imul(o,T)|0,e=e+Math.imul(p,S)|0,f=f+Math.imul(p,T)|0,d=d+Math.imul(l,V)|0,e=e+Math.imul(l,W)|0,e=e+Math.imul(m,V)|0,f=f+Math.imul(m,W)|0;var sa=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(sa>>>26)|0,sa&=67108863,d=Math.imul(u,P),e=Math.imul(u,Q),e=e+Math.imul(v,P)|0,f=Math.imul(v,Q),d=d+Math.imul(r,S)|0,e=e+Math.imul(r,T)|0,e=e+Math.imul(s,S)|0,f=f+Math.imul(s,T)|0,d=d+Math.imul(o,V)|0,e=e+Math.imul(o,W)|0,e=e+Math.imul(p,V)|0,f=f+Math.imul(p,W)|0,d=d+Math.imul(l,Y)|0,e=e+Math.imul(l,Z)|0,e=e+Math.imul(m,Y)|0,f=f+Math.imul(m,Z)|0;var ta=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(ta>>>26)|0,ta&=67108863,d=Math.imul(x,P),e=Math.imul(x,Q),e=e+Math.imul(y,P)|0,f=Math.imul(y,Q),d=d+Math.imul(u,S)|0,e=e+Math.imul(u,T)|0,e=e+Math.imul(v,S)|0,f=f+Math.imul(v,T)|0,d=d+Math.imul(r,V)|0,e=e+Math.imul(r,W)|0,e=e+Math.imul(s,V)|0,f=f+Math.imul(s,W)|0,d=d+Math.imul(o,Y)|0,e=e+Math.imul(o,Z)|0,e=e+Math.imul(p,Y)|0,f=f+Math.imul(p,Z)|0,d=d+Math.imul(l,_)|0,e=e+Math.imul(l,aa)|0,e=e+Math.imul(m,_)|0,f=f+Math.imul(m,aa)|0;var ua=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(ua>>>26)|0,ua&=67108863,d=Math.imul(A,P),e=Math.imul(A,Q),e=e+Math.imul(B,P)|0,f=Math.imul(B,Q),d=d+Math.imul(x,S)|0,e=e+Math.imul(x,T)|0,e=e+Math.imul(y,S)|0,f=f+Math.imul(y,T)|0,d=d+Math.imul(u,V)|0,e=e+Math.imul(u,W)|0,e=e+Math.imul(v,V)|0,f=f+Math.imul(v,W)|0,d=d+Math.imul(r,Y)|0,e=e+Math.imul(r,Z)|0,e=e+Math.imul(s,Y)|0,f=f+Math.imul(s,Z)|0,d=d+Math.imul(o,_)|0,e=e+Math.imul(o,aa)|0,e=e+Math.imul(p,_)|0,f=f+Math.imul(p,aa)|0,d=d+Math.imul(l,ca)|0,e=e+Math.imul(l,da)|0,e=e+Math.imul(m,ca)|0,f=f+Math.imul(m,da)|0;var va=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(va>>>26)|0,va&=67108863,d=Math.imul(D,P),e=Math.imul(D,Q),e=e+Math.imul(E,P)|0,f=Math.imul(E,Q),d=d+Math.imul(A,S)|0,e=e+Math.imul(A,T)|0,e=e+Math.imul(B,S)|0,f=f+Math.imul(B,T)|0,d=d+Math.imul(x,V)|0,e=e+Math.imul(x,W)|0,e=e+Math.imul(y,V)|0,f=f+Math.imul(y,W)|0,d=d+Math.imul(u,Y)|0,e=e+Math.imul(u,Z)|0,e=e+Math.imul(v,Y)|0,f=f+Math.imul(v,Z)|0,d=d+Math.imul(r,_)|0,e=e+Math.imul(r,aa)|0,e=e+Math.imul(s,_)|0,f=f+Math.imul(s,aa)|0,d=d+Math.imul(o,ca)|0,e=e+Math.imul(o,da)|0,e=e+Math.imul(p,ca)|0,f=f+Math.imul(p,da)|0,d=d+Math.imul(l,fa)|0,e=e+Math.imul(l,ga)|0,e=e+Math.imul(m,fa)|0,f=f+Math.imul(m,ga)|0;var wa=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(wa>>>26)|0,wa&=67108863,d=Math.imul(G,P),e=Math.imul(G,Q),e=e+Math.imul(H,P)|0,f=Math.imul(H,Q),d=d+Math.imul(D,S)|0,e=e+Math.imul(D,T)|0,e=e+Math.imul(E,S)|0,f=f+Math.imul(E,T)|0,d=d+Math.imul(A,V)|0,e=e+Math.imul(A,W)|0,e=e+Math.imul(B,V)|0,f=f+Math.imul(B,W)|0,d=d+Math.imul(x,Y)|0,e=e+Math.imul(x,Z)|0,e=e+Math.imul(y,Y)|0,f=f+Math.imul(y,Z)|0,d=d+Math.imul(u,_)|0,e=e+Math.imul(u,aa)|0,e=e+Math.imul(v,_)|0,f=f+Math.imul(v,aa)|0,d=d+Math.imul(r,ca)|0,e=e+Math.imul(r,da)|0,e=e+Math.imul(s,ca)|0,f=f+Math.imul(s,da)|0,d=d+Math.imul(o,fa)|0,e=e+Math.imul(o,ga)|0,e=e+Math.imul(p,fa)|0,f=f+Math.imul(p,ga)|0,d=d+Math.imul(l,ia)|0,e=e+Math.imul(l,ja)|0,e=e+Math.imul(m,ia)|0,f=f+Math.imul(m,ja)|0;var xa=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(xa>>>26)|0,xa&=67108863,d=Math.imul(J,P),e=Math.imul(J,Q),e=e+Math.imul(K,P)|0,f=Math.imul(K,Q),d=d+Math.imul(G,S)|0,e=e+Math.imul(G,T)|0,e=e+Math.imul(H,S)|0,f=f+Math.imul(H,T)|0,d=d+Math.imul(D,V)|0,e=e+Math.imul(D,W)|0,e=e+Math.imul(E,V)|0,f=f+Math.imul(E,W)|0,d=d+Math.imul(A,Y)|0,e=e+Math.imul(A,Z)|0,e=e+Math.imul(B,Y)|0,f=f+Math.imul(B,Z)|0,d=d+Math.imul(x,_)|0,e=e+Math.imul(x,aa)|0,e=e+Math.imul(y,_)|0,f=f+Math.imul(y,aa)|0,d=d+Math.imul(u,ca)|0,e=e+Math.imul(u,da)|0,e=e+Math.imul(v,ca)|0,f=f+Math.imul(v,da)|0,d=d+Math.imul(r,fa)|0,e=e+Math.imul(r,ga)|0,e=e+Math.imul(s,fa)|0,f=f+Math.imul(s,ga)|0,d=d+Math.imul(o,ia)|0,e=e+Math.imul(o,ja)|0,e=e+Math.imul(p,ia)|0,f=f+Math.imul(p,ja)|0,d=d+Math.imul(l,la)|0,e=e+Math.imul(l,ma)|0,e=e+Math.imul(m,la)|0,f=f+Math.imul(m,ma)|0;var ya=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(ya>>>26)|0,ya&=67108863,d=Math.imul(M,P),e=Math.imul(M,Q),e=e+Math.imul(N,P)|0,f=Math.imul(N,Q),d=d+Math.imul(J,S)|0,e=e+Math.imul(J,T)|0,e=e+Math.imul(K,S)|0,f=f+Math.imul(K,T)|0,d=d+Math.imul(G,V)|0,e=e+Math.imul(G,W)|0,e=e+Math.imul(H,V)|0,f=f+Math.imul(H,W)|0,d=d+Math.imul(D,Y)|0,e=e+Math.imul(D,Z)|0,e=e+Math.imul(E,Y)|0,f=f+Math.imul(E,Z)|0,d=d+Math.imul(A,_)|0,e=e+Math.imul(A,aa)|0,e=e+Math.imul(B,_)|0,f=f+Math.imul(B,aa)|0,d=d+Math.imul(x,ca)|0,e=e+Math.imul(x,da)|0,e=e+Math.imul(y,ca)|0,f=f+Math.imul(y,da)|0,d=d+Math.imul(u,fa)|0,e=e+Math.imul(u,ga)|0,e=e+Math.imul(v,fa)|0,f=f+Math.imul(v,ga)|0,d=d+Math.imul(r,ia)|0,e=e+Math.imul(r,ja)|0,e=e+Math.imul(s,ia)|0,f=f+Math.imul(s,ja)|0,d=d+Math.imul(o,la)|0,e=e+Math.imul(o,ma)|0,e=e+Math.imul(p,la)|0,f=f+Math.imul(p,ma)|0,d=d+Math.imul(l,oa)|0,e=e+Math.imul(l,pa)|0,e=e+Math.imul(m,oa)|0,f=f+Math.imul(m,pa)|0;var za=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(za>>>26)|0,za&=67108863,d=Math.imul(M,S),e=Math.imul(M,T),e=e+Math.imul(N,S)|0,f=Math.imul(N,T),d=d+Math.imul(J,V)|0,e=e+Math.imul(J,W)|0,e=e+Math.imul(K,V)|0,f=f+Math.imul(K,W)|0,d=d+Math.imul(G,Y)|0,e=e+Math.imul(G,Z)|0,e=e+Math.imul(H,Y)|0,f=f+Math.imul(H,Z)|0,d=d+Math.imul(D,_)|0,e=e+Math.imul(D,aa)|0,e=e+Math.imul(E,_)|0,f=f+Math.imul(E,aa)|0,d=d+Math.imul(A,ca)|0,e=e+Math.imul(A,da)|0,e=e+Math.imul(B,ca)|0,f=f+Math.imul(B,da)|0,d=d+Math.imul(x,fa)|0,e=e+Math.imul(x,ga)|0,e=e+Math.imul(y,fa)|0,f=f+Math.imul(y,ga)|0,d=d+Math.imul(u,ia)|0,e=e+Math.imul(u,ja)|0,e=e+Math.imul(v,ia)|0,f=f+Math.imul(v,ja)|0,d=d+Math.imul(r,la)|0,e=e+Math.imul(r,ma)|0,e=e+Math.imul(s,la)|0,f=f+Math.imul(s,ma)|0,d=d+Math.imul(o,oa)|0,e=e+Math.imul(o,pa)|0,e=e+Math.imul(p,oa)|0,f=f+Math.imul(p,pa)|0;var Aa=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Aa>>>26)|0,Aa&=67108863,d=Math.imul(M,V),e=Math.imul(M,W),e=e+Math.imul(N,V)|0,f=Math.imul(N,W),d=d+Math.imul(J,Y)|0,e=e+Math.imul(J,Z)|0,e=e+Math.imul(K,Y)|0,f=f+Math.imul(K,Z)|0,d=d+Math.imul(G,_)|0,e=e+Math.imul(G,aa)|0,e=e+Math.imul(H,_)|0,f=f+Math.imul(H,aa)|0,d=d+Math.imul(D,ca)|0,e=e+Math.imul(D,da)|0,e=e+Math.imul(E,ca)|0,f=f+Math.imul(E,da)|0,d=d+Math.imul(A,fa)|0,e=e+Math.imul(A,ga)|0,e=e+Math.imul(B,fa)|0,f=f+Math.imul(B,ga)|0,d=d+Math.imul(x,ia)|0,e=e+Math.imul(x,ja)|0,e=e+Math.imul(y,ia)|0,f=f+Math.imul(y,ja)|0,d=d+Math.imul(u,la)|0,e=e+Math.imul(u,ma)|0,e=e+Math.imul(v,la)|0,f=f+Math.imul(v,ma)|0,d=d+Math.imul(r,oa)|0,e=e+Math.imul(r,pa)|0,e=e+Math.imul(s,oa)|0,f=f+Math.imul(s,pa)|0;var Ba=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Ba>>>26)|0,Ba&=67108863,d=Math.imul(M,Y),e=Math.imul(M,Z),e=e+Math.imul(N,Y)|0,f=Math.imul(N,Z),d=d+Math.imul(J,_)|0,e=e+Math.imul(J,aa)|0,e=e+Math.imul(K,_)|0,f=f+Math.imul(K,aa)|0,d=d+Math.imul(G,ca)|0,e=e+Math.imul(G,da)|0,e=e+Math.imul(H,ca)|0,f=f+Math.imul(H,da)|0,d=d+Math.imul(D,fa)|0,e=e+Math.imul(D,ga)|0,e=e+Math.imul(E,fa)|0,f=f+Math.imul(E,ga)|0,d=d+Math.imul(A,ia)|0,e=e+Math.imul(A,ja)|0,e=e+Math.imul(B,ia)|0,f=f+Math.imul(B,ja)|0,d=d+Math.imul(x,la)|0,e=e+Math.imul(x,ma)|0,e=e+Math.imul(y,la)|0,f=f+Math.imul(y,ma)|0,d=d+Math.imul(u,oa)|0,e=e+Math.imul(u,pa)|0,e=e+Math.imul(v,oa)|0,f=f+Math.imul(v,pa)|0;var Ca=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Ca>>>26)|0,Ca&=67108863,d=Math.imul(M,_),e=Math.imul(M,aa),e=e+Math.imul(N,_)|0,f=Math.imul(N,aa),d=d+Math.imul(J,ca)|0,e=e+Math.imul(J,da)|0,e=e+Math.imul(K,ca)|0,f=f+Math.imul(K,da)|0,d=d+Math.imul(G,fa)|0,e=e+Math.imul(G,ga)|0,e=e+Math.imul(H,fa)|0,f=f+Math.imul(H,ga)|0,d=d+Math.imul(D,ia)|0,e=e+Math.imul(D,ja)|0,e=e+Math.imul(E,ia)|0,f=f+Math.imul(E,ja)|0,d=d+Math.imul(A,la)|0,e=e+Math.imul(A,ma)|0,e=e+Math.imul(B,la)|0,f=f+Math.imul(B,ma)|0,d=d+Math.imul(x,oa)|0,e=e+Math.imul(x,pa)|0,e=e+Math.imul(y,oa)|0,f=f+Math.imul(y,pa)|0;var Da=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Da>>>26)|0,Da&=67108863,d=Math.imul(M,ca),e=Math.imul(M,da),e=e+Math.imul(N,ca)|0,f=Math.imul(N,da),d=d+Math.imul(J,fa)|0,e=e+Math.imul(J,ga)|0,e=e+Math.imul(K,fa)|0,f=f+Math.imul(K,ga)|0,d=d+Math.imul(G,ia)|0,e=e+Math.imul(G,ja)|0,e=e+Math.imul(H,ia)|0,f=f+Math.imul(H,ja)|0,d=d+Math.imul(D,la)|0,e=e+Math.imul(D,ma)|0,e=e+Math.imul(E,la)|0,f=f+Math.imul(E,ma)|0,d=d+Math.imul(A,oa)|0,e=e+Math.imul(A,pa)|0,e=e+Math.imul(B,oa)|0,f=f+Math.imul(B,pa)|0;var Ea=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Ea>>>26)|0,Ea&=67108863,d=Math.imul(M,fa),e=Math.imul(M,ga),e=e+Math.imul(N,fa)|0,f=Math.imul(N,ga),d=d+Math.imul(J,ia)|0,e=e+Math.imul(J,ja)|0,e=e+Math.imul(K,ia)|0,f=f+Math.imul(K,ja)|0,d=d+Math.imul(G,la)|0,e=e+Math.imul(G,ma)|0,e=e+Math.imul(H,la)|0,f=f+Math.imul(H,ma)|0,d=d+Math.imul(D,oa)|0,e=e+Math.imul(D,pa)|0,e=e+Math.imul(E,oa)|0,f=f+Math.imul(E,pa)|0;var Fa=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Fa>>>26)|0,Fa&=67108863,d=Math.imul(M,ia),e=Math.imul(M,ja),e=e+Math.imul(N,ia)|0,f=Math.imul(N,ja),d=d+Math.imul(J,la)|0,e=e+Math.imul(J,ma)|0,e=e+Math.imul(K,la)|0,f=f+Math.imul(K,ma)|0,d=d+Math.imul(G,oa)|0,e=e+Math.imul(G,pa)|0,e=e+Math.imul(H,oa)|0,f=f+Math.imul(H,pa)|0;var Ga=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Ga>>>26)|0,Ga&=67108863,d=Math.imul(M,la),e=Math.imul(M,ma),e=e+Math.imul(N,la)|0,f=Math.imul(N,ma),d=d+Math.imul(J,oa)|0,e=e+Math.imul(J,pa)|0,e=e+Math.imul(K,oa)|0,f=f+Math.imul(K,pa)|0;var Ha=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Ha>>>26)|0,Ha&=67108863,d=Math.imul(M,oa),e=Math.imul(M,pa),e=e+Math.imul(N,oa)|0,f=Math.imul(N,pa);var Ia=(j+d|0)+((8191&e)<<13)|0;return j=(f+(e>>>13)|0)+(Ia>>>26)|0,Ia&=67108863,i[0]=qa,i[1]=ra,i[2]=sa,i[3]=ta,i[4]=ua,i[5]=va,i[6]=wa,i[7]=xa,i[8]=ya,i[9]=za,i[10]=Aa,i[11]=Ba,i[12]=Ca,i[13]=Da,i[14]=Ea,i[15]=Fa,i[16]=Ga,i[17]=Ha,i[18]=Ia,0!==j&&(i[19]=j,c.length++),c};Math.imul||(C=l),f.prototype.mulTo=function(a,b){var c,d=this.length+a.length;return c=10===this.length&&10===a.length?C(this,a,b):d<63?l(this,a,b):d<1024?m(this,a,b):n(this,a,b)},o.prototype.makeRBT=function(a){for(var b=new Array(a),c=f.prototype._countBits(a)-1,d=0;d<a;d++)b[d]=this.revBin(d,c,a);return b},o.prototype.revBin=function(a,b,c){if(0===a||a===c-1)return a;for(var d=0,e=0;e<b;e++)d|=(1&a)<<b-e-1,a>>=1;return d},o.prototype.permute=function(a,b,c,d,e,f){for(var g=0;g<f;g++)d[g]=b[a[g]],e[g]=c[a[g]]},o.prototype.transform=function(a,b,c,d,e,f){this.permute(f,a,b,c,d,e);for(var g=1;g<e;g<<=1)for(var h=g<<1,i=Math.cos(2*Math.PI/h),j=Math.sin(2*Math.PI/h),k=0;k<e;k+=h)for(var l=i,m=j,n=0;n<g;n++){var o=c[k+n],p=d[k+n],q=c[k+n+g],r=d[k+n+g],s=l*q-m*r;r=l*r+m*q,q=s,c[k+n]=o+q,d[k+n]=p+r,c[k+n+g]=o-q,d[k+n+g]=p-r,n!==h&&(s=i*l-j*m,m=i*m+j*l,l=s)}},o.prototype.guessLen13b=function(a,b){var c=1|Math.max(b,a),d=1&c,e=0;for(c=c/2|0;c;c>>>=1)e++;return 1<<e+1+d},o.prototype.conjugate=function(a,b,c){if(!(c<=1))for(var d=0;d<c/2;d++){var e=a[d];a[d]=a[c-d-1],a[c-d-1]=e,e=b[d],b[d]=-b[c-d-1],b[c-d-1]=-e}},o.prototype.normalize13b=function(a,b){for(var c=0,d=0;d<b/2;d++){var e=8192*Math.round(a[2*d+1]/b)+Math.round(a[2*d]/b)+c;a[d]=67108863&e,c=e<67108864?0:e/67108864|0}return a},o.prototype.convert13b=function(a,b,c,e){for(var f=0,g=0;g<b;g++)f+=0|a[g],c[2*g]=8191&f,f>>>=13,c[2*g+1]=8191&f,f>>>=13;for(g=2*b;g<e;++g)c[g]=0;d(0===f),d(0===(f&-8192))},o.prototype.stub=function(a){for(var b=new Array(a),c=0;c<a;c++)b[c]=0;return b},o.prototype.mulp=function(a,b,c){var d=2*this.guessLen13b(a.length,b.length),e=this.makeRBT(d),f=this.stub(d),g=new Array(d),h=new Array(d),i=new Array(d),j=new Array(d),k=new Array(d),l=new Array(d),m=c.words;m.length=d,this.convert13b(a.words,a.length,g,d),this.convert13b(b.words,b.length,j,d),this.transform(g,f,h,i,d,e),this.transform(j,f,k,l,d,e);for(var n=0;n<d;n++){var o=h[n]*k[n]-i[n]*l[n];i[n]=h[n]*l[n]+i[n]*k[n],h[n]=o}return this.conjugate(h,i,d),this.transform(h,i,m,f,d,e),this.conjugate(m,f,d),this.normalize13b(m,d),c.negative=a.negative^b.negative,c.length=a.length+b.length,c._strip()},f.prototype.mul=function(a){var b=new f(null);return b.words=new Array(this.length+a.length),this.mulTo(a,b)},f.prototype.mulf=function(a){var b=new f(null);return b.words=new Array(this.length+a.length),n(this,a,b)},f.prototype.imul=function(a){return this.clone().mulTo(a,this)},f.prototype.imuln=function(a){var b=a<0;b&&(a=-a),d("number"==typeof a),d(a<67108864);for(var c=0,e=0;e<this.length;e++){var f=(0|this.words[e])*a,g=(67108863&f)+(67108863&c);c>>=26,c+=f/67108864|0,c+=g>>>26,this.words[e]=67108863&g}return 0!==c&&(this.words[e]=c,this.length++),b?this.ineg():this},f.prototype.muln=function(a){return this.clone().imuln(a)},f.prototype.sqr=function(){return this.mul(this)},f.prototype.isqr=function(){return this.imul(this.clone())},f.prototype.pow=function(a){var b=k(a);if(0===b.length)return new f(1);for(var c=this,d=0;d<b.length&&0===b[d];d++,c=c.sqr());if(++d<b.length)for(var e=c.sqr();d<b.length;d++,e=e.sqr())0!==b[d]&&(c=c.mul(e));return c},f.prototype.iushln=function(a){d("number"==typeof a&&a>=0);var b,c=a%26,e=(a-c)/26,f=67108863>>>26-c<<26-c;if(0!==c){var g=0;for(b=0;b<this.length;b++){var h=this.words[b]&f,i=(0|this.words[b])-h<<c;this.words[b]=i|g,g=h>>>26-c}g&&(this.words[b]=g,this.length++)}if(0!==e){for(b=this.length-1;b>=0;b--)this.words[b+e]=this.words[b];for(b=0;b<e;b++)this.words[b]=0;this.length+=e}return this._strip()},f.prototype.ishln=function(a){return d(0===this.negative),this.iushln(a)},f.prototype.iushrn=function(a,b,c){d("number"==typeof a&&a>=0);var e;e=b?(b-b%26)/26:0;var f=a%26,g=Math.min((a-f)/26,this.length),h=67108863^67108863>>>f<<f,i=c;if(e-=g,e=Math.max(0,e),i){for(var j=0;j<g;j++)i.words[j]=this.words[j];i.length=g}if(0===g);else if(this.length>g)for(this.length-=g,j=0;j<this.length;j++)this.words[j]=this.words[j+g];else this.words[0]=0,this.length=1;var k=0;for(j=this.length-1;j>=0&&(0!==k||j>=e);j--){var l=0|this.words[j];this.words[j]=k<<26-f|l>>>f,k=l&h}return i&&0!==k&&(i.words[i.length++]=k),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},f.prototype.ishrn=function(a,b,c){return d(0===this.negative),this.iushrn(a,b,c)},f.prototype.shln=function(a){return this.clone().ishln(a)},f.prototype.ushln=function(a){return this.clone().iushln(a)},f.prototype.shrn=function(a){return this.clone().ishrn(a)},f.prototype.ushrn=function(a){return this.clone().iushrn(a)},f.prototype.testn=function(a){d("number"==typeof a&&a>=0);var b=a%26,c=(a-b)/26,e=1<<b;if(this.length<=c)return!1;var f=this.words[c];return!!(f&e)},f.prototype.imaskn=function(a){d("number"==typeof a&&a>=0);var b=a%26,c=(a-b)/26;if(d(0===this.negative,"imaskn works only with positive numbers"),this.length<=c)return this;if(0!==b&&c++,this.length=Math.min(c,this.length),0!==b){var e=67108863^67108863>>>b<<b;this.words[this.length-1]&=e}return this._strip()},
f.prototype.maskn=function(a){return this.clone().imaskn(a)},f.prototype.iaddn=function(a){return d("number"==typeof a),d(a<67108864),a<0?this.isubn(-a):0!==this.negative?1===this.length&&(0|this.words[0])<=a?(this.words[0]=a-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},f.prototype._iaddn=function(a){this.words[0]+=a;for(var b=0;b<this.length&&this.words[b]>=67108864;b++)this.words[b]-=67108864,b===this.length-1?this.words[b+1]=1:this.words[b+1]++;return this.length=Math.max(this.length,b+1),this},f.prototype.isubn=function(a){if(d("number"==typeof a),d(a<67108864),a<0)return this.iaddn(-a);if(0!==this.negative)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var b=0;b<this.length&&this.words[b]<0;b++)this.words[b]+=67108864,this.words[b+1]-=1;return this._strip()},f.prototype.addn=function(a){return this.clone().iaddn(a)},f.prototype.subn=function(a){return this.clone().isubn(a)},f.prototype.iabs=function(){return this.negative=0,this},f.prototype.abs=function(){return this.clone().iabs()},f.prototype._ishlnsubmul=function(a,b,c){var e,f=a.length+c;this._expand(f);var g,h=0;for(e=0;e<a.length;e++){g=(0|this.words[e+c])+h;var i=(0|a.words[e])*b;g-=67108863&i,h=(g>>26)-(i/67108864|0),this.words[e+c]=67108863&g}for(;e<this.length-c;e++)g=(0|this.words[e+c])+h,h=g>>26,this.words[e+c]=67108863&g;if(0===h)return this._strip();for(d(h===-1),h=0,e=0;e<this.length;e++)g=-(0|this.words[e])+h,h=g>>26,this.words[e]=67108863&g;return this.negative=1,this._strip()},f.prototype._wordDiv=function(a,b){var c=this.length-a.length,d=this.clone(),e=a,g=0|e.words[e.length-1],h=this._countBits(g);c=26-h,0!==c&&(e=e.ushln(c),d.iushln(c),g=0|e.words[e.length-1]);var i,j=d.length-e.length;if("mod"!==b){i=new f(null),i.length=j+1,i.words=new Array(i.length);for(var k=0;k<i.length;k++)i.words[k]=0}var l=d.clone()._ishlnsubmul(e,1,j);0===l.negative&&(d=l,i&&(i.words[j]=1));for(var m=j-1;m>=0;m--){var n=67108864*(0|d.words[e.length+m])+(0|d.words[e.length+m-1]);for(n=Math.min(n/g|0,67108863),d._ishlnsubmul(e,n,m);0!==d.negative;)n--,d.negative=0,d._ishlnsubmul(e,1,m),d.isZero()||(d.negative^=1);i&&(i.words[m]=n)}return i&&i._strip(),d._strip(),"div"!==b&&0!==c&&d.iushrn(c),{div:i||null,mod:d}},f.prototype.divmod=function(a,b,c){if(d(!a.isZero()),this.isZero())return{div:new f(0),mod:new f(0)};var e,g,h;return 0!==this.negative&&0===a.negative?(h=this.neg().divmod(a,b),"mod"!==b&&(e=h.div.neg()),"div"!==b&&(g=h.mod.neg(),c&&0!==g.negative&&g.iadd(a)),{div:e,mod:g}):0===this.negative&&0!==a.negative?(h=this.divmod(a.neg(),b),"mod"!==b&&(e=h.div.neg()),{div:e,mod:h.mod}):0!==(this.negative&a.negative)?(h=this.neg().divmod(a.neg(),b),"div"!==b&&(g=h.mod.neg(),c&&0!==g.negative&&g.isub(a)),{div:h.div,mod:g}):a.length>this.length||this.cmp(a)<0?{div:new f(0),mod:this}:1===a.length?"div"===b?{div:this.divn(a.words[0]),mod:null}:"mod"===b?{div:null,mod:new f(this.modrn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new f(this.modrn(a.words[0]))}:this._wordDiv(a,b)},f.prototype.div=function(a){return this.divmod(a,"div",!1).div},f.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},f.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},f.prototype.divRound=function(a){var b=this.divmod(a);if(b.mod.isZero())return b.div;var c=0!==b.div.negative?b.mod.isub(a):b.mod,d=a.ushrn(1),e=a.andln(1),f=c.cmp(d);return f<0||1===e&&0===f?b.div:0!==b.div.negative?b.div.isubn(1):b.div.iaddn(1)},f.prototype.modrn=function(a){var b=a<0;b&&(a=-a),d(a<=67108863);for(var c=(1<<26)%a,e=0,f=this.length-1;f>=0;f--)e=(c*e+(0|this.words[f]))%a;return b?-e:e},f.prototype.modn=function(a){return this.modrn(a)},f.prototype.idivn=function(a){var b=a<0;b&&(a=-a),d(a<=67108863);for(var c=0,e=this.length-1;e>=0;e--){var f=(0|this.words[e])+67108864*c;this.words[e]=f/a|0,c=f%a}return this._strip(),b?this.ineg():this},f.prototype.divn=function(a){return this.clone().idivn(a)},f.prototype.egcd=function(a){d(0===a.negative),d(!a.isZero());var b=this,c=a.clone();b=0!==b.negative?b.umod(a):b.clone();for(var e=new f(1),g=new f(0),h=new f(0),i=new f(1),j=0;b.isEven()&&c.isEven();)b.iushrn(1),c.iushrn(1),++j;for(var k=c.clone(),l=b.clone();!b.isZero();){for(var m=0,n=1;0===(b.words[0]&n)&&m<26;++m,n<<=1);if(m>0)for(b.iushrn(m);m-- >0;)(e.isOdd()||g.isOdd())&&(e.iadd(k),g.isub(l)),e.iushrn(1),g.iushrn(1);for(var o=0,p=1;0===(c.words[0]&p)&&o<26;++o,p<<=1);if(o>0)for(c.iushrn(o);o-- >0;)(h.isOdd()||i.isOdd())&&(h.iadd(k),i.isub(l)),h.iushrn(1),i.iushrn(1);b.cmp(c)>=0?(b.isub(c),e.isub(h),g.isub(i)):(c.isub(b),h.isub(e),i.isub(g))}return{a:h,b:i,gcd:c.iushln(j)}},f.prototype._invmp=function(a){d(0===a.negative),d(!a.isZero());var b=this,c=a.clone();b=0!==b.negative?b.umod(a):b.clone();for(var e=new f(1),g=new f(0),h=c.clone();b.cmpn(1)>0&&c.cmpn(1)>0;){for(var i=0,j=1;0===(b.words[0]&j)&&i<26;++i,j<<=1);if(i>0)for(b.iushrn(i);i-- >0;)e.isOdd()&&e.iadd(h),e.iushrn(1);for(var k=0,l=1;0===(c.words[0]&l)&&k<26;++k,l<<=1);if(k>0)for(c.iushrn(k);k-- >0;)g.isOdd()&&g.iadd(h),g.iushrn(1);b.cmp(c)>=0?(b.isub(c),e.isub(g)):(c.isub(b),g.isub(e))}var m;return m=0===b.cmpn(1)?e:g,m.cmpn(0)<0&&m.iadd(a),m},f.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var b=this.clone(),c=a.clone();b.negative=0,c.negative=0;for(var d=0;b.isEven()&&c.isEven();d++)b.iushrn(1),c.iushrn(1);for(;;){for(;b.isEven();)b.iushrn(1);for(;c.isEven();)c.iushrn(1);var e=b.cmp(c);if(e<0){var f=b;b=c,c=f}else if(0===e||0===c.cmpn(1))break;b.isub(c)}return c.iushln(d)},f.prototype.invm=function(a){return this.egcd(a).a.umod(a)},f.prototype.isEven=function(){return 0===(1&this.words[0])},f.prototype.isOdd=function(){return 1===(1&this.words[0])},f.prototype.andln=function(a){return this.words[0]&a},f.prototype.bincn=function(a){d("number"==typeof a);var b=a%26,c=(a-b)/26,e=1<<b;if(this.length<=c)return this._expand(c+1),this.words[c]|=e,this;for(var f=e,g=c;0!==f&&g<this.length;g++){var h=0|this.words[g];h+=f,f=h>>>26,h&=67108863,this.words[g]=h}return 0!==f&&(this.words[g]=f,this.length++),this},f.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},f.prototype.cmpn=function(a){var b=a<0;if(0!==this.negative&&!b)return-1;if(0===this.negative&&b)return 1;this._strip();var c;if(this.length>1)c=1;else{b&&(a=-a),d(a<=67108863,"Number is too big");var e=0|this.words[0];c=e===a?0:e<a?-1:1}return 0!==this.negative?0|-c:c},f.prototype.cmp=function(a){if(0!==this.negative&&0===a.negative)return-1;if(0===this.negative&&0!==a.negative)return 1;var b=this.ucmp(a);return 0!==this.negative?0|-b:b},f.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var b=0,c=this.length-1;c>=0;c--){var d=0|this.words[c],e=0|a.words[c];if(d!==e){d<e?b=-1:d>e&&(b=1);break}}return b},f.prototype.gtn=function(a){return 1===this.cmpn(a)},f.prototype.gt=function(a){return 1===this.cmp(a)},f.prototype.gten=function(a){return this.cmpn(a)>=0},f.prototype.gte=function(a){return this.cmp(a)>=0},f.prototype.ltn=function(a){return this.cmpn(a)===-1},f.prototype.lt=function(a){return this.cmp(a)===-1},f.prototype.lten=function(a){return this.cmpn(a)<=0},f.prototype.lte=function(a){return this.cmp(a)<=0},f.prototype.eqn=function(a){return 0===this.cmpn(a)},f.prototype.eq=function(a){return 0===this.cmp(a)},f.red=function(a){return new u(a)},f.prototype.toRed=function(a){return d(!this.red,"Already a number in reduction context"),d(0===this.negative,"red works only with positives"),a.convertTo(this)._forceRed(a)},f.prototype.fromRed=function(){return d(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},f.prototype._forceRed=function(a){return this.red=a,this},f.prototype.forceRed=function(a){return d(!this.red,"Already a number in reduction context"),this._forceRed(a)},f.prototype.redAdd=function(a){return d(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},f.prototype.redIAdd=function(a){return d(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},f.prototype.redSub=function(a){return d(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},f.prototype.redISub=function(a){return d(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},f.prototype.redShl=function(a){return d(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},f.prototype.redMul=function(a){return d(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},f.prototype.redIMul=function(a){return d(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},f.prototype.redSqr=function(){return d(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},f.prototype.redISqr=function(){return d(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},f.prototype.redSqrt=function(){return d(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},f.prototype.redInvm=function(){return d(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},f.prototype.redNeg=function(){return d(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},f.prototype.redPow=function(a){return d(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var D={k256:null,p224:null,p192:null,p25519:null};p.prototype._tmp=function(){var a=new f(null);return a.words=new Array(Math.ceil(this.n/13)),a},p.prototype.ireduce=function(a){var b,c=a;do this.split(c,this.tmp),c=this.imulK(c),c=c.iadd(this.tmp),b=c.bitLength();while(b>this.n);var d=b<this.n?-1:c.ucmp(this.p);return 0===d?(c.words[0]=0,c.length=1):d>0?c.isub(this.p):c._strip(),c},p.prototype.split=function(a,b){a.iushrn(this.n,0,b)},p.prototype.imulK=function(a){return a.imul(this.k)},e(q,p),q.prototype.split=function(a,b){for(var c=4194303,d=Math.min(a.length,9),e=0;e<d;e++)b.words[e]=a.words[e];if(b.length=d,a.length<=9)return a.words[0]=0,void(a.length=1);var f=a.words[9];for(b.words[b.length++]=f&c,e=10;e<a.length;e++){var g=0|a.words[e];a.words[e-10]=(g&c)<<4|f>>>22,f=g}f>>>=22,a.words[e-10]=f,0===f&&a.length>10?a.length-=10:a.length-=9},q.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var b=0,c=0;c<a.length;c++){var d=0|a.words[c];b+=977*d,a.words[c]=67108863&b,b=64*d+(b/67108864|0)}return 0===a.words[a.length-1]&&(a.length--,0===a.words[a.length-1]&&a.length--),a},e(r,p),e(s,p),e(t,p),t.prototype.imulK=function(a){for(var b=0,c=0;c<a.length;c++){var d=19*(0|a.words[c])+b,e=67108863&d;d>>>=26,a.words[c]=e,b=d}return 0!==b&&(a.words[a.length++]=b),a},f._prime=function E(a){if(D[a])return D[a];var E;if("k256"===a)E=new q;else if("p224"===a)E=new r;else if("p192"===a)E=new s;else{if("p25519"!==a)throw new Error("Unknown prime "+a);E=new t}return D[a]=E,E},u.prototype._verify1=function(a){d(0===a.negative,"red works only with positives"),d(a.red,"red works only with red numbers")},u.prototype._verify2=function(a,b){d(0===(a.negative|b.negative),"red works only with positives"),d(a.red&&a.red===b.red,"red works only with red numbers")},u.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):(i(a,a.umod(this.m)._forceRed(this)),a)},u.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},u.prototype.add=function(a,b){this._verify2(a,b);var c=a.add(b);return c.cmp(this.m)>=0&&c.isub(this.m),c._forceRed(this)},u.prototype.iadd=function(a,b){this._verify2(a,b);var c=a.iadd(b);return c.cmp(this.m)>=0&&c.isub(this.m),c},u.prototype.sub=function(a,b){this._verify2(a,b);var c=a.sub(b);return c.cmpn(0)<0&&c.iadd(this.m),c._forceRed(this)},u.prototype.isub=function(a,b){this._verify2(a,b);var c=a.isub(b);return c.cmpn(0)<0&&c.iadd(this.m),c},u.prototype.shl=function(a,b){return this._verify1(a),this.imod(a.ushln(b))},u.prototype.imul=function(a,b){return this._verify2(a,b),this.imod(a.imul(b))},u.prototype.mul=function(a,b){return this._verify2(a,b),this.imod(a.mul(b))},u.prototype.isqr=function(a){return this.imul(a,a.clone())},u.prototype.sqr=function(a){return this.mul(a,a)},u.prototype.sqrt=function(a){if(a.isZero())return a.clone();var b=this.m.andln(3);if(d(b%2===1),3===b){var c=this.m.add(new f(1)).iushrn(2);return this.pow(a,c)}for(var e=this.m.subn(1),g=0;!e.isZero()&&0===e.andln(1);)g++,e.iushrn(1);d(!e.isZero());var h=new f(1).toRed(this),i=h.redNeg(),j=this.m.subn(1).iushrn(1),k=this.m.bitLength();for(k=new f(2*k*k).toRed(this);0!==this.pow(k,j).cmp(i);)k.redIAdd(i);for(var l=this.pow(k,e),m=this.pow(a,e.addn(1).iushrn(1)),n=this.pow(a,e),o=g;0!==n.cmp(h);){for(var p=n,q=0;0!==p.cmp(h);q++)p=p.redSqr();d(q<o);var r=this.pow(l,new f(1).iushln(o-q-1));m=m.redMul(r),l=r.redSqr(),n=n.redMul(l),o=q}return m},u.prototype.invm=function(a){var b=a._invmp(this.m);return 0!==b.negative?(b.negative=0,this.imod(b).redNeg()):this.imod(b)},u.prototype.pow=function(a,b){if(b.isZero())return new f(1).toRed(this);if(0===b.cmpn(1))return a.clone();var c=4,d=new Array(1<<c);d[0]=new f(1).toRed(this),d[1]=a;for(var e=2;e<d.length;e++)d[e]=this.mul(d[e-1],a);var g=d[0],h=0,i=0,j=b.bitLength()%26;for(0===j&&(j=26),e=b.length-1;e>=0;e--){for(var k=b.words[e],l=j-1;l>=0;l--){var m=k>>l&1;g!==d[0]&&(g=this.sqr(g)),0!==m||0!==h?(h<<=1,h|=m,i++,(i===c||0===e&&0===l)&&(g=this.mul(g,d[h]),i=0,h=0)):i=0}j=26}return g},u.prototype.convertTo=function(a){var b=a.umod(this.m);return b===a?b.clone():b},u.prototype.convertFrom=function(a){var b=a.clone();return b.red=null,b},f.mont=function(a){return new v(a)},e(v,u),v.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},v.prototype.convertFrom=function(a){var b=this.imod(a.mul(this.rinv));return b.red=null,b},v.prototype.imul=function(a,b){if(a.isZero()||b.isZero())return a.words[0]=0,a.length=1,a;var c=a.imul(b),d=c.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=c.isub(d).iushrn(this.shift),f=e;return e.cmp(this.m)>=0?f=e.isub(this.m):e.cmpn(0)<0&&(f=e.iadd(this.m)),f._forceRed(this)},v.prototype.mul=function(a,b){if(a.isZero()||b.isZero())return new f(0)._forceRed(this);var c=a.mul(b),d=c.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=c.isub(d).iushrn(this.shift),g=e;return e.cmp(this.m)>=0?g=e.isub(this.m):e.cmpn(0)<0&&(g=e.iadd(this.m)),g._forceRed(this)},v.prototype.invm=function(a){var b=this.imod(a._invmp(this.m).mul(this.r2));return b._forceRed(this)}}("undefined"==typeof b||b,this)},{buffer:18}],18:[function(a,b,c){},{}],19:[function(a,b,c){(function(b){"use strict";function d(){try{var a=new Uint8Array(1),b={foo:function(){return 42}};return Object.setPrototypeOf(b,Uint8Array.prototype),Object.setPrototypeOf(a,b),42===a.foo()}catch(c){return!1}}function e(a){if(a>X)throw new RangeError('The value "'+a+'" is invalid for option "size"');var c=new Uint8Array(a);return Object.setPrototypeOf(c,b.prototype),c}function b(a,b,c){if("number"==typeof a){if("string"==typeof b)throw new TypeError('The "string" argument must be of type string. Received type number');return i(a)}return f(a,b,c)}function f(a,c,d){if("string"==typeof a)return j(a,c);if(ArrayBuffer.isView(a))return k(a);if(null==a)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(S(a,ArrayBuffer)||a&&S(a.buffer,ArrayBuffer))return l(a,c,d);if("number"==typeof a)throw new TypeError('The "value" argument must not be of type number. Received type number');var e=a.valueOf&&a.valueOf();if(null!=e&&e!==a)return b.from(e,c,d);var f=m(a);if(f)return f;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return b.from(a[Symbol.toPrimitive]("string"),c,d);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}function g(a){if("number"!=typeof a)throw new TypeError('"size" argument must be of type number');if(a<0)throw new RangeError('The value "'+a+'" is invalid for option "size"')}function h(a,b,c){return g(a),a<=0?e(a):void 0!==b?"string"==typeof c?e(a).fill(b,c):e(a).fill(b):e(a)}function i(a){return g(a),e(a<0?0:0|n(a))}function j(a,c){if("string"==typeof c&&""!==c||(c="utf8"),!b.isEncoding(c))throw new TypeError("Unknown encoding: "+c);var d=0|p(a,c),f=e(d),g=f.write(a,c);return g!==d&&(f=f.slice(0,g)),f}function k(a){for(var b=a.length<0?0:0|n(a.length),c=e(b),d=0;d<b;d+=1)c[d]=255&a[d];return c}function l(a,c,d){if(c<0||a.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(a.byteLength<c+(d||0))throw new RangeError('"length" is outside of buffer bounds');var e;return e=void 0===c&&void 0===d?new Uint8Array(a):void 0===d?new Uint8Array(a,c):new Uint8Array(a,c,d),Object.setPrototypeOf(e,b.prototype),e}function m(a){if(b.isBuffer(a)){var c=0|n(a.length),d=e(c);return 0===d.length?d:(a.copy(d,0,0,c),d)}return void 0!==a.length?"number"!=typeof a.length||T(a.length)?e(0):k(a):"Buffer"===a.type&&Array.isArray(a.data)?k(a.data):void 0}function n(a){if(a>=X)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+X.toString(16)+" bytes");return 0|a}function o(a){return+a!=a&&(a=0),b.alloc(+a)}function p(a,c){if(b.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||S(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);var d=a.length,e=arguments.length>2&&arguments[2]===!0;if(!e&&0===d)return 0;for(var f=!1;;)switch(c){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":return N(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*d;case"hex":return d>>>1;case"base64":return Q(a).length;default:if(f)return e?-1:N(a).length;c=(""+c).toLowerCase(),f=!0}}function q(a,b,c){var d=!1;if((void 0===b||b<0)&&(b=0),b>this.length)return"";if((void 0===c||c>this.length)&&(c=this.length),c<=0)return"";if(c>>>=0,b>>>=0,c<=b)return"";for(a||(a="utf8");;)switch(a){case"hex":return F(this,b,c);case"utf8":case"utf-8":return B(this,b,c);case"ascii":return D(this,b,c);case"latin1":case"binary":return E(this,b,c);case"base64":return A(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function r(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function s(a,c,d,e,f){if(0===a.length)return-1;if("string"==typeof d?(e=d,d=0):d>2147483647?d=2147483647:d<-2147483648&&(d=-2147483648),d=+d,T(d)&&(d=f?0:a.length-1),d<0&&(d=a.length+d),d>=a.length){if(f)return-1;d=a.length-1}else if(d<0){if(!f)return-1;d=0}if("string"==typeof c&&(c=b.from(c,e)),b.isBuffer(c))return 0===c.length?-1:t(a,c,d,e,f);if("number"==typeof c)return c=255&c,"function"==typeof Uint8Array.prototype.indexOf?f?Uint8Array.prototype.indexOf.call(a,c,d):Uint8Array.prototype.lastIndexOf.call(a,c,d):t(a,[c],d,e,f);throw new TypeError("val must be string, number or Buffer")}function t(a,b,c,d,e){function f(a,b){return 1===g?a[b]:a.readUInt16BE(b*g)}var g=1,h=a.length,i=b.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(a.length<2||b.length<2)return-1;g=2,h/=2,i/=2,c/=2}var j;if(e){var k=-1;for(j=c;j<h;j++)if(f(a,j)===f(b,k===-1?0:j-k)){if(k===-1&&(k=j),j-k+1===i)return k*g}else k!==-1&&(j-=j-k),k=-1}else for(c+i>h&&(c=h-i),j=c;j>=0;j--){for(var l=!0,m=0;m<i;m++)if(f(a,j+m)!==f(b,m)){l=!1;break}if(l)return j}return-1}function u(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;d>f/2&&(d=f/2);for(var g=0;g<d;++g){var h=parseInt(b.substr(2*g,2),16);if(T(h))return g;a[c+g]=h}return g}function v(a,b,c,d){return R(N(b,a.length-c),a,c,d)}function w(a,b,c,d){return R(O(b),a,c,d)}function x(a,b,c,d){return w(a,b,c,d)}function y(a,b,c,d){return R(Q(b),a,c,d)}function z(a,b,c,d){return R(P(b,a.length-c),a,c,d)}function A(a,b,c){return 0===b&&c===a.length?U.fromByteArray(a):U.fromByteArray(a.slice(b,c))}function B(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;e<c;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(e+h<=c){var i,j,k,l;switch(h){case 1:f<128&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(l<55296||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&l<1114112&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return C(d)}function C(a){var b=a.length;if(b<=Y)return String.fromCharCode.apply(String,a);for(var c="",d=0;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=Y));return c}function D(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;++e)d+=String.fromCharCode(127&a[e]);return d}function E(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}function F(a,b,c){var d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);for(var e="",f=b;f<c;++f)e+=$[a[f]];return e}function G(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function H(a,b,c){if(a%1!==0||a<0)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function I(a,c,d,e,f,g){if(!b.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>f||c<g)throw new RangeError('"value" argument is out of bounds');if(d+e>a.length)throw new RangeError("Index out of range")}function J(a,b,c,d,e,f){if(c+d>a.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function K(a,b,c,d,e){return b=+b,c>>>=0,e||J(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),V.write(a,b,c,d,23,4),c+4}function L(a,b,c,d,e){return b=+b,c>>>=0,e||J(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),V.write(a,b,c,d,52,8),c+8}function M(a){if(a=a.split("=")[0],a=a.trim().replace(Z,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function N(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;g<d;++g){if(c=a.charCodeAt(g),c>55295&&c<57344){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(c<1114112))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function O(a){for(var b=[],c=0;c<a.length;++c)b.push(255&a.charCodeAt(c));return b}function P(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);++g)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function Q(a){return U.toByteArray(M(a))}function R(a,b,c,d){for(var e=0;e<d&&!(e+c>=b.length||e>=a.length);++e)b[e+c]=a[e];return e}function S(a,b){return a instanceof b||null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===b.name}function T(a){return a!==a}var U=a("base64-js"),V=a("ieee754"),W="function"==typeof Symbol&&"function"==typeof Symbol["for"]?Symbol["for"]("nodejs.util.inspect.custom"):null;c.Buffer=b,c.SlowBuffer=o,c.INSPECT_MAX_BYTES=50;var X=2147483647;c.kMaxLength=X,b.TYPED_ARRAY_SUPPORT=d(),b.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(b.prototype,"parent",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.buffer}}),Object.defineProperty(b.prototype,"offset",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&b[Symbol.species]===b&&Object.defineProperty(b,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),b.poolSize=8192,b.from=function(a,b,c){return f(a,b,c)},Object.setPrototypeOf(b.prototype,Uint8Array.prototype),Object.setPrototypeOf(b,Uint8Array),b.alloc=function(a,b,c){return h(a,b,c)},b.allocUnsafe=function(a){return i(a)},b.allocUnsafeSlow=function(a){return i(a)},b.isBuffer=function(a){return null!=a&&a._isBuffer===!0&&a!==b.prototype},b.compare=function(a,c){if(S(a,Uint8Array)&&(a=b.from(a,a.offset,a.byteLength)),S(c,Uint8Array)&&(c=b.from(c,c.offset,c.byteLength)),!b.isBuffer(a)||!b.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===c)return 0;for(var d=a.length,e=c.length,f=0,g=Math.min(d,e);f<g;++f)if(a[f]!==c[f]){d=a[f],e=c[f];break}return d<e?-1:e<d?1:0},b.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},b.concat=function(a,c){if(!Array.isArray(a))throw new TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return b.alloc(0);var d;if(void 0===c)for(c=0,d=0;d<a.length;++d)c+=a[d].length;var e=b.allocUnsafe(c),f=0;for(d=0;d<a.length;++d){var g=a[d];if(S(g,Uint8Array)&&(g=b.from(g)),!b.isBuffer(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(e,f),f+=g.length}return e},b.byteLength=p,b.prototype._isBuffer=!0,b.prototype.swap16=function(){var a=this.length;if(a%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<a;b+=2)r(this,b,b+1);return this},b.prototype.swap32=function(){var a=this.length;if(a%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<a;b+=4)r(this,b,b+3),r(this,b+1,b+2);return this},b.prototype.swap64=function(){var a=this.length;if(a%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<a;b+=8)r(this,b,b+7),r(this,b+1,b+6),r(this,b+2,b+5),r(this,b+3,b+4);return this},b.prototype.toString=function(){var a=this.length;return 0===a?"":0===arguments.length?B(this,0,a):q.apply(this,arguments)},b.prototype.toLocaleString=b.prototype.toString,b.prototype.equals=function(a){if(!b.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a||0===b.compare(this,a)},b.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return a=this.toString("hex",0,b).replace(/(.{2})/g,"$1 ").trim(),this.length>b&&(a+=" ... "),"<Buffer "+a+">"},W&&(b.prototype[W]=b.prototype.inspect),b.prototype.compare=function(a,c,d,e,f){if(S(a,Uint8Array)&&(a=b.from(a,a.offset,a.byteLength)),!b.isBuffer(a))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(void 0===c&&(c=0),void 0===d&&(d=a?a.length:0),void 0===e&&(e=0),void 0===f&&(f=this.length),c<0||d>a.length||e<0||f>this.length)throw new RangeError("out of range index");if(e>=f&&c>=d)return 0;if(e>=f)return-1;if(c>=d)return 1;if(c>>>=0,d>>>=0,e>>>=0,f>>>=0,this===a)return 0;for(var g=f-e,h=d-c,i=Math.min(g,h),j=this.slice(e,f),k=a.slice(c,d),l=0;l<i;++l)if(j[l]!==k[l]){g=j[l],h=k[l];break}return g<h?-1:h<g?1:0},b.prototype.includes=function(a,b,c){return this.indexOf(a,b,c)!==-1},b.prototype.indexOf=function(a,b,c){return s(this,a,b,c,!0)},b.prototype.lastIndexOf=function(a,b,c){return s(this,a,b,c,!1)},b.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else{if(!isFinite(b))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");b>>>=0,isFinite(c)?(c>>>=0,void 0===d&&(d="utf8")):(d=c,c=void 0)}var e=this.length-b;if((void 0===c||c>e)&&(c=e),a.length>0&&(c<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(var f=!1;;)switch(d){case"hex":return u(this,a,b,c);case"utf8":case"utf-8":return v(this,a,b,c);case"ascii":return w(this,a,b,c);case"latin1":case"binary":return x(this,a,b,c);case"base64":return y(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,a,b,c);default:if(f)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),f=!0}},b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Y=4096;b.prototype.slice=function(a,c){var d=this.length;a=~~a,c=void 0===c?d:~~c,a<0?(a+=d,a<0&&(a=0)):a>d&&(a=d),c<0?(c+=d,c<0&&(c=0)):c>d&&(c=d),c<a&&(c=a);var e=this.subarray(a,c);return Object.setPrototypeOf(e,b.prototype),e},b.prototype.readUIntLE=function(a,b,c){a>>>=0,b>>>=0,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},b.prototype.readUIntBE=function(a,b,c){a>>>=0,b>>>=0,c||H(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},b.prototype.readUInt8=function(a,b){return a>>>=0,b||H(a,1,this.length),this[a]},b.prototype.readUInt16LE=function(a,b){return a>>>=0,b||H(a,2,this.length),this[a]|this[a+1]<<8},b.prototype.readUInt16BE=function(a,b){return a>>>=0,b||H(a,2,this.length),this[a]<<8|this[a+1]},b.prototype.readUInt32LE=function(a,b){return a>>>=0,b||H(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},b.prototype.readUInt32BE=function(a,b){return a>>>=0,b||H(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},b.prototype.readIntLE=function(a,b,c){a>>>=0,b>>>=0,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},b.prototype.readIntBE=function(a,b,c){a>>>=0,b>>>=0,c||H(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},b.prototype.readInt8=function(a,b){return a>>>=0,b||H(a,1,this.length),128&this[a]?(255-this[a]+1)*-1:this[a]},b.prototype.readInt16LE=function(a,b){a>>>=0,b||H(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},b.prototype.readInt16BE=function(a,b){a>>>=0,b||H(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},b.prototype.readInt32LE=function(a,b){return a>>>=0,b||H(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},b.prototype.readInt32BE=function(a,b){return a>>>=0,b||H(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},b.prototype.readFloatLE=function(a,b){return a>>>=0,b||H(a,4,this.length),V.read(this,a,!0,23,4)},b.prototype.readFloatBE=function(a,b){return a>>>=0,b||H(a,4,this.length),V.read(this,a,!1,23,4)},b.prototype.readDoubleLE=function(a,b){return a>>>=0,b||H(a,8,this.length),V.read(this,a,!0,52,8)},b.prototype.readDoubleBE=function(a,b){return a>>>=0,b||H(a,8,this.length),V.read(this,a,!1,52,8)},b.prototype.writeUIntLE=function(a,b,c,d){if(a=+a,b>>>=0,c>>>=0,!d){var e=Math.pow(2,8*c)-1;I(this,a,b,c,e,0)}var f=1,g=0;for(this[b]=255&a;++g<c&&(f*=256);)this[b+g]=a/f&255;return b+c},b.prototype.writeUIntBE=function(a,b,c,d){if(a=+a,b>>>=0,c>>>=0,!d){var e=Math.pow(2,8*c)-1;I(this,a,b,c,e,0)}var f=c-1,g=1;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=a/g&255;return b+c},b.prototype.writeUInt8=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,1,255,0),this[b]=255&a,b+1},b.prototype.writeUInt16LE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,2,65535,0),this[b]=255&a,this[b+1]=a>>>8,b+2},b.prototype.writeUInt16BE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,2,65535,0),
this[b]=a>>>8,this[b+1]=255&a,b+2},b.prototype.writeUInt32LE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,4,4294967295,0),this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a,b+4},b.prototype.writeUInt32BE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,4,4294967295,0),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},b.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b>>>=0,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=0,g=1,h=0;for(this[b]=255&a;++f<c&&(g*=256);)a<0&&0===h&&0!==this[b+f-1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},b.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b>>>=0,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0;for(this[b+f]=255&a;--f>=0&&(g*=256);)a<0&&0===h&&0!==this[b+f+1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},b.prototype.writeInt8=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,1,127,-128),a<0&&(a=255+a+1),this[b]=255&a,b+1},b.prototype.writeInt16LE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,2,32767,-32768),this[b]=255&a,this[b+1]=a>>>8,b+2},b.prototype.writeInt16BE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,2,32767,-32768),this[b]=a>>>8,this[b+1]=255&a,b+2},b.prototype.writeInt32LE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,4,2147483647,-2147483648),this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24,b+4},b.prototype.writeInt32BE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},b.prototype.writeFloatLE=function(a,b,c){return K(this,a,b,!0,c)},b.prototype.writeFloatBE=function(a,b,c){return K(this,a,b,!1,c)},b.prototype.writeDoubleLE=function(a,b,c){return L(this,a,b,!0,c)},b.prototype.writeDoubleBE=function(a,b,c){return L(this,a,b,!1,c)},b.prototype.copy=function(a,c,d,e){if(!b.isBuffer(a))throw new TypeError("argument should be a Buffer");if(d||(d=0),e||0===e||(e=this.length),c>=a.length&&(c=a.length),c||(c=0),e>0&&e<d&&(e=d),e===d)return 0;if(0===a.length||0===this.length)return 0;if(c<0)throw new RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length),a.length-c<e-d&&(e=a.length-c+d);var f=e-d;if(this===a&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(c,d,e);else if(this===a&&d<c&&c<e)for(var g=f-1;g>=0;--g)a[g+c]=this[g+d];else Uint8Array.prototype.set.call(a,this.subarray(d,e),c);return f},b.prototype.fill=function(a,c,d,e){if("string"==typeof a){if("string"==typeof c?(e=c,c=0,d=this.length):"string"==typeof d&&(e=d,d=this.length),void 0!==e&&"string"!=typeof e)throw new TypeError("encoding must be a string");if("string"==typeof e&&!b.isEncoding(e))throw new TypeError("Unknown encoding: "+e);if(1===a.length){var f=a.charCodeAt(0);("utf8"===e&&f<128||"latin1"===e)&&(a=f)}}else"number"==typeof a?a=255&a:"boolean"==typeof a&&(a=Number(a));if(c<0||this.length<c||this.length<d)throw new RangeError("Out of range index");if(d<=c)return this;c>>>=0,d=void 0===d?this.length:d>>>0,a||(a=0);var g;if("number"==typeof a)for(g=c;g<d;++g)this[g]=a;else{var h=b.isBuffer(a)?a:b.from(a,e),i=h.length;if(0===i)throw new TypeError('The value "'+a+'" is invalid for argument "value"');for(g=0;g<d-c;++g)this[g+c]=h[g%i]}return this};var Z=/[^+\/0-9A-Za-z-_]/g,$=function(){for(var a="0123456789abcdef",b=new Array(256),c=0;c<16;++c)for(var d=16*c,e=0;e<16;++e)b[d+e]=a[c]+a[e];return b}()}).call(this,a("buffer").Buffer)},{"base64-js":16,buffer:19,ieee754:33}],20:[function(a,b,c){var d=c;d.utils=a("./hash/utils"),d.common=a("./hash/common"),d.sha=a("./hash/sha"),d.ripemd=a("./hash/ripemd"),d.hmac=a("./hash/hmac"),d.sha1=d.sha.sha1,d.sha256=d.sha.sha256,d.sha224=d.sha.sha224,d.sha384=d.sha.sha384,d.sha512=d.sha.sha512,d.ripemd160=d.ripemd.ripemd160},{"./hash/common":21,"./hash/hmac":22,"./hash/ripemd":23,"./hash/sha":24,"./hash/utils":31}],21:[function(a,b,c){"use strict";function d(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var e=a("./utils"),f=a("minimalistic-assert");c.BlockHash=d,d.prototype.update=function(a,b){if(a=e.toArray(a,b),this.pending?this.pending=this.pending.concat(a):this.pending=a,this.pendingTotal+=a.length,this.pending.length>=this._delta8){a=this.pending;var c=a.length%this._delta8;this.pending=a.slice(a.length-c,a.length),0===this.pending.length&&(this.pending=null),a=e.join32(a,0,a.length-c,this.endian);for(var d=0;d<a.length;d+=this._delta32)this._update(a,d,d+this._delta32)}return this},d.prototype.digest=function(a){return this.update(this._pad()),f(null===this.pending),this._digest(a)},d.prototype._pad=function(){var a=this.pendingTotal,b=this._delta8,c=b-(a+this.padLength)%b,d=new Array(c+this.padLength);d[0]=128;for(var e=1;e<c;e++)d[e]=0;if(a<<=3,"big"===this.endian){for(var f=8;f<this.padLength;f++)d[e++]=0;d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=a>>>24&255,d[e++]=a>>>16&255,d[e++]=a>>>8&255,d[e++]=255&a}else for(d[e++]=255&a,d[e++]=a>>>8&255,d[e++]=a>>>16&255,d[e++]=a>>>24&255,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=0,f=8;f<this.padLength;f++)d[e++]=0;return d}},{"./utils":31,"minimalistic-assert":35}],22:[function(a,b,c){"use strict";function d(a,b,c){return this instanceof d?(this.Hash=a,this.blockSize=a.blockSize/8,this.outSize=a.outSize/8,this.inner=null,this.outer=null,void this._init(e.toArray(b,c))):new d(a,b,c)}var e=a("./utils"),f=a("minimalistic-assert");b.exports=d,d.prototype._init=function(a){a.length>this.blockSize&&(a=(new this.Hash).update(a).digest()),f(a.length<=this.blockSize);for(var b=a.length;b<this.blockSize;b++)a.push(0);for(b=0;b<a.length;b++)a[b]^=54;for(this.inner=(new this.Hash).update(a),b=0;b<a.length;b++)a[b]^=106;this.outer=(new this.Hash).update(a)},d.prototype.update=function(a,b){return this.inner.update(a,b),this},d.prototype.digest=function(a){return this.outer.update(this.inner.digest()),this.outer.digest(a)}},{"./utils":31,"minimalistic-assert":35}],23:[function(a,b,c){"use strict";function d(){return this instanceof d?(n.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.endian="little")):new d}function e(a,b,c,d){return a<=15?b^c^d:a<=31?b&c|~b&d:a<=47?(b|~c)^d:a<=63?b&d|c&~d:b^(c|~d)}function f(a){return a<=15?0:a<=31?1518500249:a<=47?1859775393:a<=63?2400959708:2840853838}function g(a){return a<=15?1352829926:a<=31?1548603684:a<=47?1836072691:a<=63?2053994217:0}var h=a("./utils"),i=a("./common"),j=h.rotl32,k=h.sum32,l=h.sum32_3,m=h.sum32_4,n=i.BlockHash;h.inherits(d,n),c.ripemd160=d,d.blockSize=512,d.outSize=160,d.hmacStrength=192,d.padLength=64,d.prototype._update=function(a,b){for(var c=this.h[0],d=this.h[1],h=this.h[2],i=this.h[3],n=this.h[4],s=c,t=d,u=h,v=i,w=n,x=0;x<80;x++){var y=k(j(m(c,e(x,d,h,i),a[o[x]+b],f(x)),q[x]),n);c=n,n=i,i=j(h,10),h=d,d=y,y=k(j(m(s,e(79-x,t,u,v),a[p[x]+b],g(x)),r[x]),w),s=w,w=v,v=j(u,10),u=t,t=y}y=l(this.h[1],h,v),this.h[1]=l(this.h[2],i,w),this.h[2]=l(this.h[3],n,s),this.h[3]=l(this.h[4],c,t),this.h[4]=l(this.h[0],d,u),this.h[0]=y},d.prototype._digest=function(a){return"hex"===a?h.toHex32(this.h,"little"):h.split32(this.h,"little")};var o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],q=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],r=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":21,"./utils":31}],24:[function(a,b,c){"use strict";c.sha1=a("./sha/1"),c.sha224=a("./sha/224"),c.sha256=a("./sha/256"),c.sha384=a("./sha/384"),c.sha512=a("./sha/512")},{"./sha/1":25,"./sha/224":26,"./sha/256":27,"./sha/384":28,"./sha/512":29}],25:[function(a,b,c){"use strict";function d(){return this instanceof d?(l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.W=new Array(80))):new d}var e=a("../utils"),f=a("../common"),g=a("./common"),h=e.rotl32,i=e.sum32,j=e.sum32_5,k=g.ft_1,l=f.BlockHash,m=[1518500249,1859775393,2400959708,3395469782];e.inherits(d,l),b.exports=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(a,b){for(var c=this.W,d=0;d<16;d++)c[d]=a[b+d];for(;d<c.length;d++)c[d]=h(c[d-3]^c[d-8]^c[d-14]^c[d-16],1);var e=this.h[0],f=this.h[1],g=this.h[2],l=this.h[3],n=this.h[4];for(d=0;d<c.length;d++){var o=~~(d/20),p=j(h(e,5),k(o,f,g,l),n,c[d],m[o]);n=l,l=g,g=h(f,30),f=e,e=p}this.h[0]=i(this.h[0],e),this.h[1]=i(this.h[1],f),this.h[2]=i(this.h[2],g),this.h[3]=i(this.h[3],l),this.h[4]=i(this.h[4],n)},d.prototype._digest=function(a){return"hex"===a?e.toHex32(this.h,"big"):e.split32(this.h,"big")}},{"../common":21,"../utils":31,"./common":30}],26:[function(a,b,c){"use strict";function d(){return this instanceof d?(f.call(this),void(this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])):new d}var e=a("../utils"),f=a("./256");e.inherits(d,f),b.exports=d,d.blockSize=512,d.outSize=224,d.hmacStrength=192,d.padLength=64,d.prototype._digest=function(a){return"hex"===a?e.toHex32(this.h.slice(0,7),"big"):e.split32(this.h.slice(0,7),"big")}},{"../utils":31,"./256":27}],27:[function(a,b,c){"use strict";function d(){return this instanceof d?(r.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=s,void(this.W=new Array(64))):new d}var e=a("../utils"),f=a("../common"),g=a("./common"),h=a("minimalistic-assert"),i=e.sum32,j=e.sum32_4,k=e.sum32_5,l=g.ch32,m=g.maj32,n=g.s0_256,o=g.s1_256,p=g.g0_256,q=g.g1_256,r=f.BlockHash,s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];e.inherits(d,r),b.exports=d,d.blockSize=512,d.outSize=256,d.hmacStrength=192,d.padLength=64,d.prototype._update=function(a,b){for(var c=this.W,d=0;d<16;d++)c[d]=a[b+d];for(;d<c.length;d++)c[d]=j(q(c[d-2]),c[d-7],p(c[d-15]),c[d-16]);var e=this.h[0],f=this.h[1],g=this.h[2],r=this.h[3],s=this.h[4],t=this.h[5],u=this.h[6],v=this.h[7];for(h(this.k.length===c.length),d=0;d<c.length;d++){var w=k(v,o(s),l(s,t,u),this.k[d],c[d]),x=i(n(e),m(e,f,g));v=u,u=t,t=s,s=i(r,w),r=g,g=f,f=e,e=i(w,x)}this.h[0]=i(this.h[0],e),this.h[1]=i(this.h[1],f),this.h[2]=i(this.h[2],g),this.h[3]=i(this.h[3],r),this.h[4]=i(this.h[4],s),this.h[5]=i(this.h[5],t),this.h[6]=i(this.h[6],u),this.h[7]=i(this.h[7],v)},d.prototype._digest=function(a){return"hex"===a?e.toHex32(this.h,"big"):e.split32(this.h,"big")}},{"../common":21,"../utils":31,"./common":30,"minimalistic-assert":35}],28:[function(a,b,c){"use strict";function d(){return this instanceof d?(f.call(this),void(this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428])):new d}var e=a("../utils"),f=a("./512");e.inherits(d,f),b.exports=d,d.blockSize=1024,d.outSize=384,d.hmacStrength=192,d.padLength=128,d.prototype._digest=function(a){return"hex"===a?e.toHex32(this.h.slice(0,12),"big"):e.split32(this.h.slice(0,12),"big")}},{"../utils":31,"./512":29}],29:[function(a,b,c){"use strict";function d(){return this instanceof d?(E.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=F,void(this.W=new Array(160))):new d}function e(a,b,c,d,e){var f=a&c^~a&e;return f<0&&(f+=4294967296),f}function f(a,b,c,d,e,f){var g=b&d^~b&f;return g<0&&(g+=4294967296),g}function g(a,b,c,d,e){var f=a&c^a&e^c&e;return f<0&&(f+=4294967296),f}function h(a,b,c,d,e,f){var g=b&d^b&f^d&f;return g<0&&(g+=4294967296),g}function i(a,b){var c=t(a,b,28),d=t(b,a,2),e=t(b,a,7),f=c^d^e;return f<0&&(f+=4294967296),f}function j(a,b){var c=u(a,b,28),d=u(b,a,2),e=u(b,a,7),f=c^d^e;return f<0&&(f+=4294967296),f}function k(a,b){var c=t(a,b,14),d=t(a,b,18),e=t(b,a,9),f=c^d^e;return f<0&&(f+=4294967296),f}function l(a,b){var c=u(a,b,14),d=u(a,b,18),e=u(b,a,9),f=c^d^e;return f<0&&(f+=4294967296),f}function m(a,b){var c=t(a,b,1),d=t(a,b,8),e=v(a,b,7),f=c^d^e;return f<0&&(f+=4294967296),f}function n(a,b){var c=u(a,b,1),d=u(a,b,8),e=w(a,b,7),f=c^d^e;return f<0&&(f+=4294967296),f}function o(a,b){var c=t(a,b,19),d=t(b,a,29),e=v(a,b,6),f=c^d^e;return f<0&&(f+=4294967296),f}function p(a,b){var c=u(a,b,19),d=u(b,a,29),e=w(a,b,6),f=c^d^e;return f<0&&(f+=4294967296),f}var q=a("../utils"),r=a("../common"),s=a("minimalistic-assert"),t=q.rotr64_hi,u=q.rotr64_lo,v=q.shr64_hi,w=q.shr64_lo,x=q.sum64,y=q.sum64_hi,z=q.sum64_lo,A=q.sum64_4_hi,B=q.sum64_4_lo,C=q.sum64_5_hi,D=q.sum64_5_lo,E=r.BlockHash,F=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];q.inherits(d,E),b.exports=d,d.blockSize=1024,d.outSize=512,d.hmacStrength=192,d.padLength=128,d.prototype._prepareBlock=function(a,b){for(var c=this.W,d=0;d<32;d++)c[d]=a[b+d];for(;d<c.length;d+=2){var e=o(c[d-4],c[d-3]),f=p(c[d-4],c[d-3]),g=c[d-14],h=c[d-13],i=m(c[d-30],c[d-29]),j=n(c[d-30],c[d-29]),k=c[d-32],l=c[d-31];c[d]=A(e,f,g,h,i,j,k,l),c[d+1]=B(e,f,g,h,i,j,k,l)}},d.prototype._update=function(a,b){this._prepareBlock(a,b);var c=this.W,d=this.h[0],m=this.h[1],n=this.h[2],o=this.h[3],p=this.h[4],q=this.h[5],r=this.h[6],t=this.h[7],u=this.h[8],v=this.h[9],w=this.h[10],A=this.h[11],B=this.h[12],E=this.h[13],F=this.h[14],G=this.h[15];s(this.k.length===c.length);for(var H=0;H<c.length;H+=2){var I=F,J=G,K=k(u,v),L=l(u,v),M=e(u,v,w,A,B,E),N=f(u,v,w,A,B,E),O=this.k[H],P=this.k[H+1],Q=c[H],R=c[H+1],S=C(I,J,K,L,M,N,O,P,Q,R),T=D(I,J,K,L,M,N,O,P,Q,R);I=i(d,m),J=j(d,m),K=g(d,m,n,o,p,q),L=h(d,m,n,o,p,q);var U=y(I,J,K,L),V=z(I,J,K,L);F=B,G=E,B=w,E=A,w=u,A=v,u=y(r,t,S,T),v=z(t,t,S,T),r=p,t=q,p=n,q=o,n=d,o=m,d=y(S,T,U,V),m=z(S,T,U,V)}x(this.h,0,d,m),x(this.h,2,n,o),x(this.h,4,p,q),x(this.h,6,r,t),x(this.h,8,u,v),x(this.h,10,w,A),x(this.h,12,B,E),x(this.h,14,F,G)},d.prototype._digest=function(a){return"hex"===a?q.toHex32(this.h,"big"):q.split32(this.h,"big")}},{"../common":21,"../utils":31,"minimalistic-assert":35}],30:[function(a,b,c){"use strict";function d(a,b,c,d){return 0===a?e(b,c,d):1===a||3===a?g(b,c,d):2===a?f(b,c,d):void 0}function e(a,b,c){return a&b^~a&c}function f(a,b,c){return a&b^a&c^b&c}function g(a,b,c){return a^b^c}function h(a){return m(a,2)^m(a,13)^m(a,22)}function i(a){return m(a,6)^m(a,11)^m(a,25)}function j(a){return m(a,7)^m(a,18)^a>>>3}function k(a){return m(a,17)^m(a,19)^a>>>10}var l=a("../utils"),m=l.rotr32;c.ft_1=d,c.ch32=e,c.maj32=f,c.p32=g,c.s0_256=h,c.s1_256=i,c.g0_256=j,c.g1_256=k},{"../utils":31}],31:[function(a,b,c){"use strict";function d(a,b){return 55296===(64512&a.charCodeAt(b))&&(!(b<0||b+1>=a.length)&&56320===(64512&a.charCodeAt(b+1)))}function e(a,b){if(Array.isArray(a))return a.slice();if(!a)return[];var c=[];if("string"==typeof a)if(b){if("hex"===b)for(a=a.replace(/[^a-z0-9]+/gi,""),a.length%2!==0&&(a="0"+a),f=0;f<a.length;f+=2)c.push(parseInt(a[f]+a[f+1],16))}else for(var e=0,f=0;f<a.length;f++){var g=a.charCodeAt(f);g<128?c[e++]=g:g<2048?(c[e++]=g>>6|192,c[e++]=63&g|128):d(a,f)?(g=65536+((1023&g)<<10)+(1023&a.charCodeAt(++f)),c[e++]=g>>18|240,c[e++]=g>>12&63|128,c[e++]=g>>6&63|128,c[e++]=63&g|128):(c[e++]=g>>12|224,c[e++]=g>>6&63|128,c[e++]=63&g|128)}else for(f=0;f<a.length;f++)c[f]=0|a[f];return c}function f(a){for(var b="",c=0;c<a.length;c++)b+=i(a[c].toString(16));return b}function g(a){var b=a>>>24|a>>>8&65280|a<<8&16711680|(255&a)<<24;return b>>>0}function h(a,b){for(var c="",d=0;d<a.length;d++){var e=a[d];"little"===b&&(e=g(e)),c+=j(e.toString(16))}return c}function i(a){return 1===a.length?"0"+a:a}function j(a){return 7===a.length?"0"+a:6===a.length?"00"+a:5===a.length?"000"+a:4===a.length?"0000"+a:3===a.length?"00000"+a:2===a.length?"000000"+a:1===a.length?"0000000"+a:a}function k(a,b,c,d){var e=c-b;D(e%4===0);for(var f=new Array(e/4),g=0,h=b;g<f.length;g++,h+=4){var i;i="big"===d?a[h]<<24|a[h+1]<<16|a[h+2]<<8|a[h+3]:a[h+3]<<24|a[h+2]<<16|a[h+1]<<8|a[h],f[g]=i>>>0}return f}function l(a,b){for(var c=new Array(4*a.length),d=0,e=0;d<a.length;d++,e+=4){var f=a[d];"big"===b?(c[e]=f>>>24,c[e+1]=f>>>16&255,c[e+2]=f>>>8&255,c[e+3]=255&f):(c[e+3]=f>>>24,c[e+2]=f>>>16&255,c[e+1]=f>>>8&255,c[e]=255&f)}return c}function m(a,b){return a>>>b|a<<32-b}function n(a,b){return a<<b|a>>>32-b}function o(a,b){return a+b>>>0}function p(a,b,c){return a+b+c>>>0}function q(a,b,c,d){return a+b+c+d>>>0}function r(a,b,c,d,e){return a+b+c+d+e>>>0}function s(a,b,c,d){var e=a[b],f=a[b+1],g=d+f>>>0,h=(g<d?1:0)+c+e;a[b]=h>>>0,a[b+1]=g}function t(a,b,c,d){var e=b+d>>>0,f=(e<b?1:0)+a+c;return f>>>0}function u(a,b,c,d){var e=b+d;return e>>>0}function v(a,b,c,d,e,f,g,h){var i=0,j=b;j=j+d>>>0,i+=j<b?1:0,j=j+f>>>0,i+=j<f?1:0,j=j+h>>>0,i+=j<h?1:0;var k=a+c+e+g+i;return k>>>0}function w(a,b,c,d,e,f,g,h){var i=b+d+f+h;return i>>>0}function x(a,b,c,d,e,f,g,h,i,j){var k=0,l=b;l=l+d>>>0,k+=l<b?1:0,l=l+f>>>0,k+=l<f?1:0,l=l+h>>>0,k+=l<h?1:0,l=l+j>>>0,k+=l<j?1:0;var m=a+c+e+g+i+k;return m>>>0}function y(a,b,c,d,e,f,g,h,i,j){var k=b+d+f+h+j;return k>>>0}function z(a,b,c){var d=b<<32-c|a>>>c;return d>>>0}function A(a,b,c){var d=a<<32-c|b>>>c;return d>>>0}function B(a,b,c){return a>>>c}function C(a,b,c){var d=a<<32-c|b>>>c;return d>>>0}var D=a("minimalistic-assert"),E=a("inherits");c.inherits=E,c.toArray=e,c.toHex=f,c.htonl=g,c.toHex32=h,c.zero2=i,c.zero8=j,c.join32=k,c.split32=l,c.rotr32=m,c.rotl32=n,c.sum32=o,c.sum32_3=p,c.sum32_4=q,c.sum32_5=r,c.sum64=s,c.sum64_hi=t,c.sum64_lo=u,c.sum64_4_hi=v,c.sum64_4_lo=w,c.sum64_5_hi=x,c.sum64_5_lo=y,c.rotr64_hi=z,c.rotr64_lo=A,c.shr64_hi=B,c.shr64_lo=C},{inherits:34,"minimalistic-assert":35}],32:[function(a,b,c){"use strict";function d(a){if(!(this instanceof d))return new d(a);this.hash=a.hash,this.predResist=!!a.predResist,this.outLen=this.hash.outSize,this.minEntropy=a.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var b=f.toArray(a.entropy,a.entropyEnc||"hex"),c=f.toArray(a.nonce,a.nonceEnc||"hex"),e=f.toArray(a.pers,a.persEnc||"hex");g(b.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(b,c,e)}var e=a("hash.js"),f=a("minimalistic-crypto-utils"),g=a("minimalistic-assert");b.exports=d,d.prototype._init=function(a,b,c){var d=a.concat(b).concat(c);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var e=0;e<this.V.length;e++)this.K[e]=0,this.V[e]=1;this._update(d),this._reseed=1,this.reseedInterval=281474976710656},d.prototype._hmac=function(){return new e.hmac(this.hash,this.K)},d.prototype._update=function(a){var b=this._hmac().update(this.V).update([0]);a&&(b=b.update(a)),this.K=b.digest(),this.V=this._hmac().update(this.V).digest(),a&&(this.K=this._hmac().update(this.V).update([1]).update(a).digest(),this.V=this._hmac().update(this.V).digest())},d.prototype.reseed=function(a,b,c,d){"string"!=typeof b&&(d=c,c=b,b=null),a=f.toArray(a,b),c=f.toArray(c,d),g(a.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(a.concat(c||[])),this._reseed=1},d.prototype.generate=function(a,b,c,d){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof b&&(d=c,c=b,b=null),c&&(c=f.toArray(c,d||"hex"),this._update(c));for(var e=[];e.length<a;)this.V=this._hmac().update(this.V).digest(),e=e.concat(this.V);var g=e.slice(0,a);return this._update(c),this._reseed++,f.encode(g,b)}},{"hash.js":20,"minimalistic-assert":35,"minimalistic-crypto-utils":36}],33:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],34:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){b&&(a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:b.exports=function(a,b){if(b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}}},{}],35:[function(a,b,c){function d(a,b){if(!a)throw new Error(b||"Assertion failed")}b.exports=d,d.equal=function(a,b,c){if(a!=b)throw new Error(c||"Assertion failed: "+a+" != "+b)}},{}],36:[function(a,b,c){"use strict";function d(a,b){if(Array.isArray(a))return a.slice();if(!a)return[];var c=[];if("string"!=typeof a){for(var d=0;d<a.length;d++)c[d]=0|a[d];return c}if("hex"===b){a=a.replace(/[^a-z0-9]+/gi,""),a.length%2!==0&&(a="0"+a);for(var d=0;d<a.length;d+=2)c.push(parseInt(a[d]+a[d+1],16))}else for(var d=0;d<a.length;d++){var e=a.charCodeAt(d),f=e>>8,g=255&e;f?c.push(f,g):c.push(g)}return c}function e(a){return 1===a.length?"0"+a:a}function f(a){for(var b="",c=0;c<a.length;c++)b+=e(a[c].toString(16));return b}var g=c;g.toArray=d,g.zero2=e,g.toHex=f,g.encode=function(a,b){return"hex"===b?f(a):a}},{}],37:[function(a,b,c){function d(a,b){var c=function(){return new i.aes.Algorithm(a,b)};i.cipher.registerAlgorithm(a,c)}function e(){o=!0,l=[0,1,2,4,8,16,32,64,128,27,54];for(var a=new Array(256),b=0;b<128;++b)a[b]=b<<1,a[b+128]=b+128<<1^283;j=new Array(256),k=new Array(256),m=new Array(4),n=new Array(4);for(var b=0;b<4;++b)m[b]=new Array(256),n[b]=new Array(256);for(var c,d,e,f,g,h,i,p=0,q=0,b=0;b<256;++b){f=q^q<<1^q<<2^q<<3^q<<4,f=f>>8^255&f^99,j[p]=f,k[f]=p,g=a[f],c=a[p],d=a[c],e=a[d],h=g<<24^f<<16^f<<8^(f^g),i=(c^d^e)<<24^(p^e)<<16^(p^d^e)<<8^(p^c^e);for(var r=0;r<4;++r)m[r][p]=h,n[r][f]=i,h=h<<24|h>>>8,i=i<<24|i>>>8;0===p?p=q=1:(p=c^a[a[a[c^e]]],q^=a[a[q]])}}function f(a,b){for(var c,d=a.slice(0),e=1,f=d.length,g=f+6+1,h=p*g,i=f;i<h;++i)c=d[i-1],i%f===0?(c=j[c>>>16&255]<<24^j[c>>>8&255]<<16^j[255&c]<<8^j[c>>>24]^l[e]<<24,e++):f>6&&i%f===4&&(c=j[c>>>24]<<24^j[c>>>16&255]<<16^j[c>>>8&255]<<8^j[255&c]),d[i]=d[i-f]^c;if(b){var k,m=n[0],o=n[1],q=n[2],r=n[3],s=d.slice(0);h=d.length;for(var i=0,t=h-p;i<h;i+=p,t-=p)if(0===i||i===h-p)s[i]=d[t],s[i+1]=d[t+3],s[i+2]=d[t+2],s[i+3]=d[t+1];else for(var u=0;u<p;++u)k=d[t+u],s[i+(3&-u)]=m[j[k>>>24]]^o[j[k>>>16&255]]^q[j[k>>>8&255]]^r[j[255&k]];d=s}return d}function g(a,b,c,d){var e,f,g,h,i,l=a.length/4-1;d?(e=n[0],f=n[1],g=n[2],h=n[3],i=k):(e=m[0],f=m[1],g=m[2],h=m[3],i=j);var o,p,q,r,s,t,u;o=b[0]^a[0],p=b[d?3:1]^a[1],q=b[2]^a[2],r=b[d?1:3]^a[3];for(var v=3,w=1;w<l;++w)s=e[o>>>24]^f[p>>>16&255]^g[q>>>8&255]^h[255&r]^a[++v],t=e[p>>>24]^f[q>>>16&255]^g[r>>>8&255]^h[255&o]^a[++v],u=e[q>>>24]^f[r>>>16&255]^g[o>>>8&255]^h[255&p]^a[++v],r=e[r>>>24]^f[o>>>16&255]^g[p>>>8&255]^h[255&q]^a[++v],o=s,p=t,q=u;c[0]=i[o>>>24]<<24^i[p>>>16&255]<<16^i[q>>>8&255]<<8^i[255&r]^a[++v],c[d?3:1]=i[p>>>24]<<24^i[q>>>16&255]<<16^i[r>>>8&255]<<8^i[255&o]^a[++v],c[2]=i[q>>>24]<<24^i[r>>>16&255]<<16^i[o>>>8&255]<<8^i[255&p]^a[++v],c[d?1:3]=i[r>>>24]<<24^i[o>>>16&255]<<16^i[p>>>8&255]<<8^i[255&q]^a[++v]}function h(a){a=a||{};var b,c=(a.mode||"CBC").toUpperCase(),d="AES-"+c;b=a.decrypt?i.cipher.createDecipher(d,a.key):i.cipher.createCipher(d,a.key);var e=b.start;return b.start=function(a,c){var d=null;c instanceof i.util.ByteBuffer&&(d=c,c={}),c=c||{},c.output=d,c.iv=a,e.call(b,c)},b}var i=a("./forge");a("./cipher"),a("./cipherModes"),a("./util"),b.exports=i.aes=i.aes||{},i.aes.startEncrypting=function(a,b,c,d){var e=h({key:a,output:c,decrypt:!1,mode:d});return e.start(b),e},i.aes.createEncryptionCipher=function(a,b){return h({key:a,output:null,decrypt:!1,mode:b})},i.aes.startDecrypting=function(a,b,c,d){var e=h({key:a,output:c,decrypt:!0,mode:d});return e.start(b),e},i.aes.createDecryptionCipher=function(a,b){return h({key:a,output:null,decrypt:!0,mode:b})},i.aes.Algorithm=function(a,b){o||e();var c=this;c.name=a,c.mode=new b({blockSize:16,cipher:{encrypt:function(a,b){return g(c._w,a,b,!1)},decrypt:function(a,b){return g(c._w,a,b,!0)}}}),c._init=!1},i.aes.Algorithm.prototype.initialize=function(a){if(!this._init){var b,c=a.key;if("string"!=typeof c||16!==c.length&&24!==c.length&&32!==c.length){if(i.util.isArray(c)&&(16===c.length||24===c.length||32===c.length)){b=c,c=i.util.createBuffer();for(var d=0;d<b.length;++d)c.putByte(b[d])}}else c=i.util.createBuffer(c);if(!i.util.isArray(c)){b=c,c=[];var e=b.length();if(16===e||24===e||32===e){e>>>=2;for(var d=0;d<e;++d)c.push(b.getInt32())}}if(!i.util.isArray(c)||4!==c.length&&6!==c.length&&8!==c.length)throw new Error("Invalid key parameter.");var g=this.mode.name,h=["CFB","OFB","CTR","GCM"].indexOf(g)!==-1;this._w=f(c,a.decrypt&&!h),this._init=!0}},i.aes._expandKey=function(a,b){return o||e(),f(a,b)},i.aes._updateBlock=g,d("AES-ECB",i.cipher.modes.ecb),d("AES-CBC",i.cipher.modes.cbc),d("AES-CFB",i.cipher.modes.cfb),d("AES-OFB",i.cipher.modes.ofb),d("AES-CTR",i.cipher.modes.ctr),d("AES-GCM",i.cipher.modes.gcm);var j,k,l,m,n,o=!1,p=4},{"./cipher":42,"./cipherModes":43,"./forge":47,"./util":79}],38:[function(a,b,c){function d(a,b,c){var d=b.entity===j.tls.ConnectionEnd.client;a.read.cipherState={init:!1,cipher:j.cipher.createDecipher("AES-CBC",d?c.keys.server_write_key:c.keys.client_write_key),iv:d?c.keys.server_write_IV:c.keys.client_write_IV},a.write.cipherState={init:!1,cipher:j.cipher.createCipher("AES-CBC",d?c.keys.client_write_key:c.keys.server_write_key),iv:d?c.keys.client_write_IV:c.keys.server_write_IV},a.read.cipherFunction=h,a.write.cipherFunction=e,a.read.macLength=a.write.macLength=c.mac_length,a.read.macFunction=a.write.macFunction=k.hmac_sha1}function e(a,b){var c=!1,d=b.macFunction(b.macKey,b.sequenceNumber,a);a.fragment.putBytes(d),b.updateSequenceNumber();var e;e=a.version.minor===k.Versions.TLS_1_0.minor?b.cipherState.init?null:b.cipherState.iv:j.random.getBytesSync(16),b.cipherState.init=!0;var g=b.cipherState.cipher;return g.start({iv:e}),a.version.minor>=k.Versions.TLS_1_1.minor&&g.output.putBytes(e),g.update(a.fragment),g.finish(f)&&(a.fragment=g.output,a.length=a.fragment.length(),c=!0),c}function f(a,b,c){if(!c){var d=a-b.length()%a;b.fillWithByte(d-1,d)}return!0}function g(a,b,c){var d=!0;if(c){for(var e=b.length(),f=b.last(),g=e-1-f;g<e-1;++g)d=d&&b.at(g)==f;d&&b.truncate(f+1)}return d}function h(a,b){var c,d=!1;c=a.version.minor===k.Versions.TLS_1_0.minor?b.cipherState.init?null:b.cipherState.iv:a.fragment.getBytes(16),b.cipherState.init=!0;var e=b.cipherState.cipher;e.start({iv:c}),e.update(a.fragment),d=e.finish(g);var f=b.macLength,h=j.random.getBytesSync(f),l=e.output.length();l>=f?(a.fragment=e.output.getBytes(l-f),h=e.output.getBytes(f)):a.fragment=e.output.getBytes(),a.fragment=j.util.createBuffer(a.fragment),a.length=a.fragment.length();var m=b.macFunction(b.macKey,b.sequenceNumber,a);return b.updateSequenceNumber(),d=i(b.macKey,h,m)&&d}function i(a,b,c){var d=j.hmac.create();return d.start("SHA1",a),d.update(b),b=d.digest().getBytes(),d.start(null,null),d.update(c),c=d.digest().getBytes(),b===c}var j=a("./forge");a("./aes"),a("./tls");var k=b.exports=j.tls;k.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=k.BulkCipherAlgorithm.aes,a.cipher_type=k.CipherType.block,a.enc_key_length=16,a.block_length=16,a.fixed_iv_length=16,a.record_iv_length=16,a.mac_algorithm=k.MACAlgorithm.hmac_sha1,a.mac_length=20,a.mac_key_length=20},initConnectionState:d},k.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=k.BulkCipherAlgorithm.aes,a.cipher_type=k.CipherType.block,a.enc_key_length=32,a.block_length=16,a.fixed_iv_length=16,a.record_iv_length=16,a.mac_algorithm=k.MACAlgorithm.hmac_sha1,a.mac_length=20,a.mac_key_length=20},initConnectionState:d}},{"./aes":37,"./forge":47,"./tls":78}],39:[function(a,b,c){var d=a("./forge");a("./asn1");var e=d.asn1;c.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]
},c.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}},{"./asn1":40,"./forge":47}],40:[function(a,b,c){function d(a,b,c){if(c>b){var d=new Error("Too few bytes to parse DER.");throw d.available=a.length(),d.remaining=b,d.requested=c,d}}function e(a,b,c,f){var i;d(a,b,2);var j=a.getByte();b--;var k=192&j,l=31&j;i=a.length();var m=h(a,b);if(b-=i-a.length(),void 0!==m&&m>b){if(f.strict){var n=new Error("Too few bytes to read ASN.1 value.");throw n.available=a.length(),n.remaining=b,n.requested=m,n}m=b}var o,p,q=32===(32&j);if(q)if(o=[],void 0===m)for(;;){if(d(a,b,2),a.bytes(2)===String.fromCharCode(0,0)){a.getBytes(2),b-=2;break}i=a.length(),o.push(e(a,b,c+1,f)),b-=i-a.length()}else for(;m>0;)i=a.length(),o.push(e(a,m,c+1,f)),b-=i-a.length(),m-=i-a.length();if(void 0===o&&k===g.Class.UNIVERSAL&&l===g.Type.BITSTRING&&(p=a.bytes(m)),void 0===o&&f.decodeBitStrings&&k===g.Class.UNIVERSAL&&l===g.Type.BITSTRING&&m>1){var r=a.read,s=b,t=0;if(l===g.Type.BITSTRING&&(d(a,b,1),t=a.getByte(),b--),0===t)try{i=a.length();var u={verbose:f.verbose,strict:!0,decodeBitStrings:!0},v=e(a,b,c+1,u),w=i-a.length();b-=w,l==g.Type.BITSTRING&&w++;var x=v.tagClass;w!==m||x!==g.Class.UNIVERSAL&&x!==g.Class.CONTEXT_SPECIFIC||(o=[v])}catch(y){}void 0===o&&(a.read=r,b=s)}if(void 0===o){if(void 0===m){if(f.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");m=b}if(l===g.Type.BMPSTRING)for(o="";m>0;m-=2)d(a,b,2),o+=String.fromCharCode(a.getInt16()),b-=2;else o=a.getBytes(m)}var z=void 0===p?null:{bitStringContents:p};return g.create(k,l,q,o,z)}var f=a("./forge");a("./util"),a("./oids");var g=b.exports=f.asn1=f.asn1||{};g.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},g.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},g.create=function(a,b,c,d,e){if(f.util.isArray(d)){for(var h=[],i=0;i<d.length;++i)void 0!==d[i]&&h.push(d[i]);d=h}var j={tagClass:a,type:b,constructed:c,composed:c||f.util.isArray(d),value:d};return e&&"bitStringContents"in e&&(j.bitStringContents=e.bitStringContents,j.original=g.copy(j)),j},g.copy=function(a,b){var c;if(f.util.isArray(a)){c=[];for(var d=0;d<a.length;++d)c.push(g.copy(a[d],b));return c}return"string"==typeof a?a:(c={tagClass:a.tagClass,type:a.type,constructed:a.constructed,composed:a.composed,value:g.copy(a.value,b)},b&&!b.excludeBitStringContents&&(c.bitStringContents=a.bitStringContents),c)},g.equals=function(a,b,c){if(f.util.isArray(a)){if(!f.util.isArray(b))return!1;if(a.length!==b.length)return!1;for(var d=0;d<a.length;++d)if(!g.equals(a[d],b[d]))return!1;return!0}if(typeof a!=typeof b)return!1;if("string"==typeof a)return a===b;var e=a.tagClass===b.tagClass&&a.type===b.type&&a.constructed===b.constructed&&a.composed===b.composed&&g.equals(a.value,b.value);return c&&c.includeBitStringContents&&(e=e&&a.bitStringContents===b.bitStringContents),e},g.getBerValueLength=function(a){var b=a.getByte();if(128!==b){var c,d=128&b;return c=d?a.getInt((127&b)<<3):b}};var h=function(a,b){var c=a.getByte();if(b--,128!==c){var e,f=128&c;if(f){var g=127&c;d(a,b,g),e=a.getInt(g<<3)}else e=c;if(e<0)throw new Error("Negative length: "+e);return e}};g.fromDer=function(a,b){return void 0===b&&(b={strict:!0,decodeBitStrings:!0}),"boolean"==typeof b&&(b={strict:b,decodeBitStrings:!0}),"strict"in b||(b.strict=!0),"decodeBitStrings"in b||(b.decodeBitStrings=!0),"string"==typeof a&&(a=f.util.createBuffer(a)),e(a,a.length(),0,b)},g.toDer=function(a){var b=f.util.createBuffer(),c=a.tagClass|a.type,d=f.util.createBuffer(),e=!1;if("bitStringContents"in a&&(e=!0,a.original&&(e=g.equals(a,a.original))),e)d.putBytes(a.bitStringContents);else if(a.composed){a.constructed?c|=32:d.putByte(0);for(var h=0;h<a.value.length;++h)void 0!==a.value[h]&&d.putBuffer(g.toDer(a.value[h]))}else if(a.type===g.Type.BMPSTRING)for(var h=0;h<a.value.length;++h)d.putInt16(a.value.charCodeAt(h));else a.type===g.Type.INTEGER&&a.value.length>1&&(0===a.value.charCodeAt(0)&&0===(128&a.value.charCodeAt(1))||255===a.value.charCodeAt(0)&&128===(128&a.value.charCodeAt(1)))?d.putBytes(a.value.substr(1)):d.putBytes(a.value);if(b.putByte(c),d.length()<=127)b.putByte(127&d.length());else{var i=d.length(),j="";do j+=String.fromCharCode(255&i),i>>>=8;while(i>0);b.putByte(128|j.length);for(var h=j.length-1;h>=0;--h)b.putByte(j.charCodeAt(h))}return b.putBuffer(d),b},g.oidToDer=function(a){var b=a.split("."),c=f.util.createBuffer();c.putByte(40*parseInt(b[0],10)+parseInt(b[1],10));for(var d,e,g,h,i=2;i<b.length;++i){d=!0,e=[],g=parseInt(b[i],10);do h=127&g,g>>>=7,d||(h|=128),e.push(h),d=!1;while(g>0);for(var j=e.length-1;j>=0;--j)c.putByte(e[j])}return c},g.derToOid=function(a){var b;"string"==typeof a&&(a=f.util.createBuffer(a));var c=a.getByte();b=Math.floor(c/40)+"."+c%40;for(var d=0;a.length()>0;)c=a.getByte(),d<<=7,128&c?d+=127&c:(b+="."+(d+c),d=0);return b},g.utcTimeToDate=function(a){var b=new Date,c=parseInt(a.substr(0,2),10);c=c>=50?1900+c:2e3+c;var d=parseInt(a.substr(2,2),10)-1,e=parseInt(a.substr(4,2),10),f=parseInt(a.substr(6,2),10),g=parseInt(a.substr(8,2),10),h=0;if(a.length>11){var i=a.charAt(10),j=10;"+"!==i&&"-"!==i&&(h=parseInt(a.substr(10,2),10),j+=2)}if(b.setUTCFullYear(c,d,e),b.setUTCHours(f,g,h,0),j&&(i=a.charAt(j),"+"===i||"-"===i)){var k=parseInt(a.substr(j+1,2),10),l=parseInt(a.substr(j+4,2),10),m=60*k+l;m*=6e4,"+"===i?b.setTime(+b-m):b.setTime(+b+m)}return b},g.generalizedTimeToDate=function(a){var b=new Date,c=parseInt(a.substr(0,4),10),d=parseInt(a.substr(4,2),10)-1,e=parseInt(a.substr(6,2),10),f=parseInt(a.substr(8,2),10),g=parseInt(a.substr(10,2),10),h=parseInt(a.substr(12,2),10),i=0,j=0,k=!1;"Z"===a.charAt(a.length-1)&&(k=!0);var l=a.length-5,m=a.charAt(l);if("+"===m||"-"===m){var n=parseInt(a.substr(l+1,2),10),o=parseInt(a.substr(l+4,2),10);j=60*n+o,j*=6e4,"+"===m&&(j*=-1),k=!0}return"."===a.charAt(14)&&(i=1e3*parseFloat(a.substr(14),10)),k?(b.setUTCFullYear(c,d,e),b.setUTCHours(f,g,h,i),b.setTime(+b+j)):(b.setFullYear(c,d,e),b.setHours(f,g,h,i)),b},g.dateToUtcTime=function(a){if("string"==typeof a)return a;var b="",c=[];c.push((""+a.getUTCFullYear()).substr(2)),c.push(""+(a.getUTCMonth()+1)),c.push(""+a.getUTCDate()),c.push(""+a.getUTCHours()),c.push(""+a.getUTCMinutes()),c.push(""+a.getUTCSeconds());for(var d=0;d<c.length;++d)c[d].length<2&&(b+="0"),b+=c[d];return b+="Z"},g.dateToGeneralizedTime=function(a){if("string"==typeof a)return a;var b="",c=[];c.push(""+a.getUTCFullYear()),c.push(""+(a.getUTCMonth()+1)),c.push(""+a.getUTCDate()),c.push(""+a.getUTCHours()),c.push(""+a.getUTCMinutes()),c.push(""+a.getUTCSeconds());for(var d=0;d<c.length;++d)c[d].length<2&&(b+="0"),b+=c[d];return b+="Z"},g.integerToDer=function(a){var b=f.util.createBuffer();if(a>=-128&&a<128)return b.putSignedInt(a,8);if(a>=-32768&&a<32768)return b.putSignedInt(a,16);if(a>=-8388608&&a<8388608)return b.putSignedInt(a,24);if(a>=-2147483648&&a<2147483648)return b.putSignedInt(a,32);var c=new Error("Integer too large; max is 32-bits.");throw c.integer=a,c},g.derToInteger=function(a){"string"==typeof a&&(a=f.util.createBuffer(a));var b=8*a.length();if(b>32)throw new Error("Integer too large; max is 32-bits.");return a.getSignedInt(b)},g.validate=function(a,b,c,d){var e=!1;if(a.tagClass!==b.tagClass&&"undefined"!=typeof b.tagClass||a.type!==b.type&&"undefined"!=typeof b.type)d&&(a.tagClass!==b.tagClass&&d.push("["+b.name+'] Expected tag class "'+b.tagClass+'", got "'+a.tagClass+'"'),a.type!==b.type&&d.push("["+b.name+'] Expected type "'+b.type+'", got "'+a.type+'"'));else if(a.constructed===b.constructed||"undefined"==typeof b.constructed){if(e=!0,b.value&&f.util.isArray(b.value))for(var h=0,i=0;e&&i<b.value.length;++i)e=b.value[i].optional||!1,a.value[h]&&(e=g.validate(a.value[h],b.value[i],c,d),e?++h:b.value[i].optional&&(e=!0)),!e&&d&&d.push("["+b.name+'] Tag class "'+b.tagClass+'", type "'+b.type+'" expected value length "'+b.value.length+'", got "'+a.value.length+'"');if(e&&c&&(b.capture&&(c[b.capture]=a.value),b.captureAsn1&&(c[b.captureAsn1]=a),b.captureBitStringContents&&"bitStringContents"in a&&(c[b.captureBitStringContents]=a.bitStringContents),b.captureBitStringValue&&"bitStringContents"in a)){if(a.bitStringContents.length<2)c[b.captureBitStringValue]="";else{var j=a.bitStringContents.charCodeAt(0);if(0!==j)throw new Error("captureBitStringValue only supported for zero unused bits");c[b.captureBitStringValue]=a.bitStringContents.slice(1)}}}else d&&d.push("["+b.name+'] Expected constructed "'+b.constructed+'", got "'+a.constructed+'"');return e};var i=/[^\\u0000-\\u00ff]/;g.prettyPrint=function(a,b,c){var d="";b=b||0,c=c||2,b>0&&(d+="\n");for(var e="",h=0;h<b*c;++h)e+=" ";switch(d+=e+"Tag: ",a.tagClass){case g.Class.UNIVERSAL:d+="Universal:";break;case g.Class.APPLICATION:d+="Application:";break;case g.Class.CONTEXT_SPECIFIC:d+="Context-Specific:";break;case g.Class.PRIVATE:d+="Private:"}if(a.tagClass===g.Class.UNIVERSAL)switch(d+=a.type,a.type){case g.Type.NONE:d+=" (None)";break;case g.Type.BOOLEAN:d+=" (Boolean)";break;case g.Type.INTEGER:d+=" (Integer)";break;case g.Type.BITSTRING:d+=" (Bit string)";break;case g.Type.OCTETSTRING:d+=" (Octet string)";break;case g.Type.NULL:d+=" (Null)";break;case g.Type.OID:d+=" (Object Identifier)";break;case g.Type.ODESC:d+=" (Object Descriptor)";break;case g.Type.EXTERNAL:d+=" (External or Instance of)";break;case g.Type.REAL:d+=" (Real)";break;case g.Type.ENUMERATED:d+=" (Enumerated)";break;case g.Type.EMBEDDED:d+=" (Embedded PDV)";break;case g.Type.UTF8:d+=" (UTF8)";break;case g.Type.ROID:d+=" (Relative Object Identifier)";break;case g.Type.SEQUENCE:d+=" (Sequence)";break;case g.Type.SET:d+=" (Set)";break;case g.Type.PRINTABLESTRING:d+=" (Printable String)";break;case g.Type.IA5String:d+=" (IA5String (ASCII))";break;case g.Type.UTCTIME:d+=" (UTC time)";break;case g.Type.GENERALIZEDTIME:d+=" (Generalized time)";break;case g.Type.BMPSTRING:d+=" (BMP String)"}else d+=a.type;if(d+="\n",d+=e+"Constructed: "+a.constructed+"\n",a.composed){for(var j=0,k="",h=0;h<a.value.length;++h)void 0!==a.value[h]&&(j+=1,k+=g.prettyPrint(a.value[h],b+1,c),h+1<a.value.length&&(k+=","));d+=e+"Sub values: "+j+k}else{if(d+=e+"Value: ",a.type===g.Type.OID){var l=g.derToOid(a.value);d+=l,f.pki&&f.pki.oids&&l in f.pki.oids&&(d+=" ("+f.pki.oids[l]+") ")}if(a.type===g.Type.INTEGER)try{d+=g.derToInteger(a.value)}catch(m){d+="0x"+f.util.bytesToHex(a.value)}else if(a.type===g.Type.BITSTRING){if(d+=a.value.length>1?"0x"+f.util.bytesToHex(a.value.slice(1)):"(none)",a.value.length>0){var n=a.value.charCodeAt(0);1==n?d+=" (1 unused bit shown)":n>1&&(d+=" ("+n+" unused bits shown)")}}else a.type===g.Type.OCTETSTRING?(i.test(a.value)||(d+="("+a.value+") "),d+="0x"+f.util.bytesToHex(a.value)):d+=a.type===g.Type.UTF8?f.util.decodeUtf8(a.value):a.type===g.Type.PRINTABLESTRING||a.type===g.Type.IA5String?a.value:i.test(a.value)?"0x"+f.util.bytesToHex(a.value):0===a.value.length?"[null]":a.value}return d}},{"./forge":47,"./oids":58,"./util":79}],41:[function(a,b,c){(function(a){function c(a,b){var c=0,d=b.length,e=b.charAt(0),f=[0];for(c=0;c<a.length();++c){for(var g=0,h=a.at(c);g<f.length;++g)h+=f[g]<<8,f[g]=h%d,h=h/d|0;for(;h>0;)f.push(h%d),h=h/d|0}var i="";for(c=0;0===a.at(c)&&c<a.length()-1;++c)i+=e;for(c=f.length-1;c>=0;--c)i+=b[f[c]];return i}var d={};b.exports=d;var e={};d.encode=function(a,b,d){if("string"!=typeof b)throw new TypeError('"alphabet" must be a string.');if(void 0!==d&&"number"!=typeof d)throw new TypeError('"maxline" must be a number.');var e="";if(a instanceof Uint8Array){var f=0,g=b.length,h=b.charAt(0),i=[0];for(f=0;f<a.length;++f){for(var j=0,k=a[f];j<i.length;++j)k+=i[j]<<8,i[j]=k%g,k=k/g|0;for(;k>0;)i.push(k%g),k=k/g|0}for(f=0;0===a[f]&&f<a.length-1;++f)e+=h;for(f=i.length-1;f>=0;--f)e+=b[i[f]]}else e=c(a,b);if(d){var l=new RegExp(".{1,"+d+"}","g");e=e.match(l).join("\r\n")}return e},d.decode=function(b,c){if("string"!=typeof b)throw new TypeError('"input" must be a string.');if("string"!=typeof c)throw new TypeError('"alphabet" must be a string.');var d=e[c];if(!d){d=e[c]=[];for(var f=0;f<c.length;++f)d[c.charCodeAt(f)]=f}b=b.replace(/\s/g,"");for(var g=c.length,h=c.charAt(0),i=[0],f=0;f<b.length;f++){var j=d[b.charCodeAt(f)];if(void 0===j)return;for(var k=0,l=j;k<i.length;++k)l+=i[k]*g,i[k]=255&l,l>>=8;for(;l>0;)i.push(255&l),l>>=8}for(var m=0;b[m]===h&&m<b.length-1;++m)i.push(0);return"undefined"!=typeof a?a.from(i.reverse()):new Uint8Array(i.reverse())}}).call(this,a("buffer").Buffer)},{buffer:18}],42:[function(a,b,c){var d=a("./forge");a("./util"),b.exports=d.cipher=d.cipher||{},d.cipher.algorithms=d.cipher.algorithms||{},d.cipher.createCipher=function(a,b){var c=a;if("string"==typeof c&&(c=d.cipher.getAlgorithm(c),c&&(c=c())),!c)throw new Error("Unsupported algorithm: "+a);return new d.cipher.BlockCipher({algorithm:c,key:b,decrypt:!1})},d.cipher.createDecipher=function(a,b){var c=a;if("string"==typeof c&&(c=d.cipher.getAlgorithm(c),c&&(c=c())),!c)throw new Error("Unsupported algorithm: "+a);return new d.cipher.BlockCipher({algorithm:c,key:b,decrypt:!0})},d.cipher.registerAlgorithm=function(a,b){a=a.toUpperCase(),d.cipher.algorithms[a]=b},d.cipher.getAlgorithm=function(a){return a=a.toUpperCase(),a in d.cipher.algorithms?d.cipher.algorithms[a]:null};var e=d.cipher.BlockCipher=function(a){this.algorithm=a.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=a.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=a.decrypt,this.algorithm.initialize(a)};e.prototype.start=function(a){a=a||{};var b={};for(var c in a)b[c]=a[c];b.decrypt=this._decrypt,this._finish=!1,this._input=d.util.createBuffer(),this.output=a.output||d.util.createBuffer(),this.mode.start(b)},e.prototype.update=function(a){for(a&&this._input.putBuffer(a);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(a){!a||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(b){return a(this.blockSize,b,!1)},this.mode.unpad=function(b){return a(this.blockSize,b,!0)});var b={};return b.decrypt=this._decrypt,b.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,b))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,b))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,b)))}},{"./forge":47,"./util":79}],43:[function(a,b,c){function d(a,b){if("string"==typeof a&&(a=g.util.createBuffer(a)),g.util.isArray(a)&&a.length>4){var c=a;a=g.util.createBuffer();for(var d=0;d<c.length;++d)a.putByte(c[d])}if(a.length()<b)throw new Error("Invalid IV length; got "+a.length()+" bytes and expected "+b+" bytes.");if(!g.util.isArray(a)){for(var e=[],f=b/4,d=0;d<f;++d)e.push(a.getInt32());a=e}return a}function e(a){a[a.length-1]=a[a.length-1]+1&4294967295}function f(a){return[a/4294967296|0,4294967295&a]}var g=a("./forge");a("./util"),g.cipher=g.cipher||{};var h=b.exports=g.cipher.modes=g.cipher.modes||{};h.ecb=function(a){a=a||{},this.name="ECB",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},h.ecb.prototype.start=function(a){},h.ecb.prototype.encrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._outBlock[d])},h.ecb.prototype.decrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._outBlock[d])},h.ecb.prototype.pad=function(a,b){var c=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(c,c),!0},h.ecb.prototype.unpad=function(a,b){if(b.overflow>0)return!1;var c=a.length(),d=a.at(c-1);return!(d>this.blockSize<<2)&&(a.truncate(d),!0)},h.cbc=function(a){a=a||{},this.name="CBC",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},h.cbc.prototype.start=function(a){if(null===a.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=d(a.iv,this.blockSize),this._prev=this._iv.slice(0)}},h.cbc.prototype.encrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=this._prev[d]^a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._outBlock[d]);this._prev=this._outBlock},h.cbc.prototype.decrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._prev[d]^this._outBlock[d]);this._prev=this._inBlock.slice(0)},h.cbc.prototype.pad=function(a,b){var c=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(c,c),!0},h.cbc.prototype.unpad=function(a,b){if(b.overflow>0)return!1;var c=a.length(),d=a.at(c-1);return!(d>this.blockSize<<2)&&(a.truncate(d),!0)},h.cfb=function(a){a=a||{},this.name="CFB",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=g.util.createBuffer(),this._partialBytes=0},h.cfb.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=d(a.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},h.cfb.prototype.encrypt=function(a,b,c){var d=a.length();if(0===d)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize)for(var e=0;e<this._ints;++e)this._inBlock[e]=a.getInt32()^this._outBlock[e],b.putInt32(this._inBlock[e]);else{var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialBlock[e]=a.getInt32()^this._outBlock[e],this._partialOutput.putInt32(this._partialBlock[e]);if(f>0)a.read-=this.blockSize;else for(var e=0;e<this._ints;++e)this._inBlock[e]=this._partialBlock[e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}},h.cfb.prototype.decrypt=function(a,b,c){var d=a.length();if(0===d)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize)for(var e=0;e<this._ints;++e)this._inBlock[e]=a.getInt32(),b.putInt32(this._inBlock[e]^this._outBlock[e]);else{var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialBlock[e]=a.getInt32(),this._partialOutput.putInt32(this._partialBlock[e]^this._outBlock[e]);if(f>0)a.read-=this.blockSize;else for(var e=0;e<this._ints;++e)this._inBlock[e]=this._partialBlock[e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}},h.ofb=function(a){a=a||{},this.name="OFB",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=g.util.createBuffer(),this._partialBytes=0},h.ofb.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=d(a.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},h.ofb.prototype.encrypt=function(a,b,c){var d=a.length();if(0===a.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize)for(var e=0;e<this._ints;++e)b.putInt32(a.getInt32()^this._outBlock[e]),this._inBlock[e]=this._outBlock[e];else{var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialOutput.putInt32(a.getInt32()^this._outBlock[e]);if(f>0)a.read-=this.blockSize;else for(var e=0;e<this._ints;++e)this._inBlock[e]=this._outBlock[e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}},h.ofb.prototype.decrypt=h.ofb.prototype.encrypt,h.ctr=function(a){a=a||{},this.name="CTR",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=g.util.createBuffer(),this._partialBytes=0},h.ctr.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=d(a.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},h.ctr.prototype.encrypt=function(a,b,c){var d=a.length();if(0===d)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize)for(var f=0;f<this._ints;++f)b.putInt32(a.getInt32()^this._outBlock[f]);else{var g=(this.blockSize-d)%this.blockSize;g>0&&(g=this.blockSize-g),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(a.getInt32()^this._outBlock[f]);if(g>0&&(a.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),g>0&&!c)return b.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=g,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}e(this._inBlock)},h.ctr.prototype.decrypt=h.ctr.prototype.encrypt,h.gcm=function(a){a=a||{},this.name="GCM",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=g.util.createBuffer(),this._partialBytes=0,this._R=3774873600},h.gcm.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");var b=g.util.createBuffer(a.iv);this._cipherLength=0;var c;if(c="additionalData"in a?g.util.createBuffer(a.additionalData):g.util.createBuffer(),"tagLength"in a?this._tagLength=a.tagLength:this._tagLength=128,this._tag=null,a.decrypt&&(this._tag=g.util.createBuffer(a.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var d=b.length();if(12===d)this._j0=[b.getInt32(),b.getInt32(),b.getInt32(),1];else{for(this._j0=[0,0,0,0];b.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[b.getInt32(),b.getInt32(),b.getInt32(),b.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(f(8*d)))}this._inBlock=this._j0.slice(0),e(this._inBlock),this._partialBytes=0,c=g.util.createBuffer(c),this._aDataLength=f(8*c.length());var h=c.length()%this.blockSize;for(h&&c.fillWithByte(0,this.blockSize-h),this._s=[0,0,0,0];c.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[c.getInt32(),c.getInt32(),c.getInt32(),c.getInt32()])},h.gcm.prototype.encrypt=function(a,b,c){var d=a.length();if(0===d)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize){for(var f=0;f<this._ints;++f)b.putInt32(this._outBlock[f]^=a.getInt32());this._cipherLength+=this.blockSize}else{var g=(this.blockSize-d)%this.blockSize;g>0&&(g=this.blockSize-g),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(a.getInt32()^this._outBlock[f]);if(g<=0||c){if(c){var h=d%this.blockSize;this._cipherLength+=h,this._partialOutput.truncate(this.blockSize-h)}else this._cipherLength+=this.blockSize;for(var f=0;f<this._ints;++f)this._outBlock[f]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),g>0&&!c)return a.read-=this.blockSize,b.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=g,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),e(this._inBlock)},h.gcm.prototype.decrypt=function(a,b,c){var d=a.length();if(d<this.blockSize&&!(c&&d>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),e(this._inBlock),this._hashBlock[0]=a.getInt32(),this._hashBlock[1]=a.getInt32(),this._hashBlock[2]=a.getInt32(),this._hashBlock[3]=a.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var f=0;f<this._ints;++f)b.putInt32(this._outBlock[f]^this._hashBlock[f]);d<this.blockSize?this._cipherLength+=d%this.blockSize:this._cipherLength+=this.blockSize},h.gcm.prototype.afterFinish=function(a,b){var c=!0;b.decrypt&&b.overflow&&a.truncate(this.blockSize-b.overflow),this.tag=g.util.createBuffer();var d=this._aDataLength.concat(f(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,d);var e=[];this.cipher.encrypt(this._j0,e);for(var h=0;h<this._ints;++h)this.tag.putInt32(this._s[h]^e[h]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),b.decrypt&&this.tag.bytes()!==this._tag&&(c=!1),c},h.gcm.prototype.multiply=function(a,b){for(var c=[0,0,0,0],d=b.slice(0),e=0;e<128;++e){var f=a[e/32|0]&1<<31-e%32;f&&(c[0]^=d[0],c[1]^=d[1],c[2]^=d[2],c[3]^=d[3]),this.pow(d,d)}return c},h.gcm.prototype.pow=function(a,b){for(var c=1&a[3],d=3;d>0;--d)b[d]=a[d]>>>1|(1&a[d-1])<<31;b[0]=a[0]>>>1,c&&(b[0]^=this._R)},h.gcm.prototype.tableMultiply=function(a){for(var b=[0,0,0,0],c=0;c<32;++c){var d=c/8|0,e=a[d]>>>4*(7-c%8)&15,f=this._m[c][e];b[0]^=f[0],b[1]^=f[1],b[2]^=f[2],b[3]^=f[3]}return b},h.gcm.prototype.ghash=function(a,b,c){return b[0]^=c[0],b[1]^=c[1],b[2]^=c[2],b[3]^=c[3],this.tableMultiply(b)},h.gcm.prototype.generateHashTable=function(a,b){for(var c=8/b,d=4*c,e=16*c,f=new Array(e),g=0;g<e;++g){var h=[0,0,0,0],i=g/d|0,j=(d-1-g%d)*b;h[i]=1<<b-1<<j,f[g]=this.generateSubHashTable(this.multiply(h,a),b)}return f},h.gcm.prototype.generateSubHashTable=function(a,b){var c=1<<b,d=c>>>1,e=new Array(c);e[d]=a.slice(0);for(var f=d>>>1;f>0;)this.pow(e[2*f],e[f]=[]),f>>=1;for(f=2;f<d;){for(var g=1;g<f;++g){var h=e[f],i=e[g];e[f+g]=[h[0]^i[0],h[1]^i[1],h[2]^i[2],h[3]^i[3]]}f*=2}for(e[0]=[0,0,0,0],f=d+1;f<c;++f){var j=e[f^d];e[f]=[a[0]^j[0],a[1]^j[1],a[2]^j[2],a[3]^j[3]]}return e}},{"./forge":47,"./util":79}],44:[function(a,b,c){var d=a("./forge");b.exports=d.debug=d.debug||{},d.debug.storage={},d.debug.get=function(a,b){var c;return"undefined"==typeof a?c=d.debug.storage:a in d.debug.storage&&(c="undefined"==typeof b?d.debug.storage[a]:d.debug.storage[a][b]),c},d.debug.set=function(a,b,c){a in d.debug.storage||(d.debug.storage[a]={}),d.debug.storage[a][b]=c},d.debug.clear=function(a,b){"undefined"==typeof a?d.debug.storage={}:a in d.debug.storage&&("undefined"==typeof b?delete d.debug.storage[a]:delete d.debug.storage[a][b])}},{"./forge":47}],45:[function(a,b,c){function d(a,b){var c=function(){return new h.des.Algorithm(a,b)};h.cipher.registerAlgorithm(a,c)}function e(a){for(var b,c=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],d=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],e=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],f=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],g=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],h=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],i=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],j=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],k=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],m=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],n=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],o=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],q=a.length()>8?3:1,r=[],s=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],t=0,u=0;u<q;u++){var v=a.getInt32(),w=a.getInt32();b=252645135&(v>>>4^w),w^=b,v^=b<<4,b=65535&(w>>>-16^v),v^=b,w^=b<<-16,b=858993459&(v>>>2^w),w^=b,v^=b<<2,b=65535&(w>>>-16^v),v^=b,w^=b<<-16,b=1431655765&(v>>>1^w),w^=b,v^=b<<1,b=16711935&(w>>>8^v),v^=b,w^=b<<8,b=1431655765&(v>>>1^w),w^=b,v^=b<<1,b=v<<8|w>>>20&240,v=w<<24|w<<8&16711680|w>>>8&65280|w>>>24&240,w=b;for(var x=0;x<s.length;++x){s[x]?(v=v<<2|v>>>26,w=w<<2|w>>>26):(v=v<<1|v>>>27,w=w<<1|w>>>27),v&=-15,w&=-15;var y=c[v>>>28]|d[v>>>24&15]|e[v>>>20&15]|f[v>>>16&15]|g[v>>>12&15]|h[v>>>8&15]|i[v>>>4&15],z=j[w>>>28]|k[w>>>24&15]|l[w>>>20&15]|m[w>>>16&15]|n[w>>>12&15]|o[w>>>8&15]|p[w>>>4&15];b=65535&(z>>>16^y),r[t++]=y^b,r[t++]=z^b<<16}}return r}function f(a,b,c,d){var e,f=32===a.length?3:9;e=3===f?d?[30,-2,-2]:[0,32,2]:d?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var g,h=b[0],q=b[1];g=252645135&(h>>>4^q),q^=g,h^=g<<4,g=65535&(h>>>16^q),q^=g,h^=g<<16,g=858993459&(q>>>2^h),h^=g,q^=g<<2,g=16711935&(q>>>8^h),h^=g,q^=g<<8,g=1431655765&(h>>>1^q),q^=g,h^=g<<1,h=h<<1|h>>>31,q=q<<1|q>>>31;for(var r=0;r<f;r+=3){for(var s=e[r+1],t=e[r+2],u=e[r];u!=s;u+=t){var v=q^a[u],w=(q>>>4|q<<28)^a[u+1];g=h,h=q,q=g^(j[v>>>24&63]|l[v>>>16&63]|n[v>>>8&63]|p[63&v]|i[w>>>24&63]|k[w>>>16&63]|m[w>>>8&63]|o[63&w])}g=h,h=q,q=g}h=h>>>1|h<<31,q=q>>>1|q<<31,g=1431655765&(h>>>1^q),q^=g,h^=g<<1,g=16711935&(q>>>8^h),h^=g,q^=g<<8,g=858993459&(q>>>2^h),h^=g,q^=g<<2,g=65535&(h>>>16^q),q^=g,h^=g<<16,g=252645135&(h>>>4^q),q^=g,h^=g<<4,c[0]=h,c[1]=q}function g(a){a=a||{};var b,c=(a.mode||"CBC").toUpperCase(),d="DES-"+c;b=a.decrypt?h.cipher.createDecipher(d,a.key):h.cipher.createCipher(d,a.key);var e=b.start;return b.start=function(a,c){var d=null;c instanceof h.util.ByteBuffer&&(d=c,c={}),c=c||{},c.output=d,c.iv=a,e.call(b,c)},b}var h=a("./forge");a("./cipher"),a("./cipherModes"),a("./util"),b.exports=h.des=h.des||{},h.des.startEncrypting=function(a,b,c,d){var e=g({key:a,output:c,decrypt:!1,mode:d||(null===b?"ECB":"CBC")});return e.start(b),
e},h.des.createEncryptionCipher=function(a,b){return g({key:a,output:null,decrypt:!1,mode:b})},h.des.startDecrypting=function(a,b,c,d){var e=g({key:a,output:c,decrypt:!0,mode:d||(null===b?"ECB":"CBC")});return e.start(b),e},h.des.createDecryptionCipher=function(a,b){return g({key:a,output:null,decrypt:!0,mode:b})},h.des.Algorithm=function(a,b){var c=this;c.name=a,c.mode=new b({blockSize:8,cipher:{encrypt:function(a,b){return f(c._keys,a,b,!1)},decrypt:function(a,b){return f(c._keys,a,b,!0)}}}),c._init=!1},h.des.Algorithm.prototype.initialize=function(a){if(!this._init){var b=h.util.createBuffer(a.key);if(0===this.name.indexOf("3DES")&&24!==b.length())throw new Error("Invalid Triple-DES key size: "+8*b.length());this._keys=e(b),this._init=!0}},d("DES-ECB",h.cipher.modes.ecb),d("DES-CBC",h.cipher.modes.cbc),d("DES-CFB",h.cipher.modes.cfb),d("DES-OFB",h.cipher.modes.ofb),d("DES-CTR",h.cipher.modes.ctr),d("3DES-ECB",h.cipher.modes.ecb),d("3DES-CBC",h.cipher.modes.cbc),d("3DES-CFB",h.cipher.modes.cfb),d("3DES-OFB",h.cipher.modes.ofb),d("3DES-CTR",h.cipher.modes.ctr);var i=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],j=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],k=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],l=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],m=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],n=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],o=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],p=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696]},{"./cipher":42,"./cipherModes":43,"./forge":47,"./util":79}],46:[function(a,b,c){(function(c){function d(a){var b=a.message;if(b instanceof Uint8Array||b instanceof M)return b;var d=a.encoding;if(void 0===b){if(!a.md)throw new TypeError('"options.message" or "options.md" not specified.');b=a.md.digest().getBytes(),d="binary"}if("string"==typeof b&&!d)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if("string"==typeof b){if("undefined"!=typeof c)return c.from(b,d);b=new L(b,d)}else if(!(b instanceof L))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var e=new M(b.length()),f=0;f<e.length;++f)e[f]=b.at(f);return e}function e(a,b){var d=G.md.sha512.create(),e=new L(a);d.update(e.getBytes(b),"binary");var f=d.digest().getBytes();if("undefined"!=typeof c)return c.from(f,"binary");for(var g=new M(N.constants.HASH_BYTE_LENGTH),h=0;h<64;++h)g[h]=f.charCodeAt(h);return g}function f(a,b){var c,d=[B(),B(),B(),B()],f=e(b,32);for(f[0]&=248,f[31]&=127,f[31]|=64,w(d,f),m(a,d),c=0;c<32;++c)b[c+32]=a[c];return 0}function g(a,b,c,d){var f,g,h=new Float64Array(64),k=[B(),B(),B(),B()],l=e(d,32);l[0]&=248,l[31]&=127,l[31]|=64;var n=c+64;for(f=0;f<c;++f)a[64+f]=b[f];for(f=0;f<32;++f)a[32+f]=l[32+f];var o=e(a.subarray(32),c+32);for(j(o),w(k,o),m(a,k),f=32;f<64;++f)a[f]=d[f];var p=e(a,c+64);for(j(p),f=32;f<64;++f)h[f]=0;for(f=0;f<32;++f)h[f]=o[f];for(f=0;f<32;++f)for(g=0;g<32;g++)h[f+g]+=p[f]*l[g];return i(a.subarray(32),h),n}function h(a,b,c,d){var f,g,h=new M(32),i=[B(),B(),B(),B()],l=[B(),B(),B(),B()];if(g=-1,c<64)return-1;if(o(l,d))return-1;for(f=0;f<c;++f)a[f]=b[f];for(f=0;f<32;++f)a[f+32]=d[f];var n=e(a,c);if(j(n),v(i,l,n),w(l,b.subarray(32)),k(i,l),m(h,i),c-=64,s(b,0,h,0)){for(f=0;f<c;++f)a[f]=0;return-1}for(f=0;f<c;++f)a[f]=b[f+64];return g=c}function i(a,b){var c,d,e,f;for(d=63;d>=32;--d){for(c=0,e=d-32,f=d-12;e<f;++e)b[e]+=c-16*b[d]*U[e-(d-32)],c=b[e]+128>>8,b[e]-=256*c;b[e]+=c,b[d]=0}for(c=0,e=0;e<32;++e)b[e]+=c-(b[31]>>4)*U[e],c=b[e]>>8,b[e]&=255;for(e=0;e<32;++e)b[e]-=c*U[e];for(d=0;d<32;++d)b[d+1]+=b[d]>>8,a[d]=255&b[d]}function j(a){for(var b=new Float64Array(64),c=0;c<64;++c)b[c]=a[c],a[c]=0;i(a,b)}function k(a,b){var c=B(),d=B(),e=B(),f=B(),g=B(),h=B(),i=B(),j=B(),k=B();D(c,a[1],a[0]),D(k,b[1],b[0]),F(c,c,k),C(d,a[0],a[1]),C(k,b[0],b[1]),F(d,d,k),F(e,a[3],b[3]),F(e,e,R),F(f,a[2],b[2]),C(f,f,f),D(g,d,c),D(h,f,e),C(i,f,e),C(j,d,c),F(a[0],g,h),F(a[1],j,i),F(a[2],i,h),F(a[3],g,j)}function l(a,b,c){for(var d=0;d<4;++d)A(a[d],b[d],c)}function m(a,b){var c=B(),d=B(),e=B();y(e,b[2]),F(c,b[0],e),F(d,b[1],e),n(a,d),a[31]^=u(c)<<7}function n(a,b){var c,d,e,f=B(),g=B();for(c=0;c<16;++c)g[c]=b[c];for(z(g),z(g),z(g),d=0;d<2;++d){for(f[0]=g[0]-65517,c=1;c<15;++c)f[c]=g[c]-65535-(f[c-1]>>16&1),f[c-1]&=65535;f[15]=g[15]-32767-(f[14]>>16&1),e=f[15]>>16&1,f[14]&=65535,A(g,f,1-e)}for(c=0;c<16;c++)a[2*c]=255&g[c],a[2*c+1]=g[c]>>8}function o(a,b){var c=B(),d=B(),e=B(),f=B(),g=B(),h=B(),i=B();return x(a[2],P),p(a[1],b),E(e,a[1]),F(f,e,Q),D(e,e,a[2]),C(f,a[2],f),E(g,f),E(h,g),F(i,h,g),F(c,i,e),F(c,c,f),q(c,c),F(c,c,e),F(c,c,f),F(c,c,f),F(a[0],c,f),E(d,a[0]),F(d,d,f),r(d,e)&&F(a[0],a[0],V),E(d,a[0]),F(d,d,f),r(d,e)?-1:(u(a[0])===b[31]>>7&&D(a[0],O,a[0]),F(a[3],a[0],a[1]),0)}function p(a,b){var c;for(c=0;c<16;++c)a[c]=b[2*c]+(b[2*c+1]<<8);a[15]&=32767}function q(a,b){var c,d=B();for(c=0;c<16;++c)d[c]=b[c];for(c=250;c>=0;--c)E(d,d),1!==c&&F(d,d,b);for(c=0;c<16;++c)a[c]=d[c]}function r(a,b){var c=new M(32),d=new M(32);return n(c,a),n(d,b),s(c,0,d,0)}function s(a,b,c,d){return t(a,b,c,d,32)}function t(a,b,c,d,e){var f,g=0;for(f=0;f<e;++f)g|=a[b+f]^c[d+f];return(1&g-1>>>8)-1}function u(a){var b=new M(32);return n(b,a),1&b[0]}function v(a,b,c){var d,e;for(x(a[0],O),x(a[1],P),x(a[2],P),x(a[3],O),e=255;e>=0;--e)d=c[e/8|0]>>(7&e)&1,l(a,b,d),k(b,a),k(a,a),l(a,b,d)}function w(a,b){var c=[B(),B(),B(),B()];x(c[0],S),x(c[1],T),x(c[2],P),F(c[3],S,T),v(a,c,b)}function x(a,b){var c;for(c=0;c<16;c++)a[c]=0|b[c]}function y(a,b){var c,d=B();for(c=0;c<16;++c)d[c]=b[c];for(c=253;c>=0;--c)E(d,d),2!==c&&4!==c&&F(d,d,b);for(c=0;c<16;++c)a[c]=d[c]}function z(a){var b,c,d=1;for(b=0;b<16;++b)c=a[b]+d+65535,d=Math.floor(c/65536),a[b]=c-65536*d;a[0]+=d-1+37*(d-1)}function A(a,b,c){for(var d,e=~(c-1),f=0;f<16;++f)d=e&(a[f]^b[f]),a[f]^=d,b[f]^=d}function B(a){var b,c=new Float64Array(16);if(a)for(b=0;b<a.length;++b)c[b]=a[b];return c}function C(a,b,c){for(var d=0;d<16;++d)a[d]=b[d]+c[d]}function D(a,b,c){for(var d=0;d<16;++d)a[d]=b[d]-c[d]}function E(a,b){F(a,b,b)}function F(a,b,c){var d,e,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=c[0],L=c[1],M=c[2],N=c[3],O=c[4],P=c[5],Q=c[6],R=c[7],S=c[8],T=c[9],U=c[10],V=c[11],W=c[12],X=c[13],Y=c[14],Z=c[15];d=b[0],f+=d*K,g+=d*L,h+=d*M,i+=d*N,j+=d*O,k+=d*P,l+=d*Q,m+=d*R,n+=d*S,o+=d*T,p+=d*U,q+=d*V,r+=d*W,s+=d*X,t+=d*Y,u+=d*Z,d=b[1],g+=d*K,h+=d*L,i+=d*M,j+=d*N,k+=d*O,l+=d*P,m+=d*Q,n+=d*R,o+=d*S,p+=d*T,q+=d*U,r+=d*V,s+=d*W,t+=d*X,u+=d*Y,v+=d*Z,d=b[2],h+=d*K,i+=d*L,j+=d*M,k+=d*N,l+=d*O,m+=d*P,n+=d*Q,o+=d*R,p+=d*S,q+=d*T,r+=d*U,s+=d*V,t+=d*W,u+=d*X,v+=d*Y,w+=d*Z,d=b[3],i+=d*K,j+=d*L,k+=d*M,l+=d*N,m+=d*O,n+=d*P,o+=d*Q,p+=d*R,q+=d*S,r+=d*T,s+=d*U,t+=d*V,u+=d*W,v+=d*X,w+=d*Y,x+=d*Z,d=b[4],j+=d*K,k+=d*L,l+=d*M,m+=d*N,n+=d*O,o+=d*P,p+=d*Q,q+=d*R,r+=d*S,s+=d*T,t+=d*U,u+=d*V,v+=d*W,w+=d*X,x+=d*Y,y+=d*Z,d=b[5],k+=d*K,l+=d*L,m+=d*M,n+=d*N,o+=d*O,p+=d*P,q+=d*Q,r+=d*R,s+=d*S,t+=d*T,u+=d*U,v+=d*V,w+=d*W,x+=d*X,y+=d*Y,z+=d*Z,d=b[6],l+=d*K,m+=d*L,n+=d*M,o+=d*N,p+=d*O,q+=d*P,r+=d*Q,s+=d*R,t+=d*S,u+=d*T,v+=d*U,w+=d*V,x+=d*W,y+=d*X,z+=d*Y,A+=d*Z,d=b[7],m+=d*K,n+=d*L,o+=d*M,p+=d*N,q+=d*O,r+=d*P,s+=d*Q,t+=d*R,u+=d*S,v+=d*T,w+=d*U,x+=d*V,y+=d*W,z+=d*X,A+=d*Y,B+=d*Z,d=b[8],n+=d*K,o+=d*L,p+=d*M,q+=d*N,r+=d*O,s+=d*P,t+=d*Q,u+=d*R,v+=d*S,w+=d*T,x+=d*U,y+=d*V,z+=d*W,A+=d*X,B+=d*Y,C+=d*Z,d=b[9],o+=d*K,p+=d*L,q+=d*M,r+=d*N,s+=d*O,t+=d*P,u+=d*Q,v+=d*R,w+=d*S,x+=d*T,y+=d*U,z+=d*V,A+=d*W,B+=d*X,C+=d*Y,D+=d*Z,d=b[10],p+=d*K,q+=d*L,r+=d*M,s+=d*N,t+=d*O,u+=d*P,v+=d*Q,w+=d*R,x+=d*S,y+=d*T,z+=d*U,A+=d*V,B+=d*W,C+=d*X,D+=d*Y,E+=d*Z,d=b[11],q+=d*K,r+=d*L,s+=d*M,t+=d*N,u+=d*O,v+=d*P,w+=d*Q,x+=d*R,y+=d*S,z+=d*T,A+=d*U,B+=d*V,C+=d*W,D+=d*X,E+=d*Y,F+=d*Z,d=b[12],r+=d*K,s+=d*L,t+=d*M,u+=d*N,v+=d*O,w+=d*P,x+=d*Q,y+=d*R,z+=d*S,A+=d*T,B+=d*U,C+=d*V,D+=d*W,E+=d*X,F+=d*Y,G+=d*Z,d=b[13],s+=d*K,t+=d*L,u+=d*M,v+=d*N,w+=d*O,x+=d*P,y+=d*Q,z+=d*R,A+=d*S,B+=d*T,C+=d*U,D+=d*V,E+=d*W,F+=d*X,G+=d*Y,H+=d*Z,d=b[14],t+=d*K,u+=d*L,v+=d*M,w+=d*N,x+=d*O,y+=d*P,z+=d*Q,A+=d*R,B+=d*S,C+=d*T,D+=d*U,E+=d*V,F+=d*W,G+=d*X,H+=d*Y,I+=d*Z,d=b[15],u+=d*K,v+=d*L,w+=d*M,x+=d*N,y+=d*O,z+=d*P,A+=d*Q,B+=d*R,C+=d*S,D+=d*T,E+=d*U,F+=d*V,G+=d*W,H+=d*X,I+=d*Y,J+=d*Z,f+=38*v,g+=38*w,h+=38*x,i+=38*y,j+=38*z,k+=38*A,l+=38*B,m+=38*C,n+=38*D,o+=38*E,p+=38*F,q+=38*G,r+=38*H,s+=38*I,t+=38*J,e=1,d=f+e+65535,e=Math.floor(d/65536),f=d-65536*e,d=g+e+65535,e=Math.floor(d/65536),g=d-65536*e,d=h+e+65535,e=Math.floor(d/65536),h=d-65536*e,d=i+e+65535,e=Math.floor(d/65536),i=d-65536*e,d=j+e+65535,e=Math.floor(d/65536),j=d-65536*e,d=k+e+65535,e=Math.floor(d/65536),k=d-65536*e,d=l+e+65535,e=Math.floor(d/65536),l=d-65536*e,d=m+e+65535,e=Math.floor(d/65536),m=d-65536*e,d=n+e+65535,e=Math.floor(d/65536),n=d-65536*e,d=o+e+65535,e=Math.floor(d/65536),o=d-65536*e,d=p+e+65535,e=Math.floor(d/65536),p=d-65536*e,d=q+e+65535,e=Math.floor(d/65536),q=d-65536*e,d=r+e+65535,e=Math.floor(d/65536),r=d-65536*e,d=s+e+65535,e=Math.floor(d/65536),s=d-65536*e,d=t+e+65535,e=Math.floor(d/65536),t=d-65536*e,d=u+e+65535,e=Math.floor(d/65536),u=d-65536*e,f+=e-1+37*(e-1),e=1,d=f+e+65535,e=Math.floor(d/65536),f=d-65536*e,d=g+e+65535,e=Math.floor(d/65536),g=d-65536*e,d=h+e+65535,e=Math.floor(d/65536),h=d-65536*e,d=i+e+65535,e=Math.floor(d/65536),i=d-65536*e,d=j+e+65535,e=Math.floor(d/65536),j=d-65536*e,d=k+e+65535,e=Math.floor(d/65536),k=d-65536*e,d=l+e+65535,e=Math.floor(d/65536),l=d-65536*e,d=m+e+65535,e=Math.floor(d/65536),m=d-65536*e,d=n+e+65535,e=Math.floor(d/65536),n=d-65536*e,d=o+e+65535,e=Math.floor(d/65536),o=d-65536*e,d=p+e+65535,e=Math.floor(d/65536),p=d-65536*e,d=q+e+65535,e=Math.floor(d/65536),q=d-65536*e,d=r+e+65535,e=Math.floor(d/65536),r=d-65536*e,d=s+e+65535,e=Math.floor(d/65536),s=d-65536*e,d=t+e+65535,e=Math.floor(d/65536),t=d-65536*e,d=u+e+65535,e=Math.floor(d/65536),u=d-65536*e,f+=e-1+37*(e-1),a[0]=f,a[1]=g,a[2]=h,a[3]=i,a[4]=j,a[5]=k,a[6]=l,a[7]=m,a[8]=n,a[9]=o,a[10]=p,a[11]=q,a[12]=r,a[13]=s,a[14]=t,a[15]=u}var G=a("./forge");a("./jsbn"),a("./random"),a("./sha512"),a("./util");var H=a("./asn1-validator"),I=H.publicKeyValidator,J=H.privateKeyValidator;if("undefined"==typeof K)var K=G.jsbn.BigInteger;var L=G.util.ByteBuffer,M="undefined"==typeof c?Uint8Array:c;G.pki=G.pki||{},b.exports=G.pki.ed25519=G.ed25519=G.ed25519||{};var N=G.ed25519;N.constants={},N.constants.PUBLIC_KEY_BYTE_LENGTH=32,N.constants.PRIVATE_KEY_BYTE_LENGTH=64,N.constants.SEED_BYTE_LENGTH=32,N.constants.SIGN_BYTE_LENGTH=64,N.constants.HASH_BYTE_LENGTH=64,N.generateKeyPair=function(a){a=a||{};var b=a.seed;if(void 0===b)b=G.random.getBytesSync(N.constants.SEED_BYTE_LENGTH);else if("string"==typeof b){if(b.length!==N.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+N.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(b instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');b=d({message:b,encoding:"binary"});for(var c=new M(N.constants.PUBLIC_KEY_BYTE_LENGTH),e=new M(N.constants.PRIVATE_KEY_BYTE_LENGTH),g=0;g<32;++g)e[g]=b[g];return f(c,e),{publicKey:c,privateKey:e}},N.privateKeyFromAsn1=function(a){var b={},c=[],e=G.asn1.validate(a,J,b,c);if(!e){var f=new Error("Invalid Key.");throw f.errors=c,f}var g=G.asn1.derToOid(b.privateKeyOid),h=G.oids.EdDSA25519;if(g!==h)throw new Error('Invalid OID "'+g+'"; OID must be "'+h+'".');var i=b.privateKey,j=d({message:G.asn1.fromDer(i).value,encoding:"binary"});return{privateKeyBytes:j}},N.publicKeyFromAsn1=function(a){var b={},c=[],e=G.asn1.validate(a,I,b,c);if(!e){var f=new Error("Invalid Key.");throw f.errors=c,f}var g=G.asn1.derToOid(b.publicKeyOid),h=G.oids.EdDSA25519;if(g!==h)throw new Error('Invalid OID "'+g+'"; OID must be "'+h+'".');var i=b.ed25519PublicKey;if(i.length!==N.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return d({message:i,encoding:"binary"})},N.publicKeyFromPrivateKey=function(a){a=a||{};var b=d({message:a.privateKey,encoding:"binary"});if(b.length!==N.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+N.constants.PRIVATE_KEY_BYTE_LENGTH);for(var c=new M(N.constants.PUBLIC_KEY_BYTE_LENGTH),e=0;e<c.length;++e)c[e]=b[32+e];return c},N.sign=function(a){a=a||{};var b=d(a),c=d({message:a.privateKey,encoding:"binary"});if(c.length===N.constants.SEED_BYTE_LENGTH){var e=N.generateKeyPair({seed:c});c=e.privateKey}else if(c.length!==N.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+N.constants.SEED_BYTE_LENGTH+" or "+N.constants.PRIVATE_KEY_BYTE_LENGTH);var f=new M(N.constants.SIGN_BYTE_LENGTH+b.length);g(f,b,b.length,c);for(var h=new M(N.constants.SIGN_BYTE_LENGTH),i=0;i<h.length;++i)h[i]=f[i];return h},N.verify=function(a){a=a||{};var b=d(a);if(void 0===a.signature)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var c=d({message:a.signature,encoding:"binary"});if(c.length!==N.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+N.constants.SIGN_BYTE_LENGTH);var e=d({message:a.publicKey,encoding:"binary"});if(e.length!==N.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+N.constants.PUBLIC_KEY_BYTE_LENGTH);var f,g=new M(N.constants.SIGN_BYTE_LENGTH+b.length),i=new M(N.constants.SIGN_BYTE_LENGTH+b.length);for(f=0;f<N.constants.SIGN_BYTE_LENGTH;++f)g[f]=c[f];for(f=0;f<b.length;++f)g[f+N.constants.SIGN_BYTE_LENGTH]=b[f];return h(i,g,g.length,e)>=0};var O=B(),P=B([1]),Q=B([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),R=B([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),S=B([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),T=B([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),U=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),V=B([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139])}).call(this,a("buffer").Buffer)},{"./asn1-validator":39,"./forge":47,"./jsbn":50,"./random":70,"./sha512":75,"./util":79,buffer:18}],47:[function(a,b,c){b.exports={options:{usePureJavaScript:!1}}},{}],48:[function(a,b,c){var d=a("./forge");a("./md"),a("./util");var e=b.exports=d.hmac=d.hmac||{};e.create=function(){var a=null,b=null,c=null,e=null,f={};return f.start=function(f,g){if(null!==f)if("string"==typeof f){if(f=f.toLowerCase(),!(f in d.md.algorithms))throw new Error('Unknown hash algorithm "'+f+'"');b=d.md.algorithms[f].create()}else b=f;if(null===g)g=a;else{if("string"==typeof g)g=d.util.createBuffer(g);else if(d.util.isArray(g)){var h=g;g=d.util.createBuffer();for(var i=0;i<h.length;++i)g.putByte(h[i])}var j=g.length();j>b.blockLength&&(b.start(),b.update(g.bytes()),g=b.digest()),c=d.util.createBuffer(),e=d.util.createBuffer(),j=g.length();for(var i=0;i<j;++i){var h=g.at(i);c.putByte(54^h),e.putByte(92^h)}if(j<b.blockLength)for(var h=b.blockLength-j,i=0;i<h;++i)c.putByte(54),e.putByte(92);a=g,c=c.bytes(),e=e.bytes()}b.start(),b.update(c)},f.update=function(a){b.update(a)},f.getMac=function(){var a=b.digest().bytes();return b.start(),b.update(e),b.update(a),b.digest()},f.digest=f.getMac,f}},{"./forge":47,"./md":54,"./util":79}],49:[function(a,b,c){b.exports=a("./forge"),a("./aes"),a("./aesCipherSuites"),a("./asn1"),a("./cipher"),a("./debug"),a("./des"),a("./ed25519"),a("./hmac"),a("./kem"),a("./log"),a("./md.all"),a("./mgf1"),a("./pbkdf2"),a("./pem"),a("./pkcs1"),a("./pkcs12"),a("./pkcs7"),a("./pki"),a("./prime"),a("./prng"),a("./pss"),a("./random"),a("./rc2"),a("./ssh"),a("./task"),a("./tls"),a("./util")},{"./aes":37,"./aesCipherSuites":38,"./asn1":40,"./cipher":42,"./debug":44,"./des":45,"./ed25519":46,"./forge":47,"./hmac":48,"./kem":51,"./log":52,"./md.all":53,"./mgf1":57,"./pbkdf2":60,"./pem":61,"./pkcs1":62,"./pkcs12":63,"./pkcs7":64,"./pki":66,"./prime":67,"./prng":68,"./pss":69,"./random":70,"./rc2":71,"./ssh":76,"./task":77,"./tls":78,"./util":79}],50:[function(a,b,c){function d(a,b,c){this.data=[],null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function e(){return new d(null)}function f(a,b,c,d,e,f){for(;--f>=0;){var g=b*this.data[a++]+c.data[d]+e;e=Math.floor(g/67108864),c.data[d++]=67108863&g}return e}function g(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this.data[a],j=this.data[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c.data[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c.data[d++]=1073741823&i}return e}function h(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this.data[a],j=this.data[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c.data[d]+e,e=(i>>28)+(k>>14)+h*j,c.data[d++]=268435455&i}return e}function i(a){return ib.charAt(a)}function j(a,b){var c=jb[a.charCodeAt(b)];return null==c?-1:c}function k(a){for(var b=this.t-1;b>=0;--b)a.data[b]=this.data[b];a.t=this.t,a.s=this.s}function l(a){this.t=1,this.s=a<0?-1:0,a>0?this.data[0]=a:a<-1?this.data[0]=a+this.DV:this.t=0}function m(a){var b=e();return b.fromInt(a),b}function n(a,b){var c;if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else{if(4!=b)return void this.fromRadix(a,b);c=2}this.t=0,this.s=0;for(var e=a.length,f=!1,g=0;--e>=0;){var h=8==c?255&a[e]:j(a,e);h<0?"-"==a.charAt(e)&&(f=!0):(f=!1,0==g?this.data[this.t++]=h:g+c>this.DB?(this.data[this.t-1]|=(h&(1<<this.DB-g)-1)<<g,this.data[this.t++]=h>>this.DB-g):this.data[this.t-1]|=h<<g,g+=c,g>=this.DB&&(g-=this.DB))}8==c&&0!=(128&a[0])&&(this.s=-1,g>0&&(this.data[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&d.ZERO.subTo(this,this)}function o(){for(var a=this.s&this.DM;this.t>0&&this.data[this.t-1]==a;)--this.t}function p(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",g=this.t,h=this.DB-g*this.DB%b;if(g-- >0)for(h<this.DB&&(c=this.data[g]>>h)>0&&(e=!0,f=i(c));g>=0;)h<b?(c=(this.data[g]&(1<<h)-1)<<b-h,c|=this.data[--g]>>(h+=this.DB-b)):(c=this.data[g]>>(h-=b)&d,h<=0&&(h+=this.DB,--g)),c>0&&(e=!0),e&&(f+=i(c));return e?f:"0"}function q(){var a=e();return d.ZERO.subTo(this,a),a}function r(){return this.s<0?this.negate():this}function s(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this.data[c]-a.data[c]))return b;return 0}function t(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function u(){return this.t<=0?0:this.DB*(this.t-1)+t(this.data[this.t-1]^this.s&this.DM)}function v(a,b){var c;for(c=this.t-1;c>=0;--c)b.data[c+a]=this.data[c];for(c=a-1;c>=0;--c)b.data[c]=0;b.t=this.t+a,b.s=this.s}function w(a,b){for(var c=a;c<this.t;++c)b.data[c-a]=this.data[c];b.t=Math.max(this.t-a,0),b.s=this.s}function x(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b.data[c+g+1]=this.data[c]>>e|h,h=(this.data[c]&f)<<d;for(c=g-1;c>=0;--c)b.data[c]=0;b.data[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function y(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b.data[0]=this.data[c]>>d;for(var g=c+1;g<this.t;++g)b.data[g-c-1]|=(this.data[g]&f)<<e,b.data[g-c]=this.data[g]>>d;d>0&&(b.data[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function z(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this.data[c]-a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=d<0?-1:0,d<-1?b.data[c++]=this.DV+d:d>0&&(b.data[c++]=d),b.t=c,b.clamp()}function A(a,b){var c=this.abs(),e=a.abs(),f=c.t;for(b.t=f+e.t;--f>=0;)b.data[f]=0;for(f=0;f<e.t;++f)b.data[f+c.t]=c.am(0,e.data[f],b,f,0,c.t);b.s=0,b.clamp(),this.s!=a.s&&d.ZERO.subTo(b,b)}function B(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a.data[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b.data[c],a,2*c,0,1);(a.data[c+b.t]+=b.am(c+1,2*b.data[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a.data[c+b.t]-=b.DV,a.data[c+b.t+1]=1)}a.t>0&&(a.data[a.t-1]+=b.am(c,b.data[c],a,2*c,0,1)),a.s=0,a.clamp()}function C(a,b,c){var f=a.abs();if(!(f.t<=0)){var g=this.abs();if(g.t<f.t)return null!=b&&b.fromInt(0),void(null!=c&&this.copyTo(c));null==c&&(c=e());var h=e(),i=this.s,j=a.s,k=this.DB-t(f.data[f.t-1]);k>0?(f.lShiftTo(k,h),g.lShiftTo(k,c)):(f.copyTo(h),g.copyTo(c));var l=h.t,m=h.data[l-1];if(0!=m){var n=m*(1<<this.F1)+(l>1?h.data[l-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,r=c.t,s=r-l,u=null==b?e():b;for(h.dlShiftTo(s,u),c.compareTo(u)>=0&&(c.data[c.t++]=1,c.subTo(u,c)),d.ONE.dlShiftTo(l,u),u.subTo(h,h);h.t<l;)h.data[h.t++]=0;for(;--s>=0;){var v=c.data[--r]==m?this.DM:Math.floor(c.data[r]*o+(c.data[r-1]+q)*p);if((c.data[r]+=h.am(0,v,c,s,0,l))<v)for(h.dlShiftTo(s,u),c.subTo(u,c);c.data[r]<--v;)c.subTo(u,c)}null!=b&&(c.drShiftTo(l,b),i!=j&&d.ZERO.subTo(b,b)),c.t=l,c.clamp(),k>0&&c.rShiftTo(k,c),i<0&&d.ZERO.subTo(c,c)}}}function D(a){var b=e();return this.abs().divRemTo(a,null,b),this.s<0&&b.compareTo(d.ZERO)>0&&a.subTo(b,b),b}function E(a){this.m=a}function F(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function G(a){return a}function H(a){a.divRemTo(this.m,null,a)}function I(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function J(a,b){a.squareTo(b),this.reduce(b)}function K(){if(this.t<1)return 0;var a=this.data[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function L(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function M(a){var b=e();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(d.ZERO)>0&&this.m.subTo(b,b),b}function N(a){var b=e();return a.copyTo(b),this.reduce(b),b}function O(a){for(;a.t<=this.mt2;)a.data[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a.data[b],d=c*this.mpl+((c*this.mph+(a.data[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a.data[c]+=this.m.am(0,d,a,b,0,this.m.t);a.data[c]>=a.DV;)a.data[c]-=a.DV,a.data[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function P(a,b){a.squareTo(b),this.reduce(b)}function Q(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function R(){return 0==(this.t>0?1&this.data[0]:this.s)}function S(a,b){if(a>4294967295||a<1)return d.ONE;var c=e(),f=e(),g=b.convert(this),h=t(a)-1;for(g.copyTo(c);--h>=0;)if(b.sqrTo(c,f),(a&1<<h)>0)b.mulTo(f,g,c);else{var i=c;c=f,f=i}return b.revert(c)}function T(a,b){var c;return c=a<256||b.isEven()?new E(b):new L(b),this.exp(a,c)}function U(){var a=e();return this.copyTo(a),a}function V(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function W(){return 0==this.t?this.s:this.data[0]<<24>>24}function X(){return 0==this.t?this.s:this.data[0]<<16>>16}function Y(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function Z(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function $(a){if(null==a&&(a=10),0==this.signum()||a<2||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),d=m(c),f=e(),g=e(),h="";for(this.divRemTo(d,f,g);f.signum()>0;)h=(c+g.intValue()).toString(a).substr(1)+h,f.divRemTo(d,f,g);return g.intValue().toString(a)+h}function _(a,b){this.fromInt(0),null==b&&(b=10);for(var c=this.chunkSize(b),e=Math.pow(b,c),f=!1,g=0,h=0,i=0;i<a.length;++i){var k=j(a,i);k<0?"-"==a.charAt(i)&&0==this.signum()&&(f=!0):(h=b*h+k,++g>=c&&(this.dMultiply(e),this.dAddOffset(h,0),g=0,h=0))}g>0&&(this.dMultiply(Math.pow(b,g)),this.dAddOffset(h,0)),f&&d.ZERO.subTo(this,this)}function aa(a,b,c){if("number"==typeof b)if(a<2)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(d.ONE.shiftLeft(a-1),ia,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(d.ONE.shiftLeft(a-1),this);else{var e=new Array,f=7&a;e.length=(a>>3)+1,b.nextBytes(e),f>0?e[0]&=(1<<f)-1:e[0]=0,this.fromString(e,256)}}function ba(){var a=this.t,b=new Array;b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-- >0)for(d<this.DB&&(c=this.data[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)d<8?(c=(this.data[a]&(1<<d)-1)<<8-d,c|=this.data[--a]>>(d+=this.DB-8)):(c=this.data[a]>>(d-=8)&255,d<=0&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function ca(a){return 0==this.compareTo(a)}function da(a){return this.compareTo(a)<0?this:a}function ea(a){return this.compareTo(a)>0?this:a}function fa(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;d<f;++d)c.data[d]=b(this.data[d],a.data[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c.data[d]=b(this.data[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c.data[d]=b(e,a.data[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function ga(a,b){return a&b}function ha(a){var b=e();return this.bitwiseTo(a,ga,b),b}function ia(a,b){return a|b}function ja(a){var b=e();return this.bitwiseTo(a,ia,b),b}function ka(a,b){return a^b}function la(a){var b=e();return this.bitwiseTo(a,ka,b),b}function ma(a,b){return a&~b}function na(a){var b=e();return this.bitwiseTo(a,ma,b),b}function oa(){for(var a=e(),b=0;b<this.t;++b)a.data[b]=this.DM&~this.data[b];return a.t=this.t,a.s=~this.s,a}function pa(a){var b=e();return a<0?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function qa(a){var b=e();return a<0?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function ra(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function sa(){for(var a=0;a<this.t;++a)if(0!=this.data[a])return a*this.DB+ra(this.data[a]);return this.s<0?this.t*this.DB:-1}function ta(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function ua(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=ta(this.data[c]^b);return a}function va(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this.data[b]&1<<a%this.DB)}function wa(a,b){var c=d.ONE.shiftLeft(a);return this.bitwiseTo(c,b,c),c}function xa(a){return this.changeBit(a,ia)}function ya(a){return this.changeBit(a,ma)}function za(a){return this.changeBit(a,ka)}function Aa(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this.data[c]+a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=d<0?-1:0,d>0?b.data[c++]=d:d<-1&&(b.data[c++]=this.DV+d),b.t=c,b.clamp()}function Ba(a){var b=e();return this.addTo(a,b),b}function Ca(a){var b=e();return this.subTo(a,b),b}function Da(a){var b=e();return this.multiplyTo(a,b),b}function Ea(a){var b=e();return this.divRemTo(a,b,null),b}function Fa(a){var b=e();return this.divRemTo(a,null,b),b}function Ga(a){var b=e(),c=e();return this.divRemTo(a,b,c),new Array(b,c)}function Ha(a){this.data[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function Ia(a,b){if(0!=a){for(;this.t<=b;)this.data[this.t++]=0;for(this.data[b]+=a;this.data[b]>=this.DV;)this.data[b]-=this.DV,++b>=this.t&&(this.data[this.t++]=0),++this.data[b]}}function Ja(){}function Ka(a){return a}function La(a,b,c){a.multiplyTo(b,c)}function Ma(a,b){a.squareTo(b)}function Na(a){return this.exp(a,new Ja)}function Oa(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c.data[--d]=0;var e;for(e=c.t-this.t;d<e;++d)c.data[d+this.t]=this.am(0,a.data[d],c,d,0,this.t);for(e=Math.min(a.t,b);d<e;++d)this.am(0,a.data[d],c,d,0,b-d);c.clamp()}function Pa(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c.data[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c.data[this.t+d-b]=this.am(b-d,a.data[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function Qa(a){
this.r2=e(),this.q3=e(),d.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function Ra(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=e();return a.copyTo(b),this.reduce(b),b}function Sa(a){return a}function Ta(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function Ua(a,b){a.squareTo(b),this.reduce(b)}function Va(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Wa(a,b){var c,d,f=a.bitLength(),g=m(1);if(f<=0)return g;c=f<18?1:f<48?3:f<144?4:f<768?5:6,d=f<8?new E(b):b.isEven()?new Qa(b):new L(b);var h=new Array,i=3,j=c-1,k=(1<<c)-1;if(h[1]=d.convert(this),c>1){var l=e();for(d.sqrTo(h[1],l);i<=k;)h[i]=e(),d.mulTo(l,h[i-2],h[i]),i+=2}var n,o,p=a.t-1,q=!0,r=e();for(f=t(a.data[p])-1;p>=0;){for(f>=j?n=a.data[p]>>f-j&k:(n=(a.data[p]&(1<<f+1)-1)<<j-f,p>0&&(n|=a.data[p-1]>>this.DB+f-j)),i=c;0==(1&n);)n>>=1,--i;if((f-=i)<0&&(f+=this.DB,--p),q)h[n].copyTo(g),q=!1;else{for(;i>1;)d.sqrTo(g,r),d.sqrTo(r,g),i-=2;i>0?d.sqrTo(g,r):(o=g,g=r,r=o),d.mulTo(r,h[n],g)}for(;p>=0&&0==(a.data[p]&1<<f);)d.sqrTo(g,r),o=g,g=r,r=o,--f<0&&(f=this.DB-1,--p)}return d.revert(g)}function Xa(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(f<0)return b;for(e<f&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function Ya(a){if(a<=0)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this.data[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this.data[d])%a;return c}function Za(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return d.ZERO;for(var c=a.clone(),e=this.clone(),f=m(1),g=m(0),h=m(0),i=m(1);0!=c.signum();){for(;c.isEven();)c.rShiftTo(1,c),b?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(a,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(a,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),b?(h.isEven()&&i.isEven()||(h.addTo(this,h),i.subTo(a,i)),h.rShiftTo(1,h)):i.isEven()||i.subTo(a,i),i.rShiftTo(1,i);c.compareTo(e)>=0?(c.subTo(e,c),b&&f.subTo(h,f),g.subTo(i,g)):(e.subTo(c,e),b&&h.subTo(f,h),i.subTo(g,i))}return 0!=e.compareTo(d.ONE)?d.ZERO:i.compareTo(a)>=0?i.subtract(a):i.signum()<0?(i.addTo(a,i),i.signum()<0?i.add(a):i):i}function $a(a){var b,c=this.abs();if(1==c.t&&c.data[0]<=kb[kb.length-1]){for(b=0;b<kb.length;++b)if(c.data[0]==kb[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<kb.length;){for(var d=kb[b],e=b+1;e<kb.length&&d<lb;)d*=kb[e++];for(d=c.modInt(d);b<e;)if(d%kb[b++]==0)return!1}return c.millerRabin(a)}function _a(a){var b=this.subtract(d.ONE),c=b.getLowestSetBit();if(c<=0)return!1;for(var e,f=b.shiftRight(c),g=ab(),h=0;h<a;++h){do e=new d(this.bitLength(),g);while(e.compareTo(d.ONE)<=0||e.compareTo(b)>=0);var i=e.modPow(f,this);if(0!=i.compareTo(d.ONE)&&0!=i.compareTo(b)){for(var j=1;j++<c&&0!=i.compareTo(b);)if(i=i.modPowInt(2,this),0==i.compareTo(d.ONE))return!1;if(0!=i.compareTo(b))return!1}}return!0}function ab(){return{nextBytes:function(a){for(var b=0;b<a.length;++b)a[b]=Math.floor(256*Math.random())}}}var bb=a("./forge");b.exports=bb.jsbn=bb.jsbn||{};var cb,db=0xdeadbeefcafe,eb=15715070==(16777215&db);bb.jsbn.BigInteger=d,"undefined"==typeof navigator?(d.prototype.am=h,cb=28):eb&&"Microsoft Internet Explorer"==navigator.appName?(d.prototype.am=g,cb=30):eb&&"Netscape"!=navigator.appName?(d.prototype.am=f,cb=26):(d.prototype.am=h,cb=28),d.prototype.DB=cb,d.prototype.DM=(1<<cb)-1,d.prototype.DV=1<<cb;var fb=52;d.prototype.FV=Math.pow(2,fb),d.prototype.F1=fb-cb,d.prototype.F2=2*cb-fb;var gb,hb,ib="0123456789abcdefghijklmnopqrstuvwxyz",jb=new Array;for(gb="0".charCodeAt(0),hb=0;hb<=9;++hb)jb[gb++]=hb;for(gb="a".charCodeAt(0),hb=10;hb<36;++hb)jb[gb++]=hb;for(gb="A".charCodeAt(0),hb=10;hb<36;++hb)jb[gb++]=hb;E.prototype.convert=F,E.prototype.revert=G,E.prototype.reduce=H,E.prototype.mulTo=I,E.prototype.sqrTo=J,L.prototype.convert=M,L.prototype.revert=N,L.prototype.reduce=O,L.prototype.mulTo=Q,L.prototype.sqrTo=P,d.prototype.copyTo=k,d.prototype.fromInt=l,d.prototype.fromString=n,d.prototype.clamp=o,d.prototype.dlShiftTo=v,d.prototype.drShiftTo=w,d.prototype.lShiftTo=x,d.prototype.rShiftTo=y,d.prototype.subTo=z,d.prototype.multiplyTo=A,d.prototype.squareTo=B,d.prototype.divRemTo=C,d.prototype.invDigit=K,d.prototype.isEven=R,d.prototype.exp=S,d.prototype.toString=p,d.prototype.negate=q,d.prototype.abs=r,d.prototype.compareTo=s,d.prototype.bitLength=u,d.prototype.mod=D,d.prototype.modPowInt=T,d.ZERO=m(0),d.ONE=m(1),Ja.prototype.convert=Ka,Ja.prototype.revert=Ka,Ja.prototype.mulTo=La,Ja.prototype.sqrTo=Ma,Qa.prototype.convert=Ra,Qa.prototype.revert=Sa,Qa.prototype.reduce=Ta,Qa.prototype.mulTo=Va,Qa.prototype.sqrTo=Ua;var kb=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lb=(1<<26)/kb[kb.length-1];d.prototype.chunkSize=Y,d.prototype.toRadix=$,d.prototype.fromRadix=_,d.prototype.fromNumber=aa,d.prototype.bitwiseTo=fa,d.prototype.changeBit=wa,d.prototype.addTo=Aa,d.prototype.dMultiply=Ha,d.prototype.dAddOffset=Ia,d.prototype.multiplyLowerTo=Oa,d.prototype.multiplyUpperTo=Pa,d.prototype.modInt=Ya,d.prototype.millerRabin=_a,d.prototype.clone=U,d.prototype.intValue=V,d.prototype.byteValue=W,d.prototype.shortValue=X,d.prototype.signum=Z,d.prototype.toByteArray=ba,d.prototype.equals=ca,d.prototype.min=da,d.prototype.max=ea,d.prototype.and=ha,d.prototype.or=ja,d.prototype.xor=la,d.prototype.andNot=na,d.prototype.not=oa,d.prototype.shiftLeft=pa,d.prototype.shiftRight=qa,d.prototype.getLowestSetBit=sa,d.prototype.bitCount=ua,d.prototype.testBit=va,d.prototype.setBit=xa,d.prototype.clearBit=ya,d.prototype.flipBit=za,d.prototype.add=Ba,d.prototype.subtract=Ca,d.prototype.multiply=Da,d.prototype.divide=Ea,d.prototype.remainder=Fa,d.prototype.divideAndRemainder=Ga,d.prototype.modPow=Wa,d.prototype.modInverse=Za,d.prototype.pow=Na,d.prototype.gcd=Xa,d.prototype.isProbablePrime=$a},{"./forge":47}],51:[function(a,b,c){function d(a,b,c,d){a.generate=function(a,f){for(var g=new e.util.ByteBuffer,h=Math.ceil(f/d)+c,i=new e.util.ByteBuffer,j=c;j<h;++j){i.putInt32(j),b.start(),b.update(a+i.getBytes());var k=b.digest();g.putBytes(k.getBytes(d))}return g.truncate(g.length()-f),g.getBytes()}}var e=a("./forge");a("./util"),a("./random"),a("./jsbn"),b.exports=e.kem=e.kem||{};var f=e.jsbn.BigInteger;e.kem.rsa={},e.kem.rsa.create=function(a,b){b=b||{};var c=b.prng||e.random,d={};return d.encrypt=function(b,d){var g,h=Math.ceil(b.n.bitLength()/8);do g=new f(e.util.bytesToHex(c.getBytesSync(h)),16).mod(b.n);while(g.compareTo(f.ONE)<=0);g=e.util.hexToBytes(g.toString(16));var i=h-g.length;i>0&&(g=e.util.fillString(String.fromCharCode(0),i)+g);var j=b.encrypt(g,"NONE"),k=a.generate(g,d);return{encapsulation:j,key:k}},d.decrypt=function(b,c,d){var e=b.decrypt(c,"NONE");return a.generate(e,d)},d},e.kem.kdf1=function(a,b){d(this,a,0,b||a.digestLength)},e.kem.kdf2=function(a,b){d(this,a,1,b||a.digestLength)}},{"./forge":47,"./jsbn":50,"./random":70,"./util":79}],52:[function(a,b,c){var d=a("./forge");a("./util"),b.exports=d.log=d.log||{},d.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},f=[],g=null;d.log.LEVEL_LOCKED=2,d.log.NO_LEVEL_CHECK=4,d.log.INTERPOLATE=8;for(var h=0;h<d.log.levels.length;++h){var i=d.log.levels[h];e[i]={index:h,name:i.toUpperCase()}}d.log.logMessage=function(a){for(var b=e[a.level].index,c=0;c<f.length;++c){var g=f[c];if(g.flags&d.log.NO_LEVEL_CHECK)g.f(a);else{var h=e[g.level].index;b<=h&&g.f(g,a)}}},d.log.prepareStandard=function(a){"standard"in a||(a.standard=e[a.level].name+" ["+a.category+"] "+a.message)},d.log.prepareFull=function(a){if(!("full"in a)){var b=[a.message];b=b.concat([]||a.arguments),a.full=d.util.format.apply(this,b)}},d.log.prepareStandardFull=function(a){"standardFull"in a||(d.log.prepareStandard(a),a.standardFull=a.standard)};for(var j=["error","warning","info","debug","verbose"],h=0;h<j.length;++h)!function(a){d.log[a]=function(b,c){var e=Array.prototype.slice.call(arguments).slice(2),f={timestamp:new Date,level:a,category:b,message:c,arguments:e};d.log.logMessage(f)}}(j[h]);if(d.log.makeLogger=function(a){var b={flags:0,f:a};return d.log.setLevel(b,"none"),b},d.log.setLevel=function(a,b){var c=!1;if(a&&!(a.flags&d.log.LEVEL_LOCKED))for(var e=0;e<d.log.levels.length;++e){var f=d.log.levels[e];if(b==f){a.level=b,c=!0;break}}return c},d.log.lock=function(a,b){"undefined"==typeof b||b?a.flags|=d.log.LEVEL_LOCKED:a.flags&=~d.log.LEVEL_LOCKED},d.log.addLogger=function(a){f.push(a)},"undefined"!=typeof console&&"log"in console){var k;if(console.error&&console.warn&&console.info&&console.debug){var l={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},m=function(a,b){d.log.prepareStandard(b);var c=l[b.level],e=[b.standard];e=e.concat(b.arguments.slice()),c.apply(console,e)};k=d.log.makeLogger(m)}else{var m=function(a,b){d.log.prepareStandardFull(b),console.log(b.standardFull)};k=d.log.makeLogger(m)}d.log.setLevel(k,"debug"),d.log.addLogger(k),g=k}else console={log:function(){}};if(null!==g){var n=d.util.getQueryVariables();if("console.level"in n&&d.log.setLevel(g,n["console.level"].slice(-1)[0]),"console.lock"in n){var o=n["console.lock"].slice(-1)[0];"true"==o&&d.log.lock(g)}}d.log.consoleLogger=g},{"./forge":47,"./util":79}],53:[function(a,b,c){b.exports=a("./md"),a("./md5"),a("./sha1"),a("./sha256"),a("./sha512")},{"./md":54,"./md5":55,"./sha1":73,"./sha256":74,"./sha512":75}],54:[function(a,b,c){var d=a("./forge");b.exports=d.md=d.md||{},d.md.algorithms=d.md.algorithms||{}},{"./forge":47}],55:[function(a,b,c){function d(){h=String.fromCharCode(128),h+=f.util.fillString(String.fromCharCode(0),64),i=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],j=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],k=new Array(64);for(var a=0;a<64;++a)k[a]=Math.floor(4294967296*Math.abs(Math.sin(a+1)));l=!0}function e(a,b,c){for(var d,e,f,g,h,l,m,n,o=c.length();o>=64;){for(e=a.h0,f=a.h1,g=a.h2,h=a.h3,n=0;n<16;++n)b[n]=c.getInt32Le(),l=h^f&(g^h),d=e+l+k[n]+b[n],m=j[n],e=h,h=g,g=f,f+=d<<m|d>>>32-m;for(;n<32;++n)l=g^h&(f^g),d=e+l+k[n]+b[i[n]],m=j[n],e=h,h=g,g=f,f+=d<<m|d>>>32-m;for(;n<48;++n)l=f^g^h,d=e+l+k[n]+b[i[n]],m=j[n],e=h,h=g,g=f,f+=d<<m|d>>>32-m;for(;n<64;++n)l=g^(f|~h),d=e+l+k[n]+b[i[n]],m=j[n],e=h,h=g,g=f,f+=d<<m|d>>>32-m;a.h0=a.h0+e|0,a.h1=a.h1+f|0,a.h2=a.h2+g|0,a.h3=a.h3+h|0,o-=64}}var f=a("./forge");a("./md"),a("./util");var g=b.exports=f.md5=f.md5||{};f.md.md5=f.md.algorithms.md5=g,g.create=function(){l||d();var a=null,b=f.util.createBuffer(),c=new Array(16),g={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return g.start=function(){g.messageLength=0,g.fullMessageLength=g.messageLength64=[];for(var c=g.messageLengthSize/4,d=0;d<c;++d)g.fullMessageLength.push(0);return b=f.util.createBuffer(),a={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},g},g.start(),g.update=function(d,h){"utf8"===h&&(d=f.util.encodeUtf8(d));var i=d.length;g.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var j=g.fullMessageLength.length-1;j>=0;--j)g.fullMessageLength[j]+=i[1],i[1]=i[0]+(g.fullMessageLength[j]/4294967296>>>0),g.fullMessageLength[j]=g.fullMessageLength[j]>>>0,i[0]=i[1]/4294967296>>>0;return b.putBytes(d),e(a,c,b),(b.read>2048||0===b.length())&&b.compact(),g},g.digest=function(){var d=f.util.createBuffer();d.putBytes(b.bytes());var i=g.fullMessageLength[g.fullMessageLength.length-1]+g.messageLengthSize,j=i&g.blockLength-1;d.putBytes(h.substr(0,g.blockLength-j));for(var k,l=0,m=g.fullMessageLength.length-1;m>=0;--m)k=8*g.fullMessageLength[m]+l,l=k/4294967296>>>0,d.putInt32Le(k>>>0);var n={h0:a.h0,h1:a.h1,h2:a.h2,h3:a.h3};e(n,c,d);var o=f.util.createBuffer();return o.putInt32Le(n.h0),o.putInt32Le(n.h1),o.putInt32Le(n.h2),o.putInt32Le(n.h3),o},g};var h=null,i=null,j=null,k=null,l=!1},{"./forge":47,"./md":54,"./util":79}],56:[function(a,b,c){var d=a("./forge");a("./mgf1"),b.exports=d.mgf=d.mgf||{},d.mgf.mgf1=d.mgf1},{"./forge":47,"./mgf1":57}],57:[function(a,b,c){var d=a("./forge");a("./util"),d.mgf=d.mgf||{};var e=b.exports=d.mgf.mgf1=d.mgf1=d.mgf1||{};e.create=function(a){var b={generate:function(b,c){for(var e=new d.util.ByteBuffer,f=Math.ceil(c/a.digestLength),g=0;g<f;g++){var h=new d.util.ByteBuffer;h.putInt32(g),a.start(),a.update(b+h.getBytes()),e.putBuffer(a.digest())}return e.truncate(e.length()-c),e.getBytes()}};return b}},{"./forge":47,"./util":79}],58:[function(a,b,c){function d(a,b){g[a]=b,g[b]=a}function e(a,b){g[a]=b}var f=a("./forge");f.pki=f.pki||{};var g=b.exports=f.pki.oids=f.oids=f.oids||{};d("1.2.840.113549.1.1.1","rsaEncryption"),d("1.2.840.113549.1.1.4","md5WithRSAEncryption"),d("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),d("1.2.840.113549.1.1.7","RSAES-OAEP"),d("1.2.840.113549.1.1.8","mgf1"),d("1.2.840.113549.1.1.9","pSpecified"),d("1.2.840.113549.1.1.10","RSASSA-PSS"),d("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),d("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),d("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),d("1.3.101.112","EdDSA25519"),d("1.2.840.10040.4.3","dsa-with-sha1"),d("1.3.14.3.2.7","desCBC"),d("1.3.14.3.2.26","sha1"),d("2.16.840.1.101.3.4.2.1","sha256"),d("2.16.840.1.101.3.4.2.2","sha384"),d("2.16.840.1.101.3.4.2.3","sha512"),d("1.2.840.113549.2.5","md5"),d("1.2.840.113549.1.7.1","data"),d("1.2.840.113549.1.7.2","signedData"),d("1.2.840.113549.1.7.3","envelopedData"),d("1.2.840.113549.1.7.4","signedAndEnvelopedData"),d("1.2.840.113549.1.7.5","digestedData"),d("1.2.840.113549.1.7.6","encryptedData"),d("1.2.840.113549.1.9.1","emailAddress"),d("1.2.840.113549.1.9.2","unstructuredName"),d("1.2.840.113549.1.9.3","contentType"),d("1.2.840.113549.1.9.4","messageDigest"),d("1.2.840.113549.1.9.5","signingTime"),d("1.2.840.113549.1.9.6","counterSignature"),d("1.2.840.113549.1.9.7","challengePassword"),d("1.2.840.113549.1.9.8","unstructuredAddress"),d("1.2.840.113549.1.9.14","extensionRequest"),d("1.2.840.113549.1.9.20","friendlyName"),d("1.2.840.113549.1.9.21","localKeyId"),d("1.2.840.113549.1.9.22.1","x509Certificate"),d("1.2.840.113549.1.12.10.1.1","keyBag"),d("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),d("1.2.840.113549.1.12.10.1.3","certBag"),d("1.2.840.113549.1.12.10.1.4","crlBag"),d("1.2.840.113549.1.12.10.1.5","secretBag"),d("1.2.840.113549.1.12.10.1.6","safeContentsBag"),d("1.2.840.113549.1.5.13","pkcs5PBES2"),d("1.2.840.113549.1.5.12","pkcs5PBKDF2"),d("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),d("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),d("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),d("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),d("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),d("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),d("1.2.840.113549.2.7","hmacWithSHA1"),d("1.2.840.113549.2.8","hmacWithSHA224"),d("1.2.840.113549.2.9","hmacWithSHA256"),d("1.2.840.113549.2.10","hmacWithSHA384"),d("1.2.840.113549.2.11","hmacWithSHA512"),d("1.2.840.113549.3.7","des-EDE3-CBC"),d("2.16.840.1.101.3.4.1.2","aes128-CBC"),d("2.16.840.1.101.3.4.1.22","aes192-CBC"),d("2.16.840.1.101.3.4.1.42","aes256-CBC"),d("2.5.4.3","commonName"),d("2.5.4.5","serialName"),d("2.5.4.6","countryName"),d("2.5.4.7","localityName"),d("2.5.4.8","stateOrProvinceName"),d("2.5.4.9","streetAddress"),d("2.5.4.10","organizationName"),d("2.5.4.11","organizationalUnitName"),d("2.5.4.13","description"),d("2.5.4.15","businessCategory"),d("2.5.4.17","postalCode"),d("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),d("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),d("2.16.840.1.113730.1.1","nsCertType"),d("2.16.840.1.113730.1.13","nsComment"),e("2.5.29.1","authorityKeyIdentifier"),e("2.5.29.2","keyAttributes"),e("2.5.29.3","certificatePolicies"),e("2.5.29.4","keyUsageRestriction"),e("2.5.29.5","policyMapping"),e("2.5.29.6","subtreesConstraint"),e("2.5.29.7","subjectAltName"),e("2.5.29.8","issuerAltName"),e("2.5.29.9","subjectDirectoryAttributes"),e("2.5.29.10","basicConstraints"),e("2.5.29.11","nameConstraints"),e("2.5.29.12","policyConstraints"),e("2.5.29.13","basicConstraints"),d("2.5.29.14","subjectKeyIdentifier"),d("2.5.29.15","keyUsage"),e("2.5.29.16","privateKeyUsagePeriod"),d("2.5.29.17","subjectAltName"),d("2.5.29.18","issuerAltName"),d("2.5.29.19","basicConstraints"),e("2.5.29.20","cRLNumber"),e("2.5.29.21","cRLReason"),e("2.5.29.22","expirationDate"),e("2.5.29.23","instructionCode"),e("2.5.29.24","invalidityDate"),e("2.5.29.25","cRLDistributionPoints"),e("2.5.29.26","issuingDistributionPoint"),e("2.5.29.27","deltaCRLIndicator"),e("2.5.29.28","issuingDistributionPoint"),e("2.5.29.29","certificateIssuer"),e("2.5.29.30","nameConstraints"),d("2.5.29.31","cRLDistributionPoints"),d("2.5.29.32","certificatePolicies"),e("2.5.29.33","policyMappings"),e("2.5.29.34","policyConstraints"),d("2.5.29.35","authorityKeyIdentifier"),e("2.5.29.36","policyConstraints"),d("2.5.29.37","extKeyUsage"),e("2.5.29.46","freshestCRL"),e("2.5.29.54","inhibitAnyPolicy"),d("1.3.6.1.4.1.11129.2.4.2","timestampList"),d("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),d("1.3.6.1.5.5.7.3.1","serverAuth"),d("1.3.6.1.5.5.7.3.2","clientAuth"),d("1.3.6.1.5.5.7.3.3","codeSigning"),d("1.3.6.1.5.5.7.3.4","emailProtection"),d("1.3.6.1.5.5.7.3.8","timeStamping")},{"./forge":47}],59:[function(a,b,c){function d(a,b){return a.start().update(b).digest().getBytes()}function e(a){var b;if(a){if(b=k.oids[j.derToOid(a)],!b){var c=new Error("Unsupported PRF OID.");throw c.oid=a,c.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],c}}else b="hmacWithSHA1";return f(b)}function f(a){var b=h.md;switch(a){case"hmacWithSHA224":b=h.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":a=a.substr(8).toLowerCase();break;default:var c=new Error("Unsupported PRF algorithm.");throw c.algorithm=a,c.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],c}if(!(b&&a in b))throw new Error("Unknown hash algorithm: "+a);return b[a].create()}function g(a,b,c,d){var e=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,a),j.create(j.Class.UNIVERSAL,j.Type.INTEGER,!1,b.getBytes())]);return"hmacWithSHA1"!==d&&e.value.push(j.create(j.Class.UNIVERSAL,j.Type.INTEGER,!1,h.util.hexToBytes(c.toString(16))),j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(k.oids[d]).getBytes()),j.create(j.Class.UNIVERSAL,j.Type.NULL,!1,"")])),e}var h=a("./forge");if(a("./aes"),a("./asn1"),a("./des"),a("./md"),a("./oids"),a("./pbkdf2"),a("./pem"),a("./random"),a("./rc2"),a("./rsa"),a("./util"),"undefined"==typeof i)var i=h.jsbn.BigInteger;var j=h.asn1,k=h.pki=h.pki||{};b.exports=k.pbe=h.pbe=h.pbe||{};var l=k.oids,m={name:"EncryptedPrivateKeyInfo",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},n={name:"PBES2Algorithms",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},o={name:"pkcs-12PbeParams",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"iterations"}]};k.encryptPrivateKeyInfo=function(a,b,c){c=c||{},c.saltSize=c.saltSize||8,c.count=c.count||2048,c.algorithm=c.algorithm||"aes128",c.prfAlgorithm=c.prfAlgorithm||"sha1";var d,e,i,m=h.random.getBytesSync(c.saltSize),n=c.count,o=j.integerToDer(n);if(0===c.algorithm.indexOf("aes")||"des"===c.algorithm){var p,q,r;switch(c.algorithm){case"aes128":d=16,p=16,q=l["aes128-CBC"],r=h.aes.createEncryptionCipher;break;case"aes192":d=24,p=16,q=l["aes192-CBC"],r=h.aes.createEncryptionCipher;break;case"aes256":d=32,p=16,q=l["aes256-CBC"],r=h.aes.createEncryptionCipher;break;case"des":d=8,p=8,q=l.desCBC,r=h.des.createEncryptionCipher;break;default:var s=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw s.algorithm=c.algorithm,s}var t="hmacWith"+c.prfAlgorithm.toUpperCase(),u=f(t),v=h.pkcs5.pbkdf2(b,m,n,d,u),w=h.random.getBytesSync(p),x=r(v);x.start(w),x.update(j.toDer(a)),x.finish(),i=x.output.getBytes();var y=g(m,o,d,t);e=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(l.pkcs5PBES2).getBytes()),j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(l.pkcs5PBKDF2).getBytes()),y]),j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(q).getBytes()),j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,w)])])])}else{if("3des"!==c.algorithm){var s=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw s.algorithm=c.algorithm,s}d=24;var z=new h.util.ByteBuffer(m),v=k.pbe.generatePkcs12Key(b,z,1,n,d),w=k.pbe.generatePkcs12Key(b,z,2,n,d),x=h.des.createEncryptionCipher(v);x.start(w),x.update(j.toDer(a)),x.finish(),i=x.output.getBytes(),e=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(l["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,m),j.create(j.Class.UNIVERSAL,j.Type.INTEGER,!1,o.getBytes())])])}var A=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[e,j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,i)]);return A},k.decryptPrivateKeyInfo=function(a,b){var c=null,d={},e=[];if(!j.validate(a,m,d,e)){var f=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw f.errors=e,f}var g=j.derToOid(d.encryptionOid),i=k.pbe.getCipher(g,d.encryptionParams,b),l=h.util.createBuffer(d.encryptedData);return i.update(l),i.finish()&&(c=j.fromDer(i.output)),c},k.encryptedPrivateKeyToPem=function(a,b){var c={type:"ENCRYPTED PRIVATE KEY",body:j.toDer(a).getBytes()};return h.pem.encode(c,{maxline:b})},k.encryptedPrivateKeyFromPem=function(a){var b=h.pem.decode(a)[0];if("ENCRYPTED PRIVATE KEY"!==b.type){var c=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw c.headerType=b.type,c}if(b.procType&&"ENCRYPTED"===b.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return j.fromDer(b.body)},k.encryptRsaPrivateKey=function(a,b,c){if(c=c||{},!c.legacy){var d=k.wrapRsaPrivateKey(k.privateKeyToAsn1(a));return d=k.encryptPrivateKeyInfo(d,b,c),k.encryptedPrivateKeyToPem(d)}var e,f,g,i;switch(c.algorithm){case"aes128":e="AES-128-CBC",g=16,f=h.random.getBytesSync(16),i=h.aes.createEncryptionCipher;break;case"aes192":e="AES-192-CBC",g=24,f=h.random.getBytesSync(16),i=h.aes.createEncryptionCipher;break;case"aes256":e="AES-256-CBC",g=32,f=h.random.getBytesSync(16),i=h.aes.createEncryptionCipher;break;case"3des":e="DES-EDE3-CBC",g=24,f=h.random.getBytesSync(8),i=h.des.createEncryptionCipher;break;case"des":e="DES-CBC",g=8,f=h.random.getBytesSync(8),i=h.des.createEncryptionCipher;break;default:var l=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+c.algorithm+'".');throw l.algorithm=c.algorithm,l}var m=h.pbe.opensslDeriveBytes(b,f.substr(0,8),g),n=i(m);n.start(f),n.update(j.toDer(k.privateKeyToAsn1(a))),n.finish();var o={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:e,parameters:h.util.bytesToHex(f).toUpperCase()},body:n.output.getBytes()};return h.pem.encode(o)},k.decryptRsaPrivateKey=function(a,b){var c=null,d=h.pem.decode(a)[0];if("ENCRYPTED PRIVATE KEY"!==d.type&&"PRIVATE KEY"!==d.type&&"RSA PRIVATE KEY"!==d.type){var e=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw e.headerType=e,e}if(d.procType&&"ENCRYPTED"===d.procType.type){var f,g;switch(d.dekInfo.algorithm){case"DES-CBC":f=8,g=h.des.createDecryptionCipher;break;case"DES-EDE3-CBC":f=24,g=h.des.createDecryptionCipher;break;case"AES-128-CBC":f=16,g=h.aes.createDecryptionCipher;break;case"AES-192-CBC":f=24,g=h.aes.createDecryptionCipher;break;case"AES-256-CBC":f=32,g=h.aes.createDecryptionCipher;break;case"RC2-40-CBC":f=5,g=function(a){return h.rc2.createDecryptionCipher(a,40)};break;case"RC2-64-CBC":f=8,g=function(a){return h.rc2.createDecryptionCipher(a,64)};break;case"RC2-128-CBC":f=16,g=function(a){return h.rc2.createDecryptionCipher(a,128)};break;default:var e=new Error('Could not decrypt private key; unsupported encryption algorithm "'+d.dekInfo.algorithm+'".');throw e.algorithm=d.dekInfo.algorithm,e}var i=h.util.hexToBytes(d.dekInfo.parameters),l=h.pbe.opensslDeriveBytes(b,i.substr(0,8),f),m=g(l);if(m.start(i),m.update(h.util.createBuffer(d.body)),!m.finish())return c;c=m.output.getBytes()}else c=d.body;return c="ENCRYPTED PRIVATE KEY"===d.type?k.decryptPrivateKeyInfo(j.fromDer(c),b):j.fromDer(c),null!==c&&(c=k.privateKeyFromAsn1(c)),c},k.pbe.generatePkcs12Key=function(a,b,c,d,e,f){var g,i;if("undefined"==typeof f||null===f){if(!("sha1"in h.md))throw new Error('"sha1" hash algorithm unavailable.');f=h.md.sha1.create()}var j=f.digestLength,k=f.blockLength,l=new h.util.ByteBuffer,m=new h.util.ByteBuffer;if(null!==a&&void 0!==a){for(i=0;i<a.length;i++)m.putInt16(a.charCodeAt(i));m.putInt16(0)}var n=m.length(),o=b.length(),p=new h.util.ByteBuffer;p.fillWithByte(c,k);var q=k*Math.ceil(o/k),r=new h.util.ByteBuffer;for(i=0;i<q;i++)r.putByte(b.at(i%o));var s=k*Math.ceil(n/k),t=new h.util.ByteBuffer;for(i=0;i<s;i++)t.putByte(m.at(i%n));var u=r;u.putBuffer(t);for(var v=Math.ceil(e/j),w=1;w<=v;w++){var x=new h.util.ByteBuffer;x.putBytes(p.bytes()),x.putBytes(u.bytes());for(var y=0;y<d;y++)f.start(),f.update(x.getBytes()),x=f.digest();var z=new h.util.ByteBuffer;for(i=0;i<k;i++)z.putByte(x.at(i%j));var A=Math.ceil(o/k)+Math.ceil(n/k),B=new h.util.ByteBuffer;for(g=0;g<A;g++){var C=new h.util.ByteBuffer(u.getBytes(k)),D=511;for(i=z.length()-1;i>=0;i--)D>>=8,D+=z.at(i)+C.at(i),C.setAt(i,255&D);B.putBuffer(C)}u=B,l.putBuffer(x)}return l.truncate(l.length()-e),l},k.pbe.getCipher=function(a,b,c){switch(a){case k.oids.pkcs5PBES2:return k.pbe.getCipherForPBES2(a,b,c);case k.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case k.oids["pbewithSHAAnd40BitRC2-CBC"]:return k.pbe.getCipherForPKCS12PBE(a,b,c);default:var d=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw d.oid=a,d.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],d}},k.pbe.getCipherForPBES2=function(a,b,c){var d={},f=[];if(!j.validate(b,n,d,f)){var g=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw g.errors=f,g}if(a=j.derToOid(d.kdfOid),a!==k.oids.pkcs5PBKDF2){var g=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw g.oid=a,g.supportedOids=["pkcs5PBKDF2"],g}if(a=j.derToOid(d.encOid),a!==k.oids["aes128-CBC"]&&a!==k.oids["aes192-CBC"]&&a!==k.oids["aes256-CBC"]&&a!==k.oids["des-EDE3-CBC"]&&a!==k.oids.desCBC){var g=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw g.oid=a,g.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],g}var i=d.kdfSalt,l=h.util.createBuffer(d.kdfIterationCount);l=l.getInt(l.length()<<3);var m,o;switch(k.oids[a]){case"aes128-CBC":m=16,o=h.aes.createDecryptionCipher;break;case"aes192-CBC":m=24,o=h.aes.createDecryptionCipher;break;case"aes256-CBC":m=32,o=h.aes.createDecryptionCipher;break;case"des-EDE3-CBC":m=24,o=h.des.createDecryptionCipher;break;case"desCBC":m=8,o=h.des.createDecryptionCipher}var p=e(d.prfOid),q=h.pkcs5.pbkdf2(c,i,l,m,p),r=d.encIv,s=o(q);return s.start(r),s},k.pbe.getCipherForPKCS12PBE=function(a,b,c){var d={},f=[];if(!j.validate(b,o,d,f)){var g=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw g.errors=f,g}var i=h.util.createBuffer(d.salt),l=h.util.createBuffer(d.iterations);l=l.getInt(l.length()<<3);var m,n,p;switch(a){case k.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:m=24,n=8,p=h.des.startDecrypting;break;case k.oids["pbewithSHAAnd40BitRC2-CBC"]:m=5,n=8,p=function(a,b){var c=h.rc2.createDecryptionCipher(a,40);return c.start(b,null),c};break;default:var g=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw g.oid=a,g}var q=e(d.prfOid),r=k.pbe.generatePkcs12Key(c,i,1,l,m,q);q.start();var s=k.pbe.generatePkcs12Key(c,i,2,l,n,q);return p(r,s)},k.pbe.opensslDeriveBytes=function(a,b,c,e){if("undefined"==typeof e||null===e){if(!("md5"in h.md))throw new Error('"md5" hash algorithm unavailable.');e=h.md.md5.create()}null===b&&(b="");for(var f=[d(e,a+b)],g=16,i=1;g<c;++i,g+=16)f.push(d(e,f[i-1]+a+b));return f.join("").substr(0,c)}},{"./aes":37,"./asn1":40,"./des":45,"./forge":47,"./md":54,"./oids":58,"./pbkdf2":60,"./pem":61,"./random":70,"./rc2":71,"./rsa":72,"./util":79}],60:[function(a,b,c){(function(c){
var d=a("./forge");a("./hmac"),a("./md"),a("./util");var e,f=d.pkcs5=d.pkcs5||{};d.util.isNodejs&&!d.options.usePureJavaScript&&(e=a("crypto")),b.exports=d.pbkdf2=f.pbkdf2=function(a,b,f,g,h,i){function j(){return u>n?i(null,t):(p.start(null,null),p.update(b),p.update(d.util.int32ToBytes(u)),q=s=p.digest().getBytes(),v=2,void k())}function k(){return v<=f?(p.start(null,null),p.update(s),r=p.digest().getBytes(),q=d.util.xorBytes(q,r,l),s=r,++v,d.util.setImmediate(k)):(t+=u<n?q:q.substr(0,o),++u,void j())}if("function"==typeof h&&(i=h,h=null),d.util.isNodejs&&!d.options.usePureJavaScript&&e.pbkdf2&&(null===h||"object"!=typeof h)&&(e.pbkdf2Sync.length>4||!h||"sha1"===h))return"string"!=typeof h&&(h="sha1"),a=c.from(a,"binary"),b=c.from(b,"binary"),i?4===e.pbkdf2Sync.length?e.pbkdf2(a,b,f,g,function(a,b){return a?i(a):void i(null,b.toString("binary"))}):e.pbkdf2(a,b,f,g,h,function(a,b){return a?i(a):void i(null,b.toString("binary"))}):4===e.pbkdf2Sync.length?e.pbkdf2Sync(a,b,f,g).toString("binary"):e.pbkdf2Sync(a,b,f,g,h).toString("binary");if("undefined"!=typeof h&&null!==h||(h="sha1"),"string"==typeof h){if(!(h in d.md.algorithms))throw new Error("Unknown hash algorithm: "+h);h=d.md[h].create()}var l=h.digestLength;if(g>4294967295*l){var m=new Error("Derived key is too long.");if(i)return i(m);throw m}var n=Math.ceil(g/l),o=g-(n-1)*l,p=d.hmac.create();p.start(h,a);var q,r,s,t="";if(!i){for(var u=1;u<=n;++u){p.start(null,null),p.update(b),p.update(d.util.int32ToBytes(u)),q=s=p.digest().getBytes();for(var v=2;v<=f;++v)p.start(null,null),p.update(s),r=p.digest().getBytes(),q=d.util.xorBytes(q,r,l),s=r;t+=u<n?q:q.substr(0,o)}return t}var v,u=1;j()}}).call(this,a("buffer").Buffer)},{"./forge":47,"./hmac":48,"./md":54,"./util":79,buffer:18,crypto:18}],61:[function(a,b,c){function d(a){for(var b=a.name+": ",c=[],d=function(a,b){return" "+b},e=0;e<a.values.length;++e)c.push(a.values[e].replace(/^(\S+\r\n)/,d));b+=c.join(",")+"\r\n";for(var f=0,g=-1,e=0;e<b.length;++e,++f)if(f>65&&g!==-1){var h=b[g];","===h?(++g,b=b.substr(0,g)+"\r\n "+b.substr(g)):b=b.substr(0,g)+"\r\n"+h+b.substr(g+1),f=e-g-1,g=-1,++e}else" "!==b[e]&&"\t"!==b[e]&&","!==b[e]||(g=e);return b}function e(a){return a.replace(/^\s+/,"")}var f=a("./forge");a("./util");var g=b.exports=f.pem=f.pem||{};g.encode=function(a,b){b=b||{};var c,e="-----BEGIN "+a.type+"-----\r\n";if(a.procType&&(c={name:"Proc-Type",values:[String(a.procType.version),a.procType.type]},e+=d(c)),a.contentDomain&&(c={name:"Content-Domain",values:[a.contentDomain]},e+=d(c)),a.dekInfo&&(c={name:"DEK-Info",values:[a.dekInfo.algorithm]},a.dekInfo.parameters&&c.values.push(a.dekInfo.parameters),e+=d(c)),a.headers)for(var g=0;g<a.headers.length;++g)e+=d(a.headers[g]);return a.procType&&(e+="\r\n"),e+=f.util.encode64(a.body,b.maxline||64)+"\r\n",e+="-----END "+a.type+"-----\r\n"},g.decode=function(a){for(var b,c=[],d=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,g=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,h=/\r?\n/;;){if(b=d.exec(a),!b)break;var i={type:b[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:f.util.decode64(b[3])};if(c.push(i),b[2]){for(var j=b[2].split(h),k=0;b&&k<j.length;){for(var l=j[k].replace(/\s+$/,""),m=k+1;m<j.length;++m){var n=j[m];if(!/\s/.test(n[0]))break;l+=n,k=m}if(b=l.match(g)){for(var o={name:b[1],values:[]},p=b[2].split(","),q=0;q<p.length;++q)o.values.push(e(p[q]));if(i.procType)if(i.contentDomain||"Content-Domain"!==o.name)if(i.dekInfo||"DEK-Info"!==o.name)i.headers.push(o);else{if(0===o.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');i.dekInfo={algorithm:p[0],parameters:p[1]||null}}else i.contentDomain=p[0]||"";else{if("Proc-Type"!==o.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==o.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');i.procType={version:p[0],type:p[1]}}}++k}if("ENCRYPTED"===i.procType&&!i.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===c.length)throw new Error("Invalid PEM formatted message.");return c}},{"./forge":47,"./util":79}],62:[function(a,b,c){function d(a,b,c){c||(c=e.md.sha1.create());for(var d="",f=Math.ceil(b/c.digestLength),g=0;g<f;++g){var h=String.fromCharCode(g>>24&255,g>>16&255,g>>8&255,255&g);c.start(),c.update(a+h),d+=c.digest().getBytes()}return d.substring(0,b)}var e=a("./forge");a("./util"),a("./random"),a("./sha1");var f=b.exports=e.pkcs1=e.pkcs1||{};f.encode_rsa_oaep=function(a,b,c){var f,g,h,i;"string"==typeof c?(f=c,g=arguments[3]||void 0,h=arguments[4]||void 0):c&&(f=c.label||void 0,g=c.seed||void 0,h=c.md||void 0,c.mgf1&&c.mgf1.md&&(i=c.mgf1.md)),h?h.start():h=e.md.sha1.create(),i||(i=h);var j=Math.ceil(a.n.bitLength()/8),k=j-2*h.digestLength-2;if(b.length>k){var l=new Error("RSAES-OAEP input message length is too long.");throw l.length=b.length,l.maxLength=k,l}f||(f=""),h.update(f,"raw");for(var m=h.digest(),n="",o=k-b.length,p=0;p<o;p++)n+="\0";var q=m.getBytes()+n+""+b;if(g){if(g.length!==h.digestLength){var l=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw l.seedLength=g.length,l.digestLength=h.digestLength,l}}else g=e.random.getBytes(h.digestLength);var r=d(g,j-h.digestLength-1,i),s=e.util.xorBytes(q,r,q.length),t=d(s,h.digestLength,i),u=e.util.xorBytes(g,t,g.length);return"\0"+u+s},f.decode_rsa_oaep=function(a,b,c){var f,g,h;"string"==typeof c?(f=c,g=arguments[3]||void 0):c&&(f=c.label||void 0,g=c.md||void 0,c.mgf1&&c.mgf1.md&&(h=c.mgf1.md));var i=Math.ceil(a.n.bitLength()/8);if(b.length!==i){var j=new Error("RSAES-OAEP encoded message length is invalid.");throw j.length=b.length,j.expectedLength=i,j}if(void 0===g?g=e.md.sha1.create():g.start(),h||(h=g),i<2*g.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");f||(f=""),g.update(f,"raw");for(var k=g.digest().getBytes(),l=b.charAt(0),m=b.substring(1,g.digestLength+1),n=b.substring(1+g.digestLength),o=d(n,g.digestLength,h),p=e.util.xorBytes(m,o,m.length),q=d(p,i-g.digestLength-1,h),r=e.util.xorBytes(n,q,n.length),s=r.substring(0,g.digestLength),j="\0"!==l,t=0;t<g.digestLength;++t)j|=k.charAt(t)!==s.charAt(t);for(var u=1,v=g.digestLength,w=g.digestLength;w<r.length;w++){var x=r.charCodeAt(w),y=1&x^1,z=u?65534:0;j|=x&z,u&=y,v+=u}if(j||1!==r.charCodeAt(v))throw new Error("Invalid RSAES-OAEP padding.");return r.substring(v+1)}},{"./forge":47,"./random":70,"./sha1":73,"./util":79}],63:[function(a,b,c){function d(a,b,c,d){for(var e=[],f=0;f<a.length;f++)for(var g=0;g<a[f].safeBags.length;g++){var h=a[f].safeBags[g];void 0!==d&&h.type!==d||(null!==b?void 0!==h.attributes[b]&&h.attributes[b].indexOf(c)>=0&&e.push(h):e.push(h))}return e}function e(a){if(a.composed||a.constructed){for(var b=j.util.createBuffer(),c=0;c<a.value.length;++c)b.putBytes(a.value[c].value);a.composed=a.constructed=!1,a.value=b.getBytes()}return a}function f(a,b,c,d){if(b=k.fromDer(b,c),b.tagClass!==k.Class.UNIVERSAL||b.type!==k.Type.SEQUENCE||b.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var f=0;f<b.value.length;f++){var i=b.value[f],j={},m=[];if(!k.validate(i,n,j,m)){var o=new Error("Cannot read ContentInfo.");throw o.errors=m,o}var p={encrypted:!1},q=null,r=j.content.value[0];switch(k.derToOid(j.contentType)){case l.oids.data:if(r.tagClass!==k.Class.UNIVERSAL||r.type!==k.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");q=e(r).value;break;case l.oids.encryptedData:q=g(r,d),p.encrypted=!0;break;default:var o=new Error("Unsupported PKCS#12 contentType.");throw o.contentType=k.derToOid(j.contentType),o}p.safeBags=h(q,c,d),a.safeContents.push(p)}}function g(a,b){var c={},d=[];if(!k.validate(a,j.pkcs7.asn1.encryptedDataValidator,c,d)){var f=new Error("Cannot read EncryptedContentInfo.");throw f.errors=d,f}var g=k.derToOid(c.contentType);if(g!==l.oids.data){var f=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw f.oid=g,f}g=k.derToOid(c.encAlgorithm);var h=l.pbe.getCipher(g,c.encParameter,b),i=e(c.encryptedContentAsn1),m=j.util.createBuffer(i.value);if(h.update(m),!h.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return h.output.getBytes()}function h(a,b,c){if(!b&&0===a.length)return[];if(a=k.fromDer(a,b),a.tagClass!==k.Class.UNIVERSAL||a.type!==k.Type.SEQUENCE||a.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var d=[],e=0;e<a.value.length;e++){var f=a.value[e],g={},h=[];if(!k.validate(f,p,g,h)){var j=new Error("Cannot read SafeBag.");throw j.errors=h,j}var m={type:k.derToOid(g.bagId),attributes:i(g.bagAttributes)};d.push(m);var n,o,q=g.bagValue.value[0];switch(m.type){case l.oids.pkcs8ShroudedKeyBag:if(q=l.decryptPrivateKeyInfo(q,c),null===q)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case l.oids.keyBag:try{m.key=l.privateKeyFromAsn1(q)}catch(s){m.key=null,m.asn1=q}continue;case l.oids.certBag:n=r,o=function(){if(k.derToOid(g.certId)!==l.oids.x509Certificate){var a=new Error("Unsupported certificate type, only X.509 supported.");throw a.oid=k.derToOid(g.certId),a}var c=k.fromDer(g.cert,b);try{m.cert=l.certificateFromAsn1(c,!0)}catch(d){m.cert=null,m.asn1=c}};break;default:var j=new Error("Unsupported PKCS#12 SafeBag type.");throw j.oid=m.type,j}if(void 0!==n&&!k.validate(q,n,g,h)){var j=new Error("Cannot read PKCS#12 "+n.name);throw j.errors=h,j}o()}return d}function i(a){var b={};if(void 0!==a)for(var c=0;c<a.length;++c){var d={},e=[];if(!k.validate(a[c],q,d,e)){var f=new Error("Cannot read PKCS#12 BagAttribute.");throw f.errors=e,f}var g=k.derToOid(d.oid);if(void 0!==l.oids[g]){b[l.oids[g]]=[];for(var h=0;h<d.values.length;++h)b[l.oids[g]].push(d.values[h].value)}}return b}var j=a("./forge");a("./asn1"),a("./hmac"),a("./oids"),a("./pkcs7asn1"),a("./pbe"),a("./random"),a("./rsa"),a("./sha1"),a("./util"),a("./x509");var k=j.asn1,l=j.pki,m=b.exports=j.pkcs12=j.pkcs12||{},n={name:"ContentInfo",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:k.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},o={name:"PFX",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,constructed:!1,capture:"version"},n,{name:"PFX.macData",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:k.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:k.Class.UNIVERSAL,type:k.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:k.Class.UNIVERSAL,type:k.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},p={name:"SafeBag",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:k.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:k.Class.UNIVERSAL,type:k.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},q={name:"Attribute",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:k.Class.UNIVERSAL,type:k.Type.SET,constructed:!0,capture:"values"}]},r={name:"CertBag",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:k.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:k.Class.UNIVERSAL,type:k.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};m.pkcs12FromAsn1=function(a,b,c){"string"==typeof b?(c=b,b=!0):void 0===b&&(b=!0);var g={},h=[];if(!k.validate(a,o,g,h)){var i=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw i.errors=i,i}var n={version:g.version.charCodeAt(0),safeContents:[],getBags:function(a){var b,c={};return"localKeyId"in a?b=a.localKeyId:"localKeyIdHex"in a&&(b=j.util.hexToBytes(a.localKeyIdHex)),void 0===b&&!("friendlyName"in a)&&"bagType"in a&&(c[a.bagType]=d(n.safeContents,null,null,a.bagType)),void 0!==b&&(c.localKeyId=d(n.safeContents,"localKeyId",b,a.bagType)),"friendlyName"in a&&(c.friendlyName=d(n.safeContents,"friendlyName",a.friendlyName,a.bagType)),c},getBagsByFriendlyName:function(a,b){return d(n.safeContents,"friendlyName",a,b)},getBagsByLocalKeyId:function(a,b){return d(n.safeContents,"localKeyId",a,b)}};if(3!==g.version.charCodeAt(0)){var i=new Error("PKCS#12 PFX of version other than 3 not supported.");throw i.version=g.version.charCodeAt(0),i}if(k.derToOid(g.contentType)!==l.oids.data){var i=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw i.oid=k.derToOid(g.contentType),i}var p=g.content.value[0];if(p.tagClass!==k.Class.UNIVERSAL||p.type!==k.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(p=e(p),g.mac){var q=null,r=0,s=k.derToOid(g.macAlgorithm);switch(s){case l.oids.sha1:q=j.md.sha1.create(),r=20;break;case l.oids.sha256:q=j.md.sha256.create(),r=32;break;case l.oids.sha384:q=j.md.sha384.create(),r=48;break;case l.oids.sha512:q=j.md.sha512.create(),r=64;break;case l.oids.md5:q=j.md.md5.create(),r=16}if(null===q)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+s);var t=new j.util.ByteBuffer(g.macSalt),u="macIterations"in g?parseInt(j.util.bytesToHex(g.macIterations),16):1,v=m.generateKey(c,t,3,u,r,q),w=j.hmac.create();w.start(q,v),w.update(p.value);var x=w.getMac();if(x.getBytes()!==g.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return f(n,p.value,b,c),n},m.toPkcs12Asn1=function(a,b,c,d){d=d||{},d.saltSize=d.saltSize||8,d.count=d.count||2048,d.algorithm=d.algorithm||d.encAlgorithm||"aes128","useMac"in d||(d.useMac=!0),"localKeyId"in d||(d.localKeyId=null),"generateLocalKeyId"in d||(d.generateLocalKeyId=!0);var e,f=d.localKeyId;if(null!==f)f=j.util.hexToBytes(f);else if(d.generateLocalKeyId)if(b){var g=j.util.isArray(b)?b[0]:b;"string"==typeof g&&(g=l.certificateFromPem(g));var h=j.md.sha1.create();h.update(k.toDer(l.certificateToAsn1(g)).getBytes()),f=h.digest().getBytes()}else f=j.random.getBytes(20);var i=[];null!==f&&i.push(k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(l.oids.localKeyId).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.SET,!0,[k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,f)])])),"friendlyName"in d&&i.push(k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(l.oids.friendlyName).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.SET,!0,[k.create(k.Class.UNIVERSAL,k.Type.BMPSTRING,!1,d.friendlyName)])])),i.length>0&&(e=k.create(k.Class.UNIVERSAL,k.Type.SET,!0,i));var n=[],o=[];null!==b&&(o=j.util.isArray(b)?b:[b]);for(var p=[],q=0;q<o.length;++q){b=o[q],"string"==typeof b&&(b=l.certificateFromPem(b));var r=0===q?e:void 0,s=l.certificateToAsn1(b),t=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(l.oids.certBag).getBytes()),k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(l.oids.x509Certificate).getBytes()),k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,k.toDer(s).getBytes())])])]),r]);p.push(t)}if(p.length>0){var u=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,p),v=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(l.oids.data).getBytes()),k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,k.toDer(u).getBytes())])]);n.push(v)}var w=null;if(null!==a){var x=l.wrapRsaPrivateKey(l.privateKeyToAsn1(a));w=null===c?k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(l.oids.keyBag).getBytes()),k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[x]),e]):k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(l.oids.pkcs8ShroudedKeyBag).getBytes()),k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[l.encryptPrivateKeyInfo(x,c,d)]),e]);var y=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[w]),z=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(l.oids.data).getBytes()),k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,k.toDer(y).getBytes())])]);n.push(z)}var A,B=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,n);if(d.useMac){var h=j.md.sha1.create(),C=new j.util.ByteBuffer(j.random.getBytes(d.saltSize)),D=d.count,a=m.generateKey(c,C,3,D,20),E=j.hmac.create();E.start(h,a),E.update(k.toDer(B).getBytes());var F=E.getMac();A=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(l.oids.sha1).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.NULL,!1,"")]),k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,F.getBytes())]),k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,C.getBytes()),k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,k.integerToDer(D).getBytes())])}return k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,k.integerToDer(3).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(l.oids.data).getBytes()),k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,k.toDer(B).getBytes())])]),A])},m.generateKey=j.pbe.generatePkcs12Key},{"./asn1":40,"./forge":47,"./hmac":48,"./oids":58,"./pbe":59,"./pkcs7asn1":65,"./random":70,"./rsa":72,"./sha1":73,"./util":79,"./x509":80}],64:[function(a,b,c){function d(a){var b={},c=[];if(!o.validate(a,p.asn1.recipientInfoValidator,b,c)){var d=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw d.errors=c,d}return{version:b.version.charCodeAt(0),issuer:n.pki.RDNAttributesAsArray(b.issuer),serialNumber:n.util.createBuffer(b.serial).toHex(),encryptedContent:{algorithm:o.derToOid(b.encAlgorithm),parameter:b.encParameter.value,content:b.encKey}}}function e(a){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(a.version).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:a.issuer}),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n.util.hexToBytes(a.serialNumber))]),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.encryptedContent.algorithm).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,a.encryptedContent.content)])}function f(a){for(var b=[],c=0;c<a.length;++c)b.push(d(a[c]));return b}function g(a){for(var b=[],c=0;c<a.length;++c)b.push(e(a[c]));return b}function h(a){var b=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(a.version).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:a.issuer}),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n.util.hexToBytes(a.serialNumber))]),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.digestAlgorithm).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")])]);if(a.authenticatedAttributesAsn1&&b.value.push(a.authenticatedAttributesAsn1),b.value.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.signatureAlgorithm).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")])),b.value.push(o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,a.signature)),a.unauthenticatedAttributes.length>0){for(var c=o.create(o.Class.CONTEXT_SPECIFIC,1,!0,[]),d=0;d<a.unauthenticatedAttributes.length;++d){var e=a.unauthenticatedAttributes[d];c.values.push(j(e))}b.value.push(c)}return b}function i(a){for(var b=[],c=0;c<a.length;++c)b.push(h(a[c]));return b}function j(a){var b;if(a.type===n.pki.oids.contentType)b=o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.value).getBytes());else if(a.type===n.pki.oids.messageDigest)b=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,a.value.bytes());else if(a.type===n.pki.oids.signingTime){var c=new Date("1950-01-01T00:00:00Z"),d=new Date("2050-01-01T00:00:00Z"),e=a.value;if("string"==typeof e){var f=Date.parse(e);e=isNaN(f)?13===e.length?o.utcTimeToDate(e):o.generalizedTimeToDate(e):new Date(f)}b=e>=c&&e<d?o.create(o.Class.UNIVERSAL,o.Type.UTCTIME,!1,o.dateToUtcTime(e)):o.create(o.Class.UNIVERSAL,o.Type.GENERALIZEDTIME,!1,o.dateToGeneralizedTime(e))}return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.type).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[b])])}function k(a){return[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(n.pki.oids.data).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.algorithm).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,a.parameter.getBytes())]),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,a.content.getBytes())])]}function l(a,b,c){var d={},e=[];if(!o.validate(b,c,d,e)){var f=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw f.errors=f,f}var g=o.derToOid(d.contentType);if(g!==n.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(d.encryptedContent){var h="";if(n.util.isArray(d.encryptedContent))for(var i=0;i<d.encryptedContent.length;++i){if(d.encryptedContent[i].type!==o.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");h+=d.encryptedContent[i].value}else h=d.encryptedContent;a.encryptedContent={algorithm:o.derToOid(d.encAlgorithm),parameter:n.util.createBuffer(d.encParameter.value),content:n.util.createBuffer(h)}}if(d.content){var h="";if(n.util.isArray(d.content))for(var i=0;i<d.content.length;++i){if(d.content[i].type!==o.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");h+=d.content[i].value}else h=d.content;a.content=n.util.createBuffer(h)}return a.version=d.version.charCodeAt(0),a.rawCapture=d,d}function m(a){if(void 0===a.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===a.content){var b;switch(a.encryptedContent.algorithm){case n.pki.oids["aes128-CBC"]:case n.pki.oids["aes192-CBC"]:case n.pki.oids["aes256-CBC"]:b=n.aes.createDecryptionCipher(a.encryptedContent.key);break;case n.pki.oids.desCBC:case n.pki.oids["des-EDE3-CBC"]:b=n.des.createDecryptionCipher(a.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+a.encryptedContent.algorithm)}if(b.start(a.encryptedContent.parameter),b.update(a.encryptedContent.content),!b.finish())throw new Error("Symmetric decryption failed.");a.content=b.output}}var n=a("./forge");a("./aes"),a("./asn1"),a("./des"),a("./oids"),a("./pem"),a("./pkcs7asn1"),a("./random"),a("./util"),a("./x509");var o=n.asn1,p=b.exports=n.pkcs7=n.pkcs7||{};p.messageFromPem=function(a){var b=n.pem.decode(a)[0];if("PKCS7"!==b.type){var c=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw c.headerType=b.type,c}if(b.procType&&"ENCRYPTED"===b.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var d=o.fromDer(b.body);return p.messageFromAsn1(d)},p.messageToPem=function(a,b){var c={type:"PKCS7",body:o.toDer(a.toAsn1()).getBytes()};return n.pem.encode(c,{maxline:b})},p.messageFromAsn1=function(a){var b={},c=[];if(!o.validate(a,p.asn1.contentInfoValidator,b,c)){var d=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw d.errors=c,d}var e,f=o.derToOid(b.contentType);switch(f){case n.pki.oids.envelopedData:e=p.createEnvelopedData();break;case n.pki.oids.encryptedData:e=p.createEncryptedData();break;case n.pki.oids.signedData:e=p.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+f+" is not (yet) supported.")}return e.fromAsn1(b.content.value[0]),e},p.createSignedData=function(){function a(){for(var a={},b=0;b<c.signers.length;++b){var d=c.signers[b],e=d.digestAlgorithm;e in a||(a[e]=n.md[n.pki.oids[e]].create()),0===d.authenticatedAttributes.length?d.md=a[e]:d.md=n.md[n.pki.oids[e]].create()}c.digestAlgorithmIdentifiers=[];for(var e in a)c.digestAlgorithmIdentifiers.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(e).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]));return a}function b(a){var b;if(c.detachedContent?b=c.detachedContent:(b=c.contentInfo.value[1],b=b.value[0]),!b)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var d=o.derToOid(c.contentInfo.value[0].value),e=o.toDer(b);e.getByte(),o.getBerValueLength(e),e=e.getBytes();for(var f in a)a[f].start().update(e);for(var g=new Date,h=0;h<c.signers.length;++h){var k=c.signers[h];if(0===k.authenticatedAttributes.length){if(d!==n.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{k.authenticatedAttributesAsn1=o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var l=o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[]),m=0;m<k.authenticatedAttributes.length;++m){var p=k.authenticatedAttributes[m];p.type===n.pki.oids.messageDigest?p.value=a[k.digestAlgorithm].digest():p.type===n.pki.oids.signingTime&&(p.value||(p.value=g)),l.value.push(j(p)),k.authenticatedAttributesAsn1.value.push(j(p))}e=o.toDer(l).getBytes(),k.md.start().update(e)}k.signature=k.key.sign(k.md,"RSASSA-PKCS1-V1_5")}c.signerInfos=i(c.signers)}var c=null;return c={type:n.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(a){if(l(c,a,p.asn1.signedDataValidator),c.certificates=[],c.crls=[],c.digestAlgorithmIdentifiers=[],c.contentInfo=null,c.signerInfos=[],c.rawCapture.certificates)for(var b=c.rawCapture.certificates.value,d=0;d<b.length;++d)c.certificates.push(n.pki.certificateFromAsn1(b[d]))},toAsn1:function(){c.contentInfo||c.sign();for(var a=[],b=0;b<c.certificates.length;++b)a.push(n.pki.certificateToAsn1(c.certificates[b]));var d=[],e=o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(c.version).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,!0,c.digestAlgorithmIdentifiers),c.contentInfo])]);return a.length>0&&e.value[0].value.push(o.create(o.Class.CONTEXT_SPECIFIC,0,!0,a)),d.length>0&&e.value[0].value.push(o.create(o.Class.CONTEXT_SPECIFIC,1,!0,d)),e.value[0].value.push(o.create(o.Class.UNIVERSAL,o.Type.SET,!0,c.signerInfos)),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.type).getBytes()),e])},addSigner:function(a){var b=a.issuer,d=a.serialNumber;if(a.certificate){var e=a.certificate;"string"==typeof e&&(e=n.pki.certificateFromPem(e)),b=e.issuer.attributes,d=e.serialNumber}var f=a.key;if(!f)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof f&&(f=n.pki.privateKeyFromPem(f));var g=a.digestAlgorithm||n.pki.oids.sha1;switch(g){case n.pki.oids.sha1:case n.pki.oids.sha256:case n.pki.oids.sha384:case n.pki.oids.sha512:case n.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+g)}var h=a.authenticatedAttributes||[];if(h.length>0){for(var i=!1,j=!1,k=0;k<h.length;++k){var l=h[k];if(i||l.type!==n.pki.oids.contentType){if(j||l.type!==n.pki.oids.messageDigest);else if(j=!0,i)break}else if(i=!0,j)break}if(!i||!j)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}c.signers.push({key:f,version:1,issuer:b,serialNumber:d,digestAlgorithm:g,signatureAlgorithm:n.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:h,unauthenticatedAttributes:[]})},sign:function(d){if(d=d||{},("object"!=typeof c.content||null===c.contentInfo)&&(c.contentInfo=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(n.pki.oids.data).getBytes())]),"content"in c)){var e;c.content instanceof n.util.ByteBuffer?e=c.content.bytes():"string"==typeof c.content&&(e=n.util.encodeUtf8(c.content)),d.detached?c.detachedContent=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e):c.contentInfo.value.push(o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e)]))}if(0!==c.signers.length){var f=a();b(f)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(a){"string"==typeof a&&(a=n.pki.certificateFromPem(a)),c.certificates.push(a)},addCertificateRevokationList:function(a){throw new Error("PKCS#7 CRL support not yet implemented.")}}},p.createEncryptedData=function(){var a=null;return a={type:n.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(b){l(a,b,p.asn1.encryptedDataValidator)},decrypt:function(b){void 0!==b&&(a.encryptedContent.key=b),m(a)}}},p.createEnvelopedData=function(){var a=null;return a={type:n.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(b){var c=l(a,b,p.asn1.envelopedDataValidator);a.recipients=f(c.recipientInfos.value)},toAsn1:function(){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.type).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(a.version).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,!0,g(a.recipients)),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,k(a.encryptedContent))])])])},findRecipient:function(b){for(var c=b.issuer.attributes,d=0;d<a.recipients.length;++d){var e=a.recipients[d],f=e.issuer;if(e.serialNumber===b.serialNumber&&f.length===c.length){for(var g=!0,h=0;h<c.length;++h)if(f[h].type!==c[h].type||f[h].value!==c[h].value){g=!1;break}if(g)return e}}return null},decrypt:function(b,c){if(void 0===a.encryptedContent.key&&void 0!==b&&void 0!==c)switch(b.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:
case n.pki.oids.desCBC:var d=c.decrypt(b.encryptedContent.content);a.encryptedContent.key=n.util.createBuffer(d);break;default:throw new Error("Unsupported asymmetric cipher, OID "+b.encryptedContent.algorithm)}m(a)},addRecipient:function(b){a.recipients.push({version:0,issuer:b.issuer.attributes,serialNumber:b.serialNumber,encryptedContent:{algorithm:n.pki.oids.rsaEncryption,key:b.publicKey}})},encrypt:function(b,c){if(void 0===a.encryptedContent.content){c=c||a.encryptedContent.algorithm,b=b||a.encryptedContent.key;var d,e,f;switch(c){case n.pki.oids["aes128-CBC"]:d=16,e=16,f=n.aes.createEncryptionCipher;break;case n.pki.oids["aes192-CBC"]:d=24,e=16,f=n.aes.createEncryptionCipher;break;case n.pki.oids["aes256-CBC"]:d=32,e=16,f=n.aes.createEncryptionCipher;break;case n.pki.oids["des-EDE3-CBC"]:d=24,e=8,f=n.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+c)}if(void 0===b)b=n.util.createBuffer(n.random.getBytes(d));else if(b.length()!=d)throw new Error("Symmetric key has wrong length; got "+b.length()+" bytes, expected "+d+".");a.encryptedContent.algorithm=c,a.encryptedContent.key=b,a.encryptedContent.parameter=n.util.createBuffer(n.random.getBytes(e));var g=f(b);if(g.start(a.encryptedContent.parameter.copy()),g.update(a.content),!g.finish())throw new Error("Symmetric encryption failed.");a.encryptedContent.content=g.output}for(var h=0;h<a.recipients.length;++h){var i=a.recipients[h];if(void 0===i.encryptedContent.content)switch(i.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:i.encryptedContent.content=i.encryptedContent.key.encrypt(a.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+i.encryptedContent.algorithm)}}}}}},{"./aes":37,"./asn1":40,"./des":45,"./forge":47,"./oids":58,"./pem":61,"./pkcs7asn1":65,"./random":70,"./util":79,"./x509":80}],65:[function(a,b,c){var d=a("./forge");a("./asn1"),a("./util");var e=d.asn1,f=b.exports=d.pkcs7asn1=d.pkcs7asn1||{};d.pkcs7=d.pkcs7||{},d.pkcs7.asn1=f;var g={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};f.contentInfoValidator=g;var h={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};f.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(h)},f.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(h)};var i={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};f.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},g,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[i]}]},f.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},{"./asn1":40,"./forge":47,"./util":79}],66:[function(a,b,c){var d=a("./forge");a("./asn1"),a("./oids"),a("./pbe"),a("./pem"),a("./pbkdf2"),a("./pkcs12"),a("./pss"),a("./rsa"),a("./util"),a("./x509");var e=d.asn1,f=b.exports=d.pki=d.pki||{};f.pemToDer=function(a){var b=d.pem.decode(a)[0];if(b.procType&&"ENCRYPTED"===b.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return d.util.createBuffer(b.body)},f.privateKeyFromPem=function(a){var b=d.pem.decode(a)[0];if("PRIVATE KEY"!==b.type&&"RSA PRIVATE KEY"!==b.type){var c=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw c.headerType=b.type,c}if(b.procType&&"ENCRYPTED"===b.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var g=e.fromDer(b.body);return f.privateKeyFromAsn1(g)},f.privateKeyToPem=function(a,b){var c={type:"RSA PRIVATE KEY",body:e.toDer(f.privateKeyToAsn1(a)).getBytes()};return d.pem.encode(c,{maxline:b})},f.privateKeyInfoToPem=function(a,b){var c={type:"PRIVATE KEY",body:e.toDer(a).getBytes()};return d.pem.encode(c,{maxline:b})}},{"./asn1":40,"./forge":47,"./oids":58,"./pbe":59,"./pbkdf2":60,"./pem":61,"./pkcs12":63,"./pss":69,"./rsa":72,"./util":79,"./x509":80}],67:[function(a,b,c){var d=a("./forge");a("./util"),a("./jsbn"),a("./random"),function(){function a(a,b,d,e){return"workers"in d?f(a,b,d,e):c(a,b,d,e)}function c(a,b,c,d){var f=g(a,b),i=0,j=h(f.bitLength());"millerRabinTests"in c&&(j=c.millerRabinTests);var k=10;"maxBlockTime"in c&&(k=c.maxBlockTime),e(f,a,b,i,j,k,d)}function e(a,b,c,f,h,i,j){var l=+new Date;do{if(a.bitLength()>b&&(a=g(b,c)),a.isProbablePrime(h))return j(null,a);a.dAddOffset(k[f++%8],0)}while(i<0||+new Date-l<i);d.util.setImmediate(function(){e(a,b,c,f,h,i,j)})}function f(a,b,e,f){function h(){function c(c){if(!o){--h;var e=c.data;if(e.found){for(var k=0;k<d.length;++k)d[k].terminate();return o=!0,f(null,new j(e.prime,16))}i.bitLength()>a&&(i=g(a,b));var n=i.toString(16);c.target.postMessage({hex:n,workLoad:l}),i.dAddOffset(m,0)}}k=Math.max(1,k);for(var d=[],e=0;e<k;++e)d[e]=new Worker(n);for(var h=k,e=0;e<k;++e)d[e].addEventListener("message",c);var o=!1}if("undefined"==typeof Worker)return c(a,b,e,f);var i=g(a,b),k=e.workers,l=e.workLoad||100,m=30*l/8,n=e.workerScript||"forge/prime.worker.js";return k===-1?d.util.estimateCores(function(a,b){a&&(b=2),k=b-1,h()}):void h()}function g(a,b){var c=new j(a,b),d=a-1;return c.testBit(d)||c.bitwiseTo(j.ONE.shiftLeft(d),m,c),c.dAddOffset(31-c.mod(l).byteValue(),0),c}function h(a){return a<=100?27:a<=150?18:a<=200?15:a<=250?12:a<=300?9:a<=350?8:a<=400?7:a<=500?6:a<=600?5:a<=800?4:a<=1250?3:2}if(d.prime)return void(b.exports=d.prime);var i=b.exports=d.prime=d.prime||{},j=d.jsbn.BigInteger,k=[6,4,2,4,2,4,6,2],l=new j(null);l.fromInt(30);var m=function(a,b){return a|b};i.generateProbablePrime=function(b,c,e){"function"==typeof c&&(e=c,c={}),c=c||{};var f=c.algorithm||"PRIMEINC";"string"==typeof f&&(f={name:f}),f.options=f.options||{};var g=c.prng||d.random,h={nextBytes:function(a){for(var b=g.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=b.charCodeAt(c)}};if("PRIMEINC"===f.name)return a(b,h,f.options,e);throw new Error("Invalid prime generation algorithm: "+f.name)}}()},{"./forge":47,"./jsbn":50,"./random":70,"./util":79}],68:[function(a,b,c){(function(c){var d=a("./forge");a("./util");var e=null;!d.util.isNodejs||d.options.usePureJavaScript||c.versions["node-webkit"]||(e=a("crypto"));var f=b.exports=d.prng=d.prng||{};f.create=function(a){function b(a){if(h.pools[0].messageLength>=32)return f(),a();var b=32-h.pools[0].messageLength<<5;h.seedFile(b,function(b,c){return b?a(b):(h.collect(c),f(),void a())})}function c(){if(h.pools[0].messageLength>=32)return f();var a=32-h.pools[0].messageLength<<5;h.collect(h.seedFileSync(a)),f()}function f(){h.reseeds=4294967295===h.reseeds?0:h.reseeds+1;var a=h.plugin.md.create();a.update(h.keyBytes);for(var b=1,c=0;c<32;++c)h.reseeds%b===0&&(a.update(h.pools[c].digest().getBytes()),h.pools[c].start()),b<<=1;h.keyBytes=a.digest().getBytes(),a.start(),a.update(h.keyBytes);var d=a.digest().getBytes();h.key=h.plugin.formatKey(h.keyBytes),h.seed=h.plugin.formatSeed(d),h.generated=0}function g(a){var b=null,c=d.util.globalScope,e=c.crypto||c.msCrypto;e&&e.getRandomValues&&(b=function(a){return e.getRandomValues(a)});var f=d.util.createBuffer();if(b)for(;f.length()<a;){var g=Math.max(1,Math.min(a-f.length(),65536)/4),h=new Uint32Array(Math.floor(g));try{b(h);for(var i=0;i<h.length;++i)f.putInt32(h[i])}catch(j){if(!("undefined"!=typeof QuotaExceededError&&j instanceof QuotaExceededError))throw j}}if(f.length()<a)for(var k,l,m,n=Math.floor(65536*Math.random());f.length()<a;){l=16807*(65535&n),k=16807*(n>>16),l+=(32767&k)<<16,l+=k>>15,l=(2147483647&l)+(l>>31),n=4294967295&l;for(var i=0;i<3;++i)m=n>>>(i<<3),m^=Math.floor(256*Math.random()),f.putByte(String.fromCharCode(255&m))}return f.getBytes(a)}for(var h={plugin:a,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},i=a.md,j=new Array(32),k=0;k<32;++k)j[k]=i.create();return h.pools=j,h.pool=0,h.generate=function(a,c){function e(l){if(l)return c(l);if(k.length()>=a)return c(null,k.getBytes(a));if(h.generated>1048575&&(h.key=null),null===h.key)return d.util.nextTick(function(){b(e)});var m=f(h.key,h.seed);h.generated+=m.length,k.putBytes(m),h.key=i(f(h.key,g(h.seed))),h.seed=j(f(h.key,h.seed)),d.util.setImmediate(e)}if(!c)return h.generateSync(a);var f=h.plugin.cipher,g=h.plugin.increment,i=h.plugin.formatKey,j=h.plugin.formatSeed,k=d.util.createBuffer();h.key=null,e()},h.generateSync=function(a){var b=h.plugin.cipher,e=h.plugin.increment,f=h.plugin.formatKey,g=h.plugin.formatSeed;h.key=null;for(var i=d.util.createBuffer();i.length()<a;){h.generated>1048575&&(h.key=null),null===h.key&&c();var j=b(h.key,h.seed);h.generated+=j.length,i.putBytes(j),h.key=f(b(h.key,e(h.seed))),h.seed=g(b(h.key,h.seed))}return i.getBytes(a)},e?(h.seedFile=function(a,b){e.randomBytes(a,function(a,c){return a?b(a):void b(null,c.toString())})},h.seedFileSync=function(a){return e.randomBytes(a).toString()}):(h.seedFile=function(a,b){try{b(null,g(a))}catch(c){b(c)}},h.seedFileSync=g),h.collect=function(a){for(var b=a.length,c=0;c<b;++c)h.pools[h.pool].update(a.substr(c,1)),h.pool=31===h.pool?0:h.pool+1},h.collectInt=function(a,b){for(var c="",d=0;d<b;d+=8)c+=String.fromCharCode(a>>d&255);h.collect(c)},h.registerWorker=function(a){if(a===self)h.seedFile=function(a,b){function c(a){var d=a.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",c),b(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",c),self.postMessage({forge:{prng:{needed:a}}})};else{var b=function(b){var c=b.data;c.forge&&c.forge.prng&&h.seedFile(c.forge.prng.needed,function(b,c){a.postMessage({forge:{prng:{err:b,bytes:c}}})})};a.addEventListener("message",b)}},h}}).call(this,a("_process"))},{"./forge":47,"./util":79,_process:81,crypto:18}],69:[function(a,b,c){var d=a("./forge");a("./random"),a("./util");var e=b.exports=d.pss=d.pss||{};e.create=function(a){3===arguments.length&&(a={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var b=a.md,c=a.mgf,e=b.digestLength,f=a.salt||null;"string"==typeof f&&(f=d.util.createBuffer(f));var g;if("saltLength"in a)g=a.saltLength;else{if(null===f)throw new Error("Salt length not specified or specific salt not given.");g=f.length()}if(null!==f&&f.length()!==g)throw new Error("Given salt length does not match length of given salt.");var h=a.prng||d.random,i={};return i.encode=function(a,i){var j,k=i-1,l=Math.ceil(k/8),m=a.digest().getBytes();if(l<e+g+2)throw new Error("Message is too long to encrypt.");var n;n=null===f?h.getBytesSync(g):f.bytes();var o=new d.util.ByteBuffer;o.fillWithByte(0,8),o.putBytes(m),o.putBytes(n),b.start(),b.update(o.getBytes());var p=b.digest().getBytes(),q=new d.util.ByteBuffer;q.fillWithByte(0,l-g-e-2),q.putByte(1),q.putBytes(n);var r=q.getBytes(),s=l-e-1,t=c.generate(p,s),u="";for(j=0;j<s;j++)u+=String.fromCharCode(r.charCodeAt(j)^t.charCodeAt(j));var v=65280>>8*l-k&255;return u=String.fromCharCode(u.charCodeAt(0)&~v)+u.substr(1),u+p+String.fromCharCode(188)},i.verify=function(a,f,h){var i,j=h-1,k=Math.ceil(j/8);if(f=f.substr(-k),k<e+g+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==f.charCodeAt(k-1))throw new Error("Encoded message does not end in 0xBC.");var l=k-e-1,m=f.substr(0,l),n=f.substr(l,e),o=65280>>8*k-j&255;if(0!==(m.charCodeAt(0)&o))throw new Error("Bits beyond keysize not zero as expected.");var p=c.generate(n,l),q="";for(i=0;i<l;i++)q+=String.fromCharCode(m.charCodeAt(i)^p.charCodeAt(i));q=String.fromCharCode(q.charCodeAt(0)&~o)+q.substr(1);var r=k-e-g-2;for(i=0;i<r;i++)if(0!==q.charCodeAt(i))throw new Error("Leftmost octets not zero as expected");if(1!==q.charCodeAt(r))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var s=q.substr(-g),t=new d.util.ByteBuffer;t.fillWithByte(0,8),t.putBytes(a),t.putBytes(s),b.start(),b.update(t.getBytes());var u=b.digest().getBytes();return n===u},i}},{"./forge":47,"./random":70,"./util":79}],70:[function(a,b,c){var d=a("./forge");a("./aes"),a("./sha256"),a("./prng"),a("./util"),function(){return d.random&&d.random.getBytes?void(b.exports=d.random):void function(a){function c(){var a=d.prng.create(e);return a.getBytes=function(b,c){return a.generate(b,c)},a.getBytesSync=function(b){return a.generate(b)},a}var e={},f=new Array(4),g=d.util.createBuffer();e.formatKey=function(a){var b=d.util.createBuffer(a);return a=new Array(4),a[0]=b.getInt32(),a[1]=b.getInt32(),a[2]=b.getInt32(),a[3]=b.getInt32(),d.aes._expandKey(a,!1)},e.formatSeed=function(a){var b=d.util.createBuffer(a);return a=new Array(4),a[0]=b.getInt32(),a[1]=b.getInt32(),a[2]=b.getInt32(),a[3]=b.getInt32(),a},e.cipher=function(a,b){return d.aes._updateBlock(a,b,f,!1),g.putInt32(f[0]),g.putInt32(f[1]),g.putInt32(f[2]),g.putInt32(f[3]),g.getBytes()},e.increment=function(a){return++a[3],a},e.md=d.md.sha256;var h=c(),i=null,j=d.util.globalScope,k=j.crypto||j.msCrypto;if(k&&k.getRandomValues&&(i=function(a){return k.getRandomValues(a)}),d.options.usePureJavaScript||!d.util.isNodejs&&!i){if("undefined"==typeof window||void 0===window.document,h.collectInt(+new Date,32),"undefined"!=typeof navigator){var l="";for(var m in navigator)try{"string"==typeof navigator[m]&&(l+=navigator[m])}catch(n){}h.collect(l),l=null}a&&(a().mousemove(function(a){h.collectInt(a.clientX,16),h.collectInt(a.clientY,16)}),a().keypress(function(a){h.collectInt(a.charCode,8)}))}if(d.random)for(var m in h)d.random[m]=h[m];else d.random=h;d.random.createInstance=c,b.exports=d.random}("undefined"!=typeof jQuery?jQuery:null)}()},{"./aes":37,"./forge":47,"./prng":68,"./sha256":74,"./util":79}],71:[function(a,b,c){var d=a("./forge");a("./util");var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],f=[1,2,3,5],g=function(a,b){return a<<b&65535|(65535&a)>>16-b},h=function(a,b){return(65535&a)>>b|a<<16-b&65535};b.exports=d.rc2=d.rc2||{},d.rc2.expandKey=function(a,b){"string"==typeof a&&(a=d.util.createBuffer(a)),b=b||128;var c,f=a,g=a.length(),h=b,i=Math.ceil(h/8),j=255>>(7&h);for(c=g;c<128;c++)f.putByte(e[f.at(c-1)+f.at(c-g)&255]);for(f.setAt(128-i,e[f.at(128-i)&j]),c=127-i;c>=0;c--)f.setAt(c,e[f.at(c+1)^f.at(c+i)]);return f};var i=function(a,b,c){var e,i,j,k,l=!1,m=null,n=null,o=null,p=[];for(a=d.rc2.expandKey(a,b),j=0;j<64;j++)p.push(a.getInt16Le());c?(e=function(a){for(j=0;j<4;j++)a[j]+=p[k]+(a[(j+3)%4]&a[(j+2)%4])+(~a[(j+3)%4]&a[(j+1)%4]),a[j]=g(a[j],f[j]),k++},i=function(a){for(j=0;j<4;j++)a[j]+=p[63&a[(j+3)%4]]}):(e=function(a){for(j=3;j>=0;j--)a[j]=h(a[j],f[j]),a[j]-=p[k]+(a[(j+3)%4]&a[(j+2)%4])+(~a[(j+3)%4]&a[(j+1)%4]),k--},i=function(a){for(j=3;j>=0;j--)a[j]-=p[63&a[(j+3)%4]]});var q=function(a){var b=[];for(j=0;j<4;j++){var d=m.getInt16Le();null!==o&&(c?d^=o.getInt16Le():o.putInt16Le(d)),b.push(65535&d)}k=c?0:63;for(var e=0;e<a.length;e++)for(var f=0;f<a[e][0];f++)a[e][1](b);for(j=0;j<4;j++)null!==o&&(c?o.putInt16Le(b[j]):b[j]^=o.getInt16Le()),n.putInt16Le(b[j])},r=null;return r={start:function(a,b){a&&"string"==typeof a&&(a=d.util.createBuffer(a)),l=!1,m=d.util.createBuffer(),n=b||new d.util.createBuffer,o=a,r.output=n},update:function(a){for(l||m.putBuffer(a);m.length()>=8;)q([[5,e],[1,i],[6,e],[1,i],[5,e]])},finish:function(a){var b=!0;if(c)if(a)b=a(8,m,!c);else{var d=8===m.length()?8:8-m.length();m.fillWithByte(d,d)}if(b&&(l=!0,r.update()),!c&&(b=0===m.length()))if(a)b=a(8,n,!c);else{var e=n.length(),f=n.at(e-1);f>e?b=!1:n.truncate(f)}return b}}};d.rc2.startEncrypting=function(a,b,c){var e=d.rc2.createEncryptionCipher(a,128);return e.start(b,c),e},d.rc2.createEncryptionCipher=function(a,b){return i(a,b,!0)},d.rc2.startDecrypting=function(a,b,c){var e=d.rc2.createDecryptionCipher(a,128);return e.start(b,c),e},d.rc2.createDecryptionCipher=function(a,b){return i(a,b,!1)}},{"./forge":47,"./util":79}],72:[function(a,b,c){function d(a,b,c){var d=m.util.createBuffer(),e=Math.ceil(b.n.bitLength()/8);if(a.length>e-11){var f=new Error("Message is too long for PKCS#1 v1.5 padding.");throw f.length=a.length,f.max=e-11,f}d.putByte(0),d.putByte(c);var g,h=e-3-a.length;if(0===c||1===c){g=0===c?0:255;for(var i=0;i<h;++i)d.putByte(g)}else for(;h>0;){for(var j=0,k=m.random.getBytes(h),i=0;i<h;++i)g=k.charCodeAt(i),0===g?++j:d.putByte(g);h=j}return d.putByte(0),d.putBytes(a),d}function e(a,b,c,d){var e=Math.ceil(b.n.bitLength()/8),f=m.util.createBuffer(a),g=f.getByte(),h=f.getByte();if(0!==g||c&&0!==h&&1!==h||!c&&2!=h||c&&0===h&&"undefined"==typeof d)throw new Error("Encryption block is invalid.");var i=0;if(0===h){i=e-3-d;for(var j=0;j<i;++j)if(0!==f.getByte())throw new Error("Encryption block is invalid.")}else if(1===h)for(i=0;f.length()>1;){if(255!==f.getByte()){--f.read;break}++i}else if(2===h)for(i=0;f.length()>1;){if(0===f.getByte()){--f.read;break}++i}var k=f.getByte();if(0!==k||i!==e-3-f.length())throw new Error("Encryption block is invalid.");return f.getBytes()}function f(a,b,c){function d(){e(a.pBits,function(b,d){return b?c(b):(a.p=d,null!==a.q?f(b,a.q):void e(a.qBits,f))})}function e(a,b){m.prime.generateProbablePrime(a,g,b)}function f(b,g){if(b)return c(b);if(a.q=g,a.p.compareTo(a.q)<0){var h=a.p;a.p=a.q,a.q=h}if(0!==a.p.subtract(n.ONE).gcd(a.e).compareTo(n.ONE))return a.p=null,void d();if(0!==a.q.subtract(n.ONE).gcd(a.e).compareTo(n.ONE))return a.q=null,void e(a.qBits,f);if(a.p1=a.p.subtract(n.ONE),a.q1=a.q.subtract(n.ONE),a.phi=a.p1.multiply(a.q1),0!==a.phi.gcd(a.e).compareTo(n.ONE))return a.p=a.q=null,void d();if(a.n=a.p.multiply(a.q),a.n.bitLength()!==a.bits)return a.q=null,void e(a.qBits,f);var i=a.e.modInverse(a.phi);a.keys={privateKey:r.rsa.setPrivateKey(a.n,a.e,i,a.p,a.q,i.mod(a.p1),i.mod(a.q1),a.q.modInverse(a.p)),publicKey:r.rsa.setPublicKey(a.n,a.e)},c(null,a.keys)}"function"==typeof b&&(c=b,b={}),b=b||{};var g={algorithm:{name:b.algorithm||"PRIMEINC",options:{workers:b.workers||2,workLoad:b.workLoad||100,workerScript:b.workerScript}}};"prng"in b&&(g.prng=b.prng),d()}function g(a){var b=a.toString(16);b[0]>="8"&&(b="00"+b);var c=m.util.hexToBytes(b);return c.length>1&&(0===c.charCodeAt(0)&&0===(128&c.charCodeAt(1))||255===c.charCodeAt(0)&&128===(128&c.charCodeAt(1)))?c.substr(1):c}function h(a){return a<=100?27:a<=150?18:a<=200?15:a<=250?12:a<=300?9:a<=350?8:a<=400?7:a<=500?6:a<=600?5:a<=800?4:a<=1250?3:2}function i(a){return m.util.isNodejs&&"function"==typeof o[a]}function j(a){return"undefined"!=typeof q.globalScope&&"object"==typeof q.globalScope.crypto&&"object"==typeof q.globalScope.crypto.subtle&&"function"==typeof q.globalScope.crypto.subtle[a]}function k(a){return"undefined"!=typeof q.globalScope&&"object"==typeof q.globalScope.msCrypto&&"object"==typeof q.globalScope.msCrypto.subtle&&"function"==typeof q.globalScope.msCrypto.subtle[a]}function l(a){for(var b=m.util.hexToBytes(a.toString(16)),c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c}var m=a("./forge");if(a("./asn1"),a("./jsbn"),a("./oids"),a("./pkcs1"),a("./prime"),a("./random"),a("./util"),"undefined"==typeof n)var n=m.jsbn.BigInteger;var o=m.util.isNodejs?a("crypto"):null,p=m.asn1,q=m.util;m.pki=m.pki||{},b.exports=m.pki.rsa=m.rsa=m.rsa||{};var r=m.pki,s=[6,4,2,4,2,4,6,2],t={name:"PrivateKeyInfo",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:p.Class.UNIVERSAL,type:p.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},u={name:"RSAPrivateKey",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},v={name:"RSAPublicKey",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},w=m.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:p.Class.UNIVERSAL,type:p.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},x=function(a){var b;if(!(a.algorithm in r.oids)){var c=new Error("Unknown message digest algorithm.");throw c.algorithm=a.algorithm,c}b=r.oids[a.algorithm];var d=p.oidToDer(b).getBytes(),e=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]),f=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]);f.value.push(p.create(p.Class.UNIVERSAL,p.Type.OID,!1,d)),f.value.push(p.create(p.Class.UNIVERSAL,p.Type.NULL,!1,""));var g=p.create(p.Class.UNIVERSAL,p.Type.OCTETSTRING,!1,a.digest().getBytes());return e.value.push(f),e.value.push(g),p.toDer(e).getBytes()},y=function(a,b,c){if(c)return a.modPow(b.e,b.n);if(!b.p||!b.q)return a.modPow(b.d,b.n);b.dP||(b.dP=b.d.mod(b.p.subtract(n.ONE))),b.dQ||(b.dQ=b.d.mod(b.q.subtract(n.ONE))),b.qInv||(b.qInv=b.q.modInverse(b.p));var d;do d=new n(m.util.bytesToHex(m.random.getBytes(b.n.bitLength()/8)),16);while(d.compareTo(b.n)>=0||!d.gcd(b.n).equals(n.ONE));a=a.multiply(d.modPow(b.e,b.n)).mod(b.n);for(var e=a.mod(b.p).modPow(b.dP,b.p),f=a.mod(b.q).modPow(b.dQ,b.q);e.compareTo(f)<0;)e=e.add(b.p);var g=e.subtract(f).multiply(b.qInv).mod(b.p).multiply(b.q).add(f);return g=g.multiply(d.modInverse(b.n)).mod(b.n)};r.rsa.encrypt=function(a,b,c){var e,f=c,g=Math.ceil(b.n.bitLength()/8);c!==!1&&c!==!0?(f=2===c,e=d(a,b,c)):(e=m.util.createBuffer(),e.putBytes(a));for(var h=new n(e.toHex(),16),i=y(h,b,f),j=i.toString(16),k=m.util.createBuffer(),l=g-Math.ceil(j.length/2);l>0;)k.putByte(0),--l;return k.putBytes(m.util.hexToBytes(j)),k.getBytes()},r.rsa.decrypt=function(a,b,c,d){var f=Math.ceil(b.n.bitLength()/8);if(a.length!==f){var g=new Error("Encrypted message length is invalid.");throw g.length=a.length,g.expected=f,g}var h=new n(m.util.createBuffer(a).toHex(),16);if(h.compareTo(b.n)>=0)throw new Error("Encrypted message is invalid.");for(var i=y(h,b,c),j=i.toString(16),k=m.util.createBuffer(),l=f-Math.ceil(j.length/2);l>0;)k.putByte(0),--l;return k.putBytes(m.util.hexToBytes(j)),d!==!1?e(k.getBytes(),b,c):k.getBytes()},r.rsa.createKeyPairGenerationState=function(a,b,c){"string"==typeof a&&(a=parseInt(a,10)),a=a||2048,c=c||{};var d,e=c.prng||m.random,f={nextBytes:function(a){for(var b=e.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=b.charCodeAt(c)}},g=c.algorithm||"PRIMEINC";if("PRIMEINC"!==g)throw new Error("Invalid key generation algorithm: "+g);return d={algorithm:g,state:0,bits:a,rng:f,eInt:b||65537,e:new n(null),p:null,q:null,qBits:a>>1,pBits:a-(a>>1),pqState:0,num:null,keys:null},d.e.fromInt(d.eInt),d},r.rsa.stepKeyPairGenerationState=function(a,b){"algorithm"in a||(a.algorithm="PRIMEINC");var c=new n(null);c.fromInt(30);for(var d,e=0,f=function(a,b){return a|b},g=+new Date,i=0;null===a.keys&&(b<=0||i<b);){if(0===a.state){var j=null===a.p?a.pBits:a.qBits,k=j-1;0===a.pqState?(a.num=new n(j,a.rng),a.num.testBit(k)||a.num.bitwiseTo(n.ONE.shiftLeft(k),f,a.num),a.num.dAddOffset(31-a.num.mod(c).byteValue(),0),e=0,++a.pqState):1===a.pqState?a.num.bitLength()>j?a.pqState=0:a.num.isProbablePrime(h(a.num.bitLength()))?++a.pqState:a.num.dAddOffset(s[e++%8],0):2===a.pqState?a.pqState=0===a.num.subtract(n.ONE).gcd(a.e).compareTo(n.ONE)?3:0:3===a.pqState&&(a.pqState=0,null===a.p?a.p=a.num:a.q=a.num,null!==a.p&&null!==a.q&&++a.state,a.num=null)}else if(1===a.state)a.p.compareTo(a.q)<0&&(a.num=a.p,a.p=a.q,a.q=a.num),++a.state;else if(2===a.state)a.p1=a.p.subtract(n.ONE),a.q1=a.q.subtract(n.ONE),a.phi=a.p1.multiply(a.q1),++a.state;else if(3===a.state)0===a.phi.gcd(a.e).compareTo(n.ONE)?++a.state:(a.p=null,a.q=null,a.state=0);else if(4===a.state)a.n=a.p.multiply(a.q),a.n.bitLength()===a.bits?++a.state:(a.q=null,a.state=0);else if(5===a.state){var l=a.e.modInverse(a.phi);a.keys={privateKey:r.rsa.setPrivateKey(a.n,a.e,l,a.p,a.q,l.mod(a.p1),l.mod(a.q1),a.q.modInverse(a.p)),publicKey:r.rsa.setPublicKey(a.n,a.e)}}d=+new Date,i+=d-g,g=d}return null!==a.keys},r.rsa.generateKeyPair=function(a,b,c,d){if(1===arguments.length?"object"==typeof a?(c=a,a=void 0):"function"==typeof a&&(d=a,a=void 0):2===arguments.length?"number"==typeof a?"function"==typeof b?(d=b,b=void 0):"number"!=typeof b&&(c=b,b=void 0):(c=a,d=b,a=void 0,b=void 0):3===arguments.length&&("number"==typeof b?"function"==typeof c&&(d=c,c=void 0):(d=c,c=b,b=void 0)),c=c||{},void 0===a&&(a=c.bits||2048),void 0===b&&(b=c.e||65537),!m.options.usePureJavaScript&&!c.prng&&a>=256&&a<=16384&&(65537===b||3===b))if(d){if(i("generateKeyPair"))return o.generateKeyPair("rsa",{modulusLength:a,publicExponent:b,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,b,c){return a?d(a):void d(null,{privateKey:r.privateKeyFromPem(c),publicKey:r.publicKeyFromPem(b)})});if(j("generateKey")&&j("exportKey"))return q.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:a,publicExponent:l(b),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return q.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){d(a)}).then(function(a){
if(a){var b=r.privateKeyFromAsn1(p.fromDer(m.util.createBuffer(a)));d(null,{privateKey:b,publicKey:r.setRsaPublicKey(b.n,b.e)})}});if(k("generateKey")&&k("exportKey")){var e=q.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:a,publicExponent:l(b),hash:{name:"SHA-256"}},!0,["sign","verify"]);return e.oncomplete=function(a){var b=a.target.result,c=q.globalScope.msCrypto.subtle.exportKey("pkcs8",b.privateKey);c.oncomplete=function(a){var b=a.target.result,c=r.privateKeyFromAsn1(p.fromDer(m.util.createBuffer(b)));d(null,{privateKey:c,publicKey:r.setRsaPublicKey(c.n,c.e)})},c.onerror=function(a){d(a)}},void(e.onerror=function(a){d(a)})}}else if(i("generateKeyPairSync")){var g=o.generateKeyPairSync("rsa",{modulusLength:a,publicExponent:b,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:r.privateKeyFromPem(g.privateKey),publicKey:r.publicKeyFromPem(g.publicKey)}}var h=r.rsa.createKeyPairGenerationState(a,b,c);return d?void f(h,c,d):(r.rsa.stepKeyPairGenerationState(h,0),h.keys)},r.setRsaPublicKey=r.rsa.setPublicKey=function(a,b){var c={n:a,e:b};return c.encrypt=function(a,b,e){if("string"==typeof b?b=b.toUpperCase():void 0===b&&(b="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===b)b={encode:function(a,b,c){return d(a,b,2).getBytes()}};else if("RSA-OAEP"===b||"RSAES-OAEP"===b)b={encode:function(a,b){return m.pkcs1.encode_rsa_oaep(b,a,e)}};else if(["RAW","NONE","NULL",null].indexOf(b)!==-1)b={encode:function(a){return a}};else if("string"==typeof b)throw new Error('Unsupported encryption scheme: "'+b+'".');var f=b.encode(a,c,!0);return r.rsa.encrypt(f,c,!0)},c.verify=function(a,b,d){"string"==typeof d?d=d.toUpperCase():void 0===d&&(d="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===d?d={verify:function(a,b){b=e(b,c,!0);var d=p.fromDer(b);return a===d.value[1].value}}:"NONE"!==d&&"NULL"!==d&&null!==d||(d={verify:function(a,b){return b=e(b,c,!0),a===b}});var f=r.rsa.decrypt(b,c,!0,!1);return d.verify(a,f,c.n.bitLength())},c},r.setRsaPrivateKey=r.rsa.setPrivateKey=function(a,b,c,d,f,g,h,i){var j={n:a,e:b,d:c,p:d,q:f,dP:g,dQ:h,qInv:i};return j.decrypt=function(a,b,c){"string"==typeof b?b=b.toUpperCase():void 0===b&&(b="RSAES-PKCS1-V1_5");var d=r.rsa.decrypt(a,j,!1,!1);if("RSAES-PKCS1-V1_5"===b)b={decode:e};else if("RSA-OAEP"===b||"RSAES-OAEP"===b)b={decode:function(a,b){return m.pkcs1.decode_rsa_oaep(b,a,c)}};else{if(["RAW","NONE","NULL",null].indexOf(b)===-1)throw new Error('Unsupported encryption scheme: "'+b+'".');b={decode:function(a){return a}}}return b.decode(d,j,!1)},j.sign=function(a,b){var c=!1;"string"==typeof b&&(b=b.toUpperCase()),void 0===b||"RSASSA-PKCS1-V1_5"===b?(b={encode:x},c=1):"NONE"!==b&&"NULL"!==b&&null!==b||(b={encode:function(){return a}},c=1);var d=b.encode(a,j.n.bitLength());return r.rsa.encrypt(d,j,c)},j},r.wrapRsaPrivateKey=function(a){return p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,p.integerToDer(0).getBytes()),p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(r.oids.rsaEncryption).getBytes()),p.create(p.Class.UNIVERSAL,p.Type.NULL,!1,"")]),p.create(p.Class.UNIVERSAL,p.Type.OCTETSTRING,!1,p.toDer(a).getBytes())])},r.privateKeyFromAsn1=function(a){var b={},c=[];if(p.validate(a,t,b,c)&&(a=p.fromDer(m.util.createBuffer(b.privateKey))),b={},c=[],!p.validate(a,u,b,c)){var d=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw d.errors=c,d}var e,f,g,h,i,j,k,l;return e=m.util.createBuffer(b.privateKeyModulus).toHex(),f=m.util.createBuffer(b.privateKeyPublicExponent).toHex(),g=m.util.createBuffer(b.privateKeyPrivateExponent).toHex(),h=m.util.createBuffer(b.privateKeyPrime1).toHex(),i=m.util.createBuffer(b.privateKeyPrime2).toHex(),j=m.util.createBuffer(b.privateKeyExponent1).toHex(),k=m.util.createBuffer(b.privateKeyExponent2).toHex(),l=m.util.createBuffer(b.privateKeyCoefficient).toHex(),r.setRsaPrivateKey(new n(e,16),new n(f,16),new n(g,16),new n(h,16),new n(i,16),new n(j,16),new n(k,16),new n(l,16))},r.privateKeyToAsn1=r.privateKeyToRSAPrivateKey=function(a){return p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,p.integerToDer(0).getBytes()),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,g(a.n)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,g(a.e)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,g(a.d)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,g(a.p)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,g(a.q)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,g(a.dP)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,g(a.dQ)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,g(a.qInv))])},r.publicKeyFromAsn1=function(a){var b={},c=[];if(p.validate(a,w,b,c)){var d=p.derToOid(b.publicKeyOid);if(d!==r.oids.rsaEncryption){var e=new Error("Cannot read public key. Unknown OID.");throw e.oid=d,e}a=b.rsaPublicKey}if(c=[],!p.validate(a,v,b,c)){var e=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw e.errors=c,e}var f=m.util.createBuffer(b.publicKeyModulus).toHex(),g=m.util.createBuffer(b.publicKeyExponent).toHex();return r.setRsaPublicKey(new n(f,16),new n(g,16))},r.publicKeyToAsn1=r.publicKeyToSubjectPublicKeyInfo=function(a){return p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(r.oids.rsaEncryption).getBytes()),p.create(p.Class.UNIVERSAL,p.Type.NULL,!1,"")]),p.create(p.Class.UNIVERSAL,p.Type.BITSTRING,!1,[r.publicKeyToRSAPublicKey(a)])])},r.publicKeyToRSAPublicKey=function(a){return p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,g(a.n)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,g(a.e))])}},{"./asn1":40,"./forge":47,"./jsbn":50,"./oids":58,"./pkcs1":62,"./prime":67,"./random":70,"./util":79,crypto:18}],73:[function(a,b,c){function d(){h=String.fromCharCode(128),h+=f.util.fillString(String.fromCharCode(0),64),i=!0}function e(a,b,c){for(var d,e,f,g,h,i,j,k,l=c.length();l>=64;){for(e=a.h0,f=a.h1,g=a.h2,h=a.h3,i=a.h4,k=0;k<16;++k)d=c.getInt32(),b[k]=d,j=h^f&(g^h),d=(e<<5|e>>>27)+j+i+1518500249+d,i=h,h=g,g=(f<<30|f>>>2)>>>0,f=e,e=d;for(;k<20;++k)d=b[k-3]^b[k-8]^b[k-14]^b[k-16],d=d<<1|d>>>31,b[k]=d,j=h^f&(g^h),d=(e<<5|e>>>27)+j+i+1518500249+d,i=h,h=g,g=(f<<30|f>>>2)>>>0,f=e,e=d;for(;k<32;++k)d=b[k-3]^b[k-8]^b[k-14]^b[k-16],d=d<<1|d>>>31,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+1859775393+d,i=h,h=g,g=(f<<30|f>>>2)>>>0,f=e,e=d;for(;k<40;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+1859775393+d,i=h,h=g,g=(f<<30|f>>>2)>>>0,f=e,e=d;for(;k<60;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f&g|h&(f^g),d=(e<<5|e>>>27)+j+i+2400959708+d,i=h,h=g,g=(f<<30|f>>>2)>>>0,f=e,e=d;for(;k<80;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+3395469782+d,i=h,h=g,g=(f<<30|f>>>2)>>>0,f=e,e=d;a.h0=a.h0+e|0,a.h1=a.h1+f|0,a.h2=a.h2+g|0,a.h3=a.h3+h|0,a.h4=a.h4+i|0,l-=64}}var f=a("./forge");a("./md"),a("./util");var g=b.exports=f.sha1=f.sha1||{};f.md.sha1=f.md.algorithms.sha1=g,g.create=function(){i||d();var a=null,b=f.util.createBuffer(),c=new Array(80),g={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return g.start=function(){g.messageLength=0,g.fullMessageLength=g.messageLength64=[];for(var c=g.messageLengthSize/4,d=0;d<c;++d)g.fullMessageLength.push(0);return b=f.util.createBuffer(),a={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},g},g.start(),g.update=function(d,h){"utf8"===h&&(d=f.util.encodeUtf8(d));var i=d.length;g.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var j=g.fullMessageLength.length-1;j>=0;--j)g.fullMessageLength[j]+=i[1],i[1]=i[0]+(g.fullMessageLength[j]/4294967296>>>0),g.fullMessageLength[j]=g.fullMessageLength[j]>>>0,i[0]=i[1]/4294967296>>>0;return b.putBytes(d),e(a,c,b),(b.read>2048||0===b.length())&&b.compact(),g},g.digest=function(){var d=f.util.createBuffer();d.putBytes(b.bytes());var i=g.fullMessageLength[g.fullMessageLength.length-1]+g.messageLengthSize,j=i&g.blockLength-1;d.putBytes(h.substr(0,g.blockLength-j));for(var k,l,m=8*g.fullMessageLength[0],n=0;n<g.fullMessageLength.length-1;++n)k=8*g.fullMessageLength[n+1],l=k/4294967296>>>0,m+=l,d.putInt32(m>>>0),m=k>>>0;d.putInt32(m);var o={h0:a.h0,h1:a.h1,h2:a.h2,h3:a.h3,h4:a.h4};e(o,c,d);var p=f.util.createBuffer();return p.putInt32(o.h0),p.putInt32(o.h1),p.putInt32(o.h2),p.putInt32(o.h3),p.putInt32(o.h4),p},g};var h=null,i=!1},{"./forge":47,"./md":54,"./util":79}],74:[function(a,b,c){function d(){h=String.fromCharCode(128),h+=f.util.fillString(String.fromCharCode(0),64),j=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],i=!0}function e(a,b,c){for(var d,e,f,g,h,i,k,l,m,n,o,p,q,r,s,t=c.length();t>=64;){for(k=0;k<16;++k)b[k]=c.getInt32();for(;k<64;++k)d=b[k-2],d=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,e=b[k-15],e=(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3,b[k]=d+b[k-7]+e+b[k-16]|0;for(l=a.h0,m=a.h1,n=a.h2,o=a.h3,p=a.h4,q=a.h5,r=a.h6,s=a.h7,k=0;k<64;++k)g=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),h=r^p&(q^r),f=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),i=l&m|n&(l^m),d=s+g+h+j[k]+b[k],e=f+i,s=r,r=q,q=p,p=o+d>>>0,o=n,n=m,m=l,l=d+e>>>0;a.h0=a.h0+l|0,a.h1=a.h1+m|0,a.h2=a.h2+n|0,a.h3=a.h3+o|0,a.h4=a.h4+p|0,a.h5=a.h5+q|0,a.h6=a.h6+r|0,a.h7=a.h7+s|0,t-=64}}var f=a("./forge");a("./md"),a("./util");var g=b.exports=f.sha256=f.sha256||{};f.md.sha256=f.md.algorithms.sha256=g,g.create=function(){i||d();var a=null,b=f.util.createBuffer(),c=new Array(64),g={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return g.start=function(){g.messageLength=0,g.fullMessageLength=g.messageLength64=[];for(var c=g.messageLengthSize/4,d=0;d<c;++d)g.fullMessageLength.push(0);return b=f.util.createBuffer(),a={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},g},g.start(),g.update=function(d,h){"utf8"===h&&(d=f.util.encodeUtf8(d));var i=d.length;g.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var j=g.fullMessageLength.length-1;j>=0;--j)g.fullMessageLength[j]+=i[1],i[1]=i[0]+(g.fullMessageLength[j]/4294967296>>>0),g.fullMessageLength[j]=g.fullMessageLength[j]>>>0,i[0]=i[1]/4294967296>>>0;return b.putBytes(d),e(a,c,b),(b.read>2048||0===b.length())&&b.compact(),g},g.digest=function(){var d=f.util.createBuffer();d.putBytes(b.bytes());var i=g.fullMessageLength[g.fullMessageLength.length-1]+g.messageLengthSize,j=i&g.blockLength-1;d.putBytes(h.substr(0,g.blockLength-j));for(var k,l,m=8*g.fullMessageLength[0],n=0;n<g.fullMessageLength.length-1;++n)k=8*g.fullMessageLength[n+1],l=k/4294967296>>>0,m+=l,d.putInt32(m>>>0),m=k>>>0;d.putInt32(m);var o={h0:a.h0,h1:a.h1,h2:a.h2,h3:a.h3,h4:a.h4,h5:a.h5,h6:a.h6,h7:a.h7};e(o,c,d);var p=f.util.createBuffer();return p.putInt32(o.h0),p.putInt32(o.h1),p.putInt32(o.h2),p.putInt32(o.h3),p.putInt32(o.h4),p.putInt32(o.h5),p.putInt32(o.h6),p.putInt32(o.h7),p},g};var h=null,i=!1,j=null},{"./forge":47,"./md":54,"./util":79}],75:[function(a,b,c){function d(){i=String.fromCharCode(128),i+=f.util.fillString(String.fromCharCode(0),128),k=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],l={},l["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],l["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],l["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],l["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],j=!0}function e(a,b,c){for(var d,e,f,g,h,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=c.length();N>=128;){for(G=0;G<16;++G)b[G][0]=c.getInt32()>>>0,b[G][1]=c.getInt32()>>>0;for(;G<80;++G)J=b[G-2],H=J[0],I=J[1],d=((H>>>19|I<<13)^(I>>>29|H<<3)^H>>>6)>>>0,e=((H<<13|I>>>19)^(I<<3|H>>>29)^(H<<26|I>>>6))>>>0,L=b[G-15],H=L[0],I=L[1],f=((H>>>1|I<<31)^(H>>>8|I<<24)^H>>>7)>>>0,g=((H<<31|I>>>1)^(H<<24|I>>>8)^(H<<25|I>>>7))>>>0,K=b[G-7],M=b[G-16],I=e+K[1]+g+M[1],b[G][0]=d+K[0]+f+M[0]+(I/4294967296>>>0)>>>0,b[G][1]=I>>>0;for(q=a[0][0],r=a[0][1],s=a[1][0],t=a[1][1],u=a[2][0],v=a[2][1],w=a[3][0],x=a[3][1],y=a[4][0],z=a[4][1],A=a[5][0],B=a[5][1],C=a[6][0],D=a[6][1],E=a[7][0],F=a[7][1],G=0;G<80;++G)j=((y>>>14|z<<18)^(y>>>18|z<<14)^(z>>>9|y<<23))>>>0,l=((y<<18|z>>>14)^(y<<14|z>>>18)^(z<<23|y>>>9))>>>0,m=(C^y&(A^C))>>>0,n=(D^z&(B^D))>>>0,h=((q>>>28|r<<4)^(r>>>2|q<<30)^(r>>>7|q<<25))>>>0,i=((q<<4|r>>>28)^(r<<30|q>>>2)^(r<<25|q>>>7))>>>0,o=(q&s|u&(q^s))>>>0,p=(r&t|v&(r^t))>>>0,I=F+l+n+k[G][1]+b[G][1],d=E+j+m+k[G][0]+b[G][0]+(I/4294967296>>>0)>>>0,e=I>>>0,I=i+p,f=h+o+(I/4294967296>>>0)>>>0,g=I>>>0,E=C,F=D,C=A,D=B,A=y,B=z,I=x+e,y=w+d+(I/4294967296>>>0)>>>0,z=I>>>0,w=u,x=v,u=s,v=t,s=q,t=r,I=e+g,q=d+f+(I/4294967296>>>0)>>>0,r=I>>>0;I=a[0][1]+r,a[0][0]=a[0][0]+q+(I/4294967296>>>0)>>>0,a[0][1]=I>>>0,I=a[1][1]+t,a[1][0]=a[1][0]+s+(I/4294967296>>>0)>>>0,a[1][1]=I>>>0,I=a[2][1]+v,a[2][0]=a[2][0]+u+(I/4294967296>>>0)>>>0,a[2][1]=I>>>0,I=a[3][1]+x,a[3][0]=a[3][0]+w+(I/4294967296>>>0)>>>0,a[3][1]=I>>>0,I=a[4][1]+z,a[4][0]=a[4][0]+y+(I/4294967296>>>0)>>>0,a[4][1]=I>>>0,I=a[5][1]+B,a[5][0]=a[5][0]+A+(I/4294967296>>>0)>>>0,a[5][1]=I>>>0,I=a[6][1]+D,a[6][0]=a[6][0]+C+(I/4294967296>>>0)>>>0,a[6][1]=I>>>0,I=a[7][1]+F,a[7][0]=a[7][0]+E+(I/4294967296>>>0)>>>0,a[7][1]=I>>>0,N-=128}}var f=a("./forge");a("./md"),a("./util");var g=b.exports=f.sha512=f.sha512||{};f.md.sha512=f.md.algorithms.sha512=g;var h=f.sha384=f.sha512.sha384=f.sha512.sha384||{};h.create=function(){return g.create("SHA-384")},f.md.sha384=f.md.algorithms.sha384=h,f.sha512.sha256=f.sha512.sha256||{create:function(){return g.create("SHA-512/256")}},f.md["sha512/256"]=f.md.algorithms["sha512/256"]=f.sha512.sha256,f.sha512.sha224=f.sha512.sha224||{create:function(){return g.create("SHA-512/224")}},f.md["sha512/224"]=f.md.algorithms["sha512/224"]=f.sha512.sha224,g.create=function(a){if(j||d(),"undefined"==typeof a&&(a="SHA-512"),!(a in l))throw new Error("Invalid SHA-512 algorithm: "+a);for(var b=l[a],c=null,g=f.util.createBuffer(),h=new Array(80),k=0;k<80;++k)h[k]=new Array(2);var m=64;switch(a){case"SHA-384":m=48;break;case"SHA-512/256":m=32;break;case"SHA-512/224":m=28}var n={algorithm:a.replace("-","").toLowerCase(),blockLength:128,digestLength:m,messageLength:0,fullMessageLength:null,messageLengthSize:16};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength128=[];for(var a=n.messageLengthSize/4,d=0;d<a;++d)n.fullMessageLength.push(0);g=f.util.createBuffer(),c=new Array(b.length);for(var d=0;d<b.length;++d)c[d]=b[d].slice(0);return n},n.start(),n.update=function(a,b){"utf8"===b&&(a=f.util.encodeUtf8(a));var d=a.length;n.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var i=n.fullMessageLength.length-1;i>=0;--i)n.fullMessageLength[i]+=d[1],d[1]=d[0]+(n.fullMessageLength[i]/4294967296>>>0),n.fullMessageLength[i]=n.fullMessageLength[i]>>>0,d[0]=d[1]/4294967296>>>0;return g.putBytes(a),e(c,h,g),(g.read>2048||0===g.length())&&g.compact(),n},n.digest=function(){var b=f.util.createBuffer();b.putBytes(g.bytes());var d=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,j=d&n.blockLength-1;b.putBytes(i.substr(0,n.blockLength-j));for(var k,l,m=8*n.fullMessageLength[0],o=0;o<n.fullMessageLength.length-1;++o)k=8*n.fullMessageLength[o+1],l=k/4294967296>>>0,m+=l,b.putInt32(m>>>0),m=k>>>0;b.putInt32(m);for(var p=new Array(c.length),o=0;o<c.length;++o)p[o]=c[o].slice(0);e(p,h,b);var q,r=f.util.createBuffer();q="SHA-512"===a?p.length:"SHA-384"===a?p.length-2:p.length-4;for(var o=0;o<q;++o)r.putInt32(p[o][0]),o===q-1&&"SHA-512/224"===a||r.putInt32(p[o][1]);return r},n};var i=null,j=!1,k=null,l=null},{"./forge":47,"./md":54,"./util":79}],76:[function(a,b,c){function d(a,b){var c=b.toString(16);c[0]>="8"&&(c="00"+c);var d=g.util.hexToBytes(c);a.putInt32(d.length),a.putBytes(d)}function e(a,b){a.putInt32(b.length),a.putString(b)}function f(){for(var a=g.md.sha1.create(),b=arguments.length,c=0;c<b;++c)a.update(arguments[c]);return a.digest()}var g=a("./forge");a("./aes"),a("./hmac"),a("./md5"),a("./sha1"),a("./util");var h=b.exports=g.ssh=g.ssh||{};h.privateKeyToPutty=function(a,b,c){c=c||"",b=b||"";var h="ssh-rsa",i=""===b?"none":"aes256-cbc",j="PuTTY-User-Key-File-2: "+h+"\r\n";j+="Encryption: "+i+"\r\n",j+="Comment: "+c+"\r\n";var k=g.util.createBuffer();e(k,h),d(k,a.e),d(k,a.n);var l=g.util.encode64(k.bytes(),64),m=Math.floor(l.length/66)+1;j+="Public-Lines: "+m+"\r\n",j+=l;var n=g.util.createBuffer();d(n,a.d),d(n,a.p),d(n,a.q),d(n,a.qInv);var o;if(b){var p=n.length()+16-1;p-=p%16;var q=f(n.bytes());q.truncate(q.length()-p+n.length()),n.putBuffer(q);var r=g.util.createBuffer();r.putBuffer(f("\0\0\0\0",b)),r.putBuffer(f("\0\0\0",b));var s=g.aes.createEncryptionCipher(r.truncate(8),"CBC");s.start(g.util.createBuffer().fillWithByte(0,16)),s.update(n.copy()),s.finish();var t=s.output;t.truncate(16),o=g.util.encode64(t.bytes(),64)}else o=g.util.encode64(n.bytes(),64);m=Math.floor(o.length/66)+1,j+="\r\nPrivate-Lines: "+m+"\r\n",j+=o;var u=f("putty-private-key-file-mac-key",b),v=g.util.createBuffer();e(v,h),e(v,i),e(v,c),v.putInt32(k.length()),v.putBuffer(k),v.putInt32(n.length()),v.putBuffer(n);var w=g.hmac.create();return w.start("sha1",u),w.update(v.bytes()),j+="\r\nPrivate-MAC: "+w.digest().toHex()+"\r\n"},h.publicKeyToOpenSSH=function(a,b){var c="ssh-rsa";b=b||"";var f=g.util.createBuffer();return e(f,c),d(f,a.e),d(f,a.n),c+" "+g.util.encode64(f.bytes())+" "+b},h.privateKeyToOpenSSH=function(a,b){return b?g.pki.encryptRsaPrivateKey(a,b,{legacy:!0,algorithm:"aes128"}):g.pki.privateKeyToPem(a)},h.getPublicKeyFingerprint=function(a,b){b=b||{};var c=b.md||g.md.md5.create(),f="ssh-rsa",h=g.util.createBuffer();e(h,f),d(h,a.e),d(h,a.n),c.start(),c.update(h.getBytes());var i=c.digest();if("hex"===b.encoding){var j=i.toHex();return b.delimiter?j.match(/.{2}/g).join(b.delimiter):j}if("binary"===b.encoding)return i.getBytes();if(b.encoding)throw new Error('Unknown encoding "'+b.encoding+'".');return i}},{"./aes":37,"./forge":47,"./hmac":48,"./md5":55,"./sha1":73,"./util":79}],77:[function(a,b,c){var d=a("./forge");a("./debug"),a("./log"),a("./util");var e="forge.task",f=0,g={},h=0;d.debug.set(e,"tasks",g);var i={};d.debug.set(e,"queues",i);var j="?",k=30,l=20,m="ready",n="running",o="blocked",p="sleeping",q="done",r="error",s="stop",t="start",u="block",v="unblock",w="sleep",x="wakeup",y="cancel",z="fail",A={};A[m]={},A[m][s]=m,A[m][t]=n,A[m][y]=q,A[m][z]=r,A[n]={},A[n][s]=m,A[n][t]=n,A[n][u]=o,A[n][v]=n,A[n][w]=p,A[n][x]=n,A[n][y]=q,A[n][z]=r,A[o]={},A[o][s]=o,A[o][t]=o,A[o][u]=o,A[o][v]=o,A[o][w]=o,A[o][x]=o,A[o][y]=q,A[o][z]=r,A[p]={},A[p][s]=p,A[p][t]=p,A[p][u]=p,A[p][v]=p,A[p][w]=p,A[p][x]=p,A[p][y]=q,A[p][z]=r,A[q]={},A[q][s]=q,A[q][t]=q,A[q][u]=q,A[q][v]=q,A[q][w]=q,A[q][x]=q,A[q][y]=q,A[q][z]=r,A[r]={},A[r][s]=r,A[r][t]=r,A[r][u]=r,A[r][v]=r,A[r][w]=r,A[r][x]=r,A[r][y]=r,A[r][z]=r;var B=function(a){this.id=-1,this.name=a.name||j,this.parent=a.parent||null,this.run=a.run,this.subtasks=[],this.error=!1,this.state=m,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=h++,g[this.id]=this,f>=1&&d.log.verbose(e,"[%s][%s] init",this.id,this.name,this)};B.prototype.debug=function(a){a=a||"",d.log.debug(e,a,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",i)},B.prototype.next=function(a,b){"function"==typeof a&&(b=a,a=this.name);var c=new B({run:b,name:a,parent:this});return c.state=n,c.type=this.type,c.successCallback=this.successCallback||null,c.failureCallback=this.failureCallback||null,this.subtasks.push(c),this},B.prototype.parallel=function(a,b){return d.util.isArray(a)&&(b=a,a=this.name),this.next(a,function(c){var e=c;e.block(b.length);for(var f=function(a,c){d.task.start({type:a,run:function(a){b[c](a)},success:function(a){e.unblock()},failure:function(a){e.unblock()}})},g=0;g<b.length;g++){var h=a+"__parallel-"+c.id+"-"+g,i=g;f(h,i)}})},B.prototype.stop=function(){this.state=A[this.state][s]},B.prototype.start=function(){this.error=!1,this.state=A[this.state][t],this.state===n&&(this.start=new Date,this.run(this),D(this,0))},B.prototype.block=function(a){a="undefined"==typeof a?1:a,this.blocks+=a,this.blocks>0&&(this.state=A[this.state][u])},B.prototype.unblock=function(a){return a="undefined"==typeof a?1:a,this.blocks-=a,0===this.blocks&&this.state!==q&&(this.state=n,D(this,0)),this.blocks},B.prototype.sleep=function(a){a="undefined"==typeof a?0:a,this.state=A[this.state][w];var b=this;this.timeoutId=setTimeout(function(){b.timeoutId=null,b.state=n,D(b,0)},a)},B.prototype.wait=function(a){a.wait(this)},B.prototype.wakeup=function(){this.state===p&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=n,D(this,0))},B.prototype.cancel=function(){this.state=A[this.state][y],this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},B.prototype.fail=function(a){if(this.error=!0,E(this,!0),a)a.error=this.error,a.swapTime=this.swapTime,a.userData=this.userData,D(a,0);else{if(null!==this.parent){for(var b=this.parent;null!==b.parent;)b.error=this.error,b.swapTime=this.swapTime,b.userData=this.userData,b=b.parent;E(b,!0)}this.failureCallback&&this.failureCallback(this)}};var C=function(a){a.error=!1,a.state=A[a.state][t],setTimeout(function(){a.state===n&&(a.swapTime=+new Date,a.run(a),D(a,0))},0)},D=function(a,b){var c=b>k||+new Date-a.swapTime>l,d=function(b){if(b++,a.state===n)if(c&&(a.swapTime=+new Date),a.subtasks.length>0){var d=a.subtasks.shift();d.error=a.error,d.swapTime=a.swapTime,d.userData=a.userData,d.run(d),d.error||D(d,b)}else E(a),a.error||null!==a.parent&&(a.parent.error=a.error,a.parent.swapTime=a.swapTime,a.parent.userData=a.userData,D(a.parent,b))};c?setTimeout(d,0):d(b)},E=function(a,b){a.state=q,delete g[a.id],f>=1&&d.log.verbose(e,"[%s][%s] finish",a.id,a.name,a),null===a.parent&&(a.type in i?0===i[a.type].length?d.log.error(e,"[%s][%s] task queue empty [%s]",a.id,a.name,a.type):i[a.type][0]!==a?d.log.error(e,"[%s][%s] task not first in queue [%s]",a.id,a.name,a.type):(i[a.type].shift(),0===i[a.type].length?(f>=1&&d.log.verbose(e,"[%s][%s] delete queue [%s]",a.id,a.name,a.type),delete i[a.type]):(f>=1&&d.log.verbose(e,"[%s][%s] queue start next [%s] remain:%s",a.id,a.name,a.type,i[a.type].length),i[a.type][0].start())):d.log.error(e,"[%s][%s] task queue missing [%s]",a.id,a.name,a.type),b||(a.error&&a.failureCallback?a.failureCallback(a):!a.error&&a.successCallback&&a.successCallback(a)))};b.exports=d.task=d.task||{},d.task.start=function(a){var b=new B({run:a.run,name:a.name||j});b.type=a.type,b.successCallback=a.success||null,b.failureCallback=a.failure||null,b.type in i?i[a.type].push(b):(f>=1&&d.log.verbose(e,"[%s][%s] create queue [%s]",b.id,b.name,b.type),i[b.type]=[b],C(b))},d.task.cancel=function(a){a in i&&(i[a]=[i[a][0]])},d.task.createCondition=function(){var a={tasks:{}};return a.wait=function(b){b.id in a.tasks||(b.block(),a.tasks[b.id]=b)},a.notify=function(){var b=a.tasks;a.tasks={};for(var c in b)b[c].unblock()},a}},{"./debug":44,"./forge":47,"./log":52,"./util":79}],78:[function(a,b,c){var d=a("./forge");a("./asn1"),a("./hmac"),a("./md5"),a("./pem"),a("./pki"),a("./random"),a("./sha1"),a("./util");var e=function(a,b,c,e){var f=d.util.createBuffer(),g=a.length>>1,h=g+(1&a.length),i=a.substr(0,h),j=a.substr(g,h),k=d.util.createBuffer(),l=d.hmac.create();c=b+c;var m=Math.ceil(e/16),n=Math.ceil(e/20);l.start("MD5",i);var o=d.util.createBuffer();k.putBytes(c);for(var p=0;p<m;++p)l.start(null,null),l.update(k.getBytes()),k.putBuffer(l.digest()),l.start(null,null),l.update(k.bytes()+c),o.putBuffer(l.digest());l.start("SHA1",j);var q=d.util.createBuffer();k.clear(),k.putBytes(c);for(var p=0;p<n;++p)l.start(null,null),l.update(k.getBytes()),k.putBuffer(l.digest()),l.start(null,null),l.update(k.bytes()+c),q.putBuffer(l.digest());return f.putBytes(d.util.xorBytes(o.getBytes(),q.getBytes(),e)),f},f=function(a,b,c){var e=d.hmac.create();e.start("SHA1",a);var f=d.util.createBuffer();return f.putInt32(b[0]),f.putInt32(b[1]),f.putByte(c.type),f.putByte(c.version.major),f.putByte(c.version.minor),f.putInt16(c.length),f.putBytes(c.fragment.bytes()),e.update(f.getBytes()),e.digest().getBytes()},g=function(a,b,c){var e=!1;try{var f=a.deflate(b.fragment.getBytes());b.fragment=d.util.createBuffer(f),b.length=f.length,e=!0}catch(g){}return e},h=function(a,b,c){var e=!1;try{var f=a.inflate(b.fragment.getBytes());b.fragment=d.util.createBuffer(f),b.length=f.length,e=!0}catch(g){}return e},i=function(a,b){var c=0;switch(b){case 1:c=a.getByte();break;case 2:c=a.getInt16();break;case 3:c=a.getInt24();break;case 4:c=a.getInt32()}return d.util.createBuffer(a.getBytes(c))},j=function(a,b,c){a.putInt(c.length(),b<<3),a.putBuffer(c)},k={};k.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},k.SupportedVersions=[k.Versions.TLS_1_1,k.Versions.TLS_1_0],k.Version=k.SupportedVersions[0],k.MaxFragment=15360,k.ConnectionEnd={server:0,client:1},k.PRFAlgorithm={tls_prf_sha256:0},k.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},k.CipherType={stream:0,block:1,aead:2},k.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},k.CompressionMethod={none:0,deflate:1},k.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},k.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},k.Alert={},k.Alert.Level={warning:1,fatal:2},k.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},k.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},k.CipherSuites={},k.getCipherSuite=function(a){var b=null;for(var c in k.CipherSuites){var d=k.CipherSuites[c];if(d.id[0]===a.charCodeAt(0)&&d.id[1]===a.charCodeAt(1)){b=d;break}}return b},k.handleUnexpected=function(a,b){var c=!a.open&&a.entity===k.ConnectionEnd.client;c||a.error(a,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.unexpected_message}})},k.handleHelloRequest=function(a,b,c){!a.handshaking&&a.handshakes>0&&(k.queue(a,k.createAlert(a,{level:k.Alert.Level.warning,description:k.Alert.Description.no_renegotiation})),k.flush(a)),a.process()},k.parseHelloMessage=function(a,b,c){var e=null,f=a.entity===k.ConnectionEnd.client;if(c<38)a.error(a,{message:f?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.illegal_parameter}});else{var g=b.fragment,h=g.length();if(e={version:{major:g.getByte(),minor:g.getByte()},random:d.util.createBuffer(g.getBytes(32)),session_id:i(g,1),extensions:[]},f?(e.cipher_suite=g.getBytes(2),e.compression_method=g.getByte()):(e.cipher_suites=i(g,2),e.compression_methods=i(g,1)),h=c-(h-g.length()),h>0){for(var j=i(g,2);j.length()>0;)e.extensions.push({type:[j.getByte(),j.getByte()],data:i(j,2)});if(!f)for(var l=0;l<e.extensions.length;++l){var m=e.extensions[l];if(0===m.type[0]&&0===m.type[1])for(var n=i(m.data,2);n.length()>0;){var o=n.getByte();if(0!==o)break;a.session.extensions.server_name.serverNameList.push(i(n,2).getBytes())}}}if(a.session.version&&(e.version.major!==a.session.version.major||e.version.minor!==a.session.version.minor))return a.error(a,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.protocol_version}});if(f)a.session.cipherSuite=k.getCipherSuite(e.cipher_suite);else for(var p=d.util.createBuffer(e.cipher_suites.bytes());p.length()>0&&(a.session.cipherSuite=k.getCipherSuite(p.getBytes(2)),null===a.session.cipherSuite););if(null===a.session.cipherSuite)return a.error(a,{message:"No cipher suites in common.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.handshake_failure},cipherSuite:d.util.bytesToHex(e.cipher_suite)});f?a.session.compressionMethod=e.compression_method:a.session.compressionMethod=k.CompressionMethod.none}return e},k.createSecurityParameters=function(a,b){var c=a.entity===k.ConnectionEnd.client,d=b.random.bytes(),e=c?a.session.sp.client_random:d,f=c?d:k.createRandom().getBytes();a.session.sp={entity:a.entity,prf_algorithm:k.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,
cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:a.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:e,server_random:f}},k.handleServerHello=function(a,b,c){var d=k.parseHelloMessage(a,b,c);if(!a.fail){if(!(d.version.minor<=a.version.minor))return a.error(a,{message:"Incompatible TLS version.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.protocol_version}});a.version.minor=d.version.minor,a.session.version=a.version;var e=d.session_id.bytes();e.length>0&&e===a.session.id?(a.expect=q,a.session.resuming=!0,a.session.sp.server_random=d.random.bytes()):(a.expect=m,a.session.resuming=!1,k.createSecurityParameters(a,d)),a.session.id=e,a.process()}},k.handleClientHello=function(a,b,c){var e=k.parseHelloMessage(a,b,c);if(!a.fail){var f=e.session_id.bytes(),g=null;if(a.sessionCache&&(g=a.sessionCache.getSession(f),null===g?f="":(g.version.major!==e.version.major||g.version.minor>e.version.minor)&&(g=null,f="")),0===f.length&&(f=d.random.getBytes(32)),a.session.id=f,a.session.clientHelloVersion=e.version,a.session.sp={},g)a.version=a.session.version=g.version,a.session.sp=g.sp;else{for(var h,i=1;i<k.SupportedVersions.length&&(h=k.SupportedVersions[i],!(h.minor<=e.version.minor));++i);a.version={major:h.major,minor:h.minor},a.session.version=a.version}null!==g?(a.expect=y,a.session.resuming=!0,a.session.sp.client_random=e.random.bytes()):(a.expect=a.verifyClient!==!1?v:w,a.session.resuming=!1,k.createSecurityParameters(a,e)),a.open=!0,k.queue(a,k.createRecord(a,{type:k.ContentType.handshake,data:k.createServerHello(a)})),a.session.resuming?(k.queue(a,k.createRecord(a,{type:k.ContentType.change_cipher_spec,data:k.createChangeCipherSpec()})),a.state.pending=k.createConnectionState(a),a.state.current.write=a.state.pending.write,k.queue(a,k.createRecord(a,{type:k.ContentType.handshake,data:k.createFinished(a)}))):(k.queue(a,k.createRecord(a,{type:k.ContentType.handshake,data:k.createCertificate(a)})),a.fail||(k.queue(a,k.createRecord(a,{type:k.ContentType.handshake,data:k.createServerKeyExchange(a)})),a.verifyClient!==!1&&k.queue(a,k.createRecord(a,{type:k.ContentType.handshake,data:k.createCertificateRequest(a)})),k.queue(a,k.createRecord(a,{type:k.ContentType.handshake,data:k.createServerHelloDone(a)})))),k.flush(a),a.process()}},k.handleCertificate=function(a,b,c){if(c<3)return a.error(a,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.illegal_parameter}});var e,f,g=b.fragment,h={certificate_list:i(g,3)},j=[];try{for(;h.certificate_list.length()>0;)e=i(h.certificate_list,3),f=d.asn1.fromDer(e),e=d.pki.certificateFromAsn1(f,!0),j.push(e)}catch(l){return a.error(a,{message:"Could not parse certificate list.",cause:l,send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.bad_certificate}})}var m=a.entity===k.ConnectionEnd.client;!m&&a.verifyClient!==!0||0!==j.length?0===j.length?a.expect=m?n:w:(m?a.session.serverCertificate=j[0]:a.session.clientCertificate=j[0],k.verifyCertificateChain(a,j)&&(a.expect=m?n:w)):a.error(a,{message:m?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.illegal_parameter}}),a.process()},k.handleServerKeyExchange=function(a,b,c){return c>0?a.error(a,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.unsupported_certificate}}):(a.expect=o,void a.process())},k.handleClientKeyExchange=function(a,b,c){if(c<48)return a.error(a,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.unsupported_certificate}});var e=b.fragment,f={enc_pre_master_secret:i(e,2).getBytes()},g=null;if(a.getPrivateKey)try{g=a.getPrivateKey(a,a.session.serverCertificate),g=d.pki.privateKeyFromPem(g)}catch(h){a.error(a,{message:"Could not get private key.",cause:h,send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.internal_error}})}if(null===g)return a.error(a,{message:"No private key set.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.internal_error}});try{var j=a.session.sp;j.pre_master_secret=g.decrypt(f.enc_pre_master_secret);var l=a.session.clientHelloVersion;if(l.major!==j.pre_master_secret.charCodeAt(0)||l.minor!==j.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(h){j.pre_master_secret=d.random.getBytes(48)}a.expect=y,null!==a.session.clientCertificate&&(a.expect=x),a.process()},k.handleCertificateRequest=function(a,b,c){if(c<3)return a.error(a,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.illegal_parameter}});var d=b.fragment,e={certificate_types:i(d,1),certificate_authorities:i(d,2)};a.session.certificateRequest=e,a.expect=p,a.process()},k.handleCertificateVerify=function(a,b,c){if(c<2)return a.error(a,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.illegal_parameter}});var e=b.fragment;e.read-=4;var f=e.bytes();e.read+=4;var g={signature:i(e,2).getBytes()},h=d.util.createBuffer();h.putBuffer(a.session.md5.digest()),h.putBuffer(a.session.sha1.digest()),h=h.getBytes();try{var j=a.session.clientCertificate;if(!j.publicKey.verify(h,g.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");a.session.md5.update(f),a.session.sha1.update(f)}catch(l){return a.error(a,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.handshake_failure}})}a.expect=y,a.process()},k.handleServerHelloDone=function(a,b,c){if(c>0)return a.error(a,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.record_overflow}});if(null===a.serverCertificate){var e={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.insufficient_security}},f=0,g=a.verify(a,e.alert.description,f,[]);if(g!==!0)return(g||0===g)&&("object"!=typeof g||d.util.isArray(g)?"number"==typeof g&&(e.alert.description=g):(g.message&&(e.message=g.message),g.alert&&(e.alert.description=g.alert))),a.error(a,e)}null!==a.session.certificateRequest&&(b=k.createRecord(a,{type:k.ContentType.handshake,data:k.createCertificate(a)}),k.queue(a,b)),b=k.createRecord(a,{type:k.ContentType.handshake,data:k.createClientKeyExchange(a)}),k.queue(a,b),a.expect=t;var h=function(a,b){null!==a.session.certificateRequest&&null!==a.session.clientCertificate&&k.queue(a,k.createRecord(a,{type:k.ContentType.handshake,data:k.createCertificateVerify(a,b)})),k.queue(a,k.createRecord(a,{type:k.ContentType.change_cipher_spec,data:k.createChangeCipherSpec()})),a.state.pending=k.createConnectionState(a),a.state.current.write=a.state.pending.write,k.queue(a,k.createRecord(a,{type:k.ContentType.handshake,data:k.createFinished(a)})),a.expect=q,k.flush(a),a.process()};return null===a.session.certificateRequest||null===a.session.clientCertificate?h(a,null):void k.getClientSignature(a,h)},k.handleChangeCipherSpec=function(a,b){if(1!==b.fragment.getByte())return a.error(a,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.illegal_parameter}});var c=a.entity===k.ConnectionEnd.client;(a.session.resuming&&c||!a.session.resuming&&!c)&&(a.state.pending=k.createConnectionState(a)),a.state.current.read=a.state.pending.read,(!a.session.resuming&&c||a.session.resuming&&!c)&&(a.state.pending=null),a.expect=c?r:z,a.process()},k.handleFinished=function(a,b,c){var f=b.fragment;f.read-=4;var g=f.bytes();f.read+=4;var h=b.fragment.getBytes();f=d.util.createBuffer(),f.putBuffer(a.session.md5.digest()),f.putBuffer(a.session.sha1.digest());var i=a.entity===k.ConnectionEnd.client,j=i?"server finished":"client finished",l=a.session.sp,m=12,n=e;return f=n(l.master_secret,j,f.getBytes(),m),f.getBytes()!==h?a.error(a,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.decrypt_error}}):(a.session.md5.update(g),a.session.sha1.update(g),(a.session.resuming&&i||!a.session.resuming&&!i)&&(k.queue(a,k.createRecord(a,{type:k.ContentType.change_cipher_spec,data:k.createChangeCipherSpec()})),a.state.current.write=a.state.pending.write,a.state.pending=null,k.queue(a,k.createRecord(a,{type:k.ContentType.handshake,data:k.createFinished(a)}))),a.expect=i?s:A,a.handshaking=!1,++a.handshakes,a.peerCertificate=i?a.session.serverCertificate:a.session.clientCertificate,k.flush(a),a.isConnected=!0,a.connected(a),void a.process())},k.handleAlert=function(a,b){var c,d=b.fragment,e={level:d.getByte(),description:d.getByte()};switch(e.description){case k.Alert.Description.close_notify:c="Connection closed.";break;case k.Alert.Description.unexpected_message:c="Unexpected message.";break;case k.Alert.Description.bad_record_mac:c="Bad record MAC.";break;case k.Alert.Description.decryption_failed:c="Decryption failed.";break;case k.Alert.Description.record_overflow:c="Record overflow.";break;case k.Alert.Description.decompression_failure:c="Decompression failed.";break;case k.Alert.Description.handshake_failure:c="Handshake failure.";break;case k.Alert.Description.bad_certificate:c="Bad certificate.";break;case k.Alert.Description.unsupported_certificate:c="Unsupported certificate.";break;case k.Alert.Description.certificate_revoked:c="Certificate revoked.";break;case k.Alert.Description.certificate_expired:c="Certificate expired.";break;case k.Alert.Description.certificate_unknown:c="Certificate unknown.";break;case k.Alert.Description.illegal_parameter:c="Illegal parameter.";break;case k.Alert.Description.unknown_ca:c="Unknown certificate authority.";break;case k.Alert.Description.access_denied:c="Access denied.";break;case k.Alert.Description.decode_error:c="Decode error.";break;case k.Alert.Description.decrypt_error:c="Decrypt error.";break;case k.Alert.Description.export_restriction:c="Export restriction.";break;case k.Alert.Description.protocol_version:c="Unsupported protocol version.";break;case k.Alert.Description.insufficient_security:c="Insufficient security.";break;case k.Alert.Description.internal_error:c="Internal error.";break;case k.Alert.Description.user_canceled:c="User canceled.";break;case k.Alert.Description.no_renegotiation:c="Renegotiation not supported.";break;default:c="Unknown error."}return e.description===k.Alert.Description.close_notify?a.close():(a.error(a,{message:c,send:!1,origin:a.entity===k.ConnectionEnd.client?"server":"client",alert:e}),void a.process())},k.handleHandshake=function(a,b){var c=b.fragment,e=c.getByte(),f=c.getInt24();if(f>c.length())return a.fragmented=b,b.fragment=d.util.createBuffer(),c.read-=4,a.process();a.fragmented=null,c.read-=4;var g=c.bytes(f+4);c.read+=4,e in P[a.entity][a.expect]?(a.entity!==k.ConnectionEnd.server||a.open||a.fail||(a.handshaking=!0,a.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:d.md.md5.create(),sha1:d.md.sha1.create()}),e!==k.HandshakeType.hello_request&&e!==k.HandshakeType.certificate_verify&&e!==k.HandshakeType.finished&&(a.session.md5.update(g),a.session.sha1.update(g)),P[a.entity][a.expect][e](a,b,f)):k.handleUnexpected(a,b)},k.handleApplicationData=function(a,b){a.data.putBuffer(b.fragment),a.dataReady(a),a.process()},k.handleHeartbeat=function(a,b){var c=b.fragment,e=c.getByte(),f=c.getInt16(),g=c.getBytes(f);if(e===k.HeartbeatMessageType.heartbeat_request){if(a.handshaking||f>g.length)return a.process();k.queue(a,k.createRecord(a,{type:k.ContentType.heartbeat,data:k.createHeartbeat(k.HeartbeatMessageType.heartbeat_response,g)})),k.flush(a)}else if(e===k.HeartbeatMessageType.heartbeat_response){if(g!==a.expectedHeartbeatPayload)return a.process();a.heartbeatReceived&&a.heartbeatReceived(a,d.util.createBuffer(g))}a.process()};var l=0,m=1,n=2,o=3,p=4,q=5,r=6,s=7,t=8,u=0,v=1,w=2,x=3,y=4,z=5,A=6,B=k.handleUnexpected,C=k.handleChangeCipherSpec,D=k.handleAlert,E=k.handleHandshake,F=k.handleApplicationData,G=k.handleHeartbeat,H=[];H[k.ConnectionEnd.client]=[[B,D,E,B,G],[B,D,E,B,G],[B,D,E,B,G],[B,D,E,B,G],[B,D,E,B,G],[C,D,B,B,G],[B,D,E,B,G],[B,D,E,F,G],[B,D,E,B,G]],H[k.ConnectionEnd.server]=[[B,D,E,B,G],[B,D,E,B,G],[B,D,E,B,G],[B,D,E,B,G],[C,D,B,B,G],[B,D,E,B,G],[B,D,E,F,G],[B,D,E,B,G]];var I=k.handleHelloRequest,J=k.handleServerHello,K=k.handleCertificate,L=k.handleServerKeyExchange,M=k.handleCertificateRequest,N=k.handleServerHelloDone,O=k.handleFinished,P=[];P[k.ConnectionEnd.client]=[[B,B,J,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[I,B,B,B,B,B,B,B,B,B,B,K,L,M,N,B,B,B,B,B,B],[I,B,B,B,B,B,B,B,B,B,B,B,L,M,N,B,B,B,B,B,B],[I,B,B,B,B,B,B,B,B,B,B,B,B,M,N,B,B,B,B,B,B],[I,B,B,B,B,B,B,B,B,B,B,B,B,B,N,B,B,B,B,B,B],[I,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[I,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,O],[I,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[I,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B]];var Q=k.handleClientHello,R=k.handleClientKeyExchange,S=k.handleCertificateVerify;P[k.ConnectionEnd.server]=[[B,Q,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,K,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,R,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,S,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,O],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B]],k.generateKeys=function(a,b){var c=e,d=b.client_random+b.server_random;a.session.resuming||(b.master_secret=c(b.pre_master_secret,"master secret",d,48).bytes(),b.pre_master_secret=null),d=b.server_random+b.client_random;var f=2*b.mac_key_length+2*b.enc_key_length,g=a.version.major===k.Versions.TLS_1_0.major&&a.version.minor===k.Versions.TLS_1_0.minor;g&&(f+=2*b.fixed_iv_length);var h=c(b.master_secret,"key expansion",d,f),i={client_write_MAC_key:h.getBytes(b.mac_key_length),server_write_MAC_key:h.getBytes(b.mac_key_length),client_write_key:h.getBytes(b.enc_key_length),server_write_key:h.getBytes(b.enc_key_length)};return g&&(i.client_write_IV=h.getBytes(b.fixed_iv_length),i.server_write_IV=h.getBytes(b.fixed_iv_length)),i},k.createConnectionState=function(a){var b=a.entity===k.ConnectionEnd.client,c=function(){var a={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(a){return!0},compressionState:null,compressFunction:function(a){return!0},updateSequenceNumber:function(){4294967295===a.sequenceNumber[1]?(a.sequenceNumber[1]=0,++a.sequenceNumber[0]):++a.sequenceNumber[1]}};return a},d={read:c(),write:c()};if(d.read.update=function(a,b){return d.read.cipherFunction(b,d.read)?d.read.compressFunction(a,b,d.read)||a.error(a,{message:"Could not decompress record.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.decompression_failure}}):a.error(a,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.bad_record_mac}}),!a.fail},d.write.update=function(a,b){return d.write.compressFunction(a,b,d.write)?d.write.cipherFunction(b,d.write)||a.error(a,{message:"Could not encrypt record.",send:!1,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.internal_error}}):a.error(a,{message:"Could not compress record.",send:!1,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.internal_error}}),!a.fail},a.session){var e=a.session.sp;switch(a.session.cipherSuite.initSecurityParameters(e),e.keys=k.generateKeys(a,e),d.read.macKey=b?e.keys.server_write_MAC_key:e.keys.client_write_MAC_key,d.write.macKey=b?e.keys.client_write_MAC_key:e.keys.server_write_MAC_key,a.session.cipherSuite.initConnectionState(d,a,e),e.compression_algorithm){case k.CompressionMethod.none:break;case k.CompressionMethod.deflate:d.read.compressFunction=h,d.write.compressFunction=g;break;default:throw new Error("Unsupported compression algorithm.")}}return d},k.createRandom=function(){var a=new Date,b=+a+6e4*a.getTimezoneOffset(),c=d.util.createBuffer();return c.putInt32(b),c.putBytes(d.random.getBytes(28)),c},k.createRecord=function(a,b){if(!b.data)return null;var c={type:b.type,version:{major:a.version.major,minor:a.version.minor},length:b.data.length(),fragment:b.data};return c},k.createAlert=function(a,b){var c=d.util.createBuffer();return c.putByte(b.level),c.putByte(b.description),k.createRecord(a,{type:k.ContentType.alert,data:c})},k.createClientHello=function(a){a.session.clientHelloVersion={major:a.version.major,minor:a.version.minor};for(var b=d.util.createBuffer(),c=0;c<a.cipherSuites.length;++c){var e=a.cipherSuites[c];b.putByte(e.id[0]),b.putByte(e.id[1])}var f=b.length(),g=d.util.createBuffer();g.putByte(k.CompressionMethod.none);var h=g.length(),i=d.util.createBuffer();if(a.virtualHost){var l=d.util.createBuffer();l.putByte(0),l.putByte(0);var m=d.util.createBuffer();m.putByte(0),j(m,2,d.util.createBuffer(a.virtualHost));var n=d.util.createBuffer();j(n,2,m),j(l,2,n),i.putBuffer(l)}var o=i.length();o>0&&(o+=2);var p=a.session.id,q=p.length+1+2+4+28+2+f+1+h+o,r=d.util.createBuffer();return r.putByte(k.HandshakeType.client_hello),r.putInt24(q),r.putByte(a.version.major),r.putByte(a.version.minor),r.putBytes(a.session.sp.client_random),j(r,1,d.util.createBuffer(p)),j(r,2,b),j(r,1,g),o>0&&j(r,2,i),r},k.createServerHello=function(a){var b=a.session.id,c=b.length+1+2+4+28+2+1,e=d.util.createBuffer();return e.putByte(k.HandshakeType.server_hello),e.putInt24(c),e.putByte(a.version.major),e.putByte(a.version.minor),e.putBytes(a.session.sp.server_random),j(e,1,d.util.createBuffer(b)),e.putByte(a.session.cipherSuite.id[0]),e.putByte(a.session.cipherSuite.id[1]),e.putByte(a.session.compressionMethod),e},k.createCertificate=function(a){var b=a.entity===k.ConnectionEnd.client,c=null;if(a.getCertificate){var e;e=b?a.session.certificateRequest:a.session.extensions.server_name.serverNameList,c=a.getCertificate(a,e)}var f=d.util.createBuffer();if(null!==c)try{d.util.isArray(c)||(c=[c]);for(var g=null,h=0;h<c.length;++h){var i=d.pem.decode(c[h])[0];if("CERTIFICATE"!==i.type&&"X509 CERTIFICATE"!==i.type&&"TRUSTED CERTIFICATE"!==i.type){var l=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw l.headerType=i.type,l}if(i.procType&&"ENCRYPTED"===i.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var m=d.util.createBuffer(i.body);null===g&&(g=d.asn1.fromDer(m.bytes(),!1));var n=d.util.createBuffer();j(n,3,m),f.putBuffer(n)}c=d.pki.certificateFromAsn1(g),b?a.session.clientCertificate=c:a.session.serverCertificate=c}catch(o){return a.error(a,{message:"Could not send certificate list.",cause:o,send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.bad_certificate}})}var p=3+f.length(),q=d.util.createBuffer();return q.putByte(k.HandshakeType.certificate),q.putInt24(p),j(q,3,f),q},k.createClientKeyExchange=function(a){var b=d.util.createBuffer();b.putByte(a.session.clientHelloVersion.major),b.putByte(a.session.clientHelloVersion.minor),b.putBytes(d.random.getBytes(46));var c=a.session.sp;c.pre_master_secret=b.getBytes();var e=a.session.serverCertificate.publicKey;b=e.encrypt(c.pre_master_secret);var f=b.length+2,g=d.util.createBuffer();return g.putByte(k.HandshakeType.client_key_exchange),g.putInt24(f),g.putInt16(b.length),g.putBytes(b),g},k.createServerKeyExchange=function(a){var b=0,c=d.util.createBuffer();return b>0&&(c.putByte(k.HandshakeType.server_key_exchange),c.putInt24(b)),c},k.getClientSignature=function(a,b){var c=d.util.createBuffer();c.putBuffer(a.session.md5.digest()),c.putBuffer(a.session.sha1.digest()),c=c.getBytes(),a.getSignature=a.getSignature||function(a,b,c){var e=null;if(a.getPrivateKey)try{e=a.getPrivateKey(a,a.session.clientCertificate),e=d.pki.privateKeyFromPem(e)}catch(f){a.error(a,{message:"Could not get private key.",cause:f,send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.internal_error}})}null===e?a.error(a,{message:"No private key set.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.internal_error}}):b=e.sign(b,null),c(a,b)},a.getSignature(a,c,b)},k.createCertificateVerify=function(a,b){var c=b.length+2,e=d.util.createBuffer();return e.putByte(k.HandshakeType.certificate_verify),e.putInt24(c),e.putInt16(b.length),e.putBytes(b),e},k.createCertificateRequest=function(a){var b=d.util.createBuffer();b.putByte(1);var c=d.util.createBuffer();for(var e in a.caStore.certs){var f=a.caStore.certs[e],g=d.pki.distinguishedNameToAsn1(f.subject),h=d.asn1.toDer(g);c.putInt16(h.length()),c.putBuffer(h)}var i=1+b.length()+2+c.length(),l=d.util.createBuffer();return l.putByte(k.HandshakeType.certificate_request),l.putInt24(i),j(l,1,b),j(l,2,c),l},k.createServerHelloDone=function(a){var b=d.util.createBuffer();return b.putByte(k.HandshakeType.server_hello_done),b.putInt24(0),b},k.createChangeCipherSpec=function(){var a=d.util.createBuffer();return a.putByte(1),a},k.createFinished=function(a){var b=d.util.createBuffer();b.putBuffer(a.session.md5.digest()),b.putBuffer(a.session.sha1.digest());var c=a.entity===k.ConnectionEnd.client,f=a.session.sp,g=12,h=e,i=c?"client finished":"server finished";b=h(f.master_secret,i,b.getBytes(),g);var j=d.util.createBuffer();return j.putByte(k.HandshakeType.finished),j.putInt24(b.length()),j.putBuffer(b),j},k.createHeartbeat=function(a,b,c){"undefined"==typeof c&&(c=b.length);var e=d.util.createBuffer();e.putByte(a),e.putInt16(c),e.putBytes(b);var f=e.length(),g=Math.max(16,f-c-3);return e.putBytes(d.random.getBytes(g)),e},k.queue=function(a,b){if(b&&(0!==b.fragment.length()||b.type!==k.ContentType.handshake&&b.type!==k.ContentType.alert&&b.type!==k.ContentType.change_cipher_spec)){if(b.type===k.ContentType.handshake){var c=b.fragment.bytes();a.session.md5.update(c),a.session.sha1.update(c),c=null}var e;if(b.fragment.length()<=k.MaxFragment)e=[b];else{e=[];for(var f=b.fragment.bytes();f.length>k.MaxFragment;)e.push(k.createRecord(a,{type:b.type,data:d.util.createBuffer(f.slice(0,k.MaxFragment))})),f=f.slice(k.MaxFragment);f.length>0&&e.push(k.createRecord(a,{type:b.type,data:d.util.createBuffer(f)}))}for(var g=0;g<e.length&&!a.fail;++g){var h=e[g],i=a.state.current.write;i.update(a,h)&&a.records.push(h)}}},k.flush=function(a){for(var b=0;b<a.records.length;++b){var c=a.records[b];a.tlsData.putByte(c.type),a.tlsData.putByte(c.version.major),a.tlsData.putByte(c.version.minor),a.tlsData.putInt16(c.fragment.length()),a.tlsData.putBuffer(a.records[b].fragment)}return a.records=[],a.tlsDataReady(a)};var T=function(a){switch(a){case!0:return!0;case d.pki.certificateError.bad_certificate:return k.Alert.Description.bad_certificate;case d.pki.certificateError.unsupported_certificate:return k.Alert.Description.unsupported_certificate;case d.pki.certificateError.certificate_revoked:return k.Alert.Description.certificate_revoked;case d.pki.certificateError.certificate_expired:return k.Alert.Description.certificate_expired;case d.pki.certificateError.certificate_unknown:return k.Alert.Description.certificate_unknown;case d.pki.certificateError.unknown_ca:return k.Alert.Description.unknown_ca;default:return k.Alert.Description.bad_certificate}},U=function(a){switch(a){case!0:return!0;case k.Alert.Description.bad_certificate:return d.pki.certificateError.bad_certificate;case k.Alert.Description.unsupported_certificate:return d.pki.certificateError.unsupported_certificate;case k.Alert.Description.certificate_revoked:return d.pki.certificateError.certificate_revoked;case k.Alert.Description.certificate_expired:return d.pki.certificateError.certificate_expired;case k.Alert.Description.certificate_unknown:return d.pki.certificateError.certificate_unknown;case k.Alert.Description.unknown_ca:return d.pki.certificateError.unknown_ca;default:return d.pki.certificateError.bad_certificate}};k.verifyCertificateChain=function(a,b){try{var c={};for(var e in a.verifyOptions)c[e]=a.verifyOptions[e];c.verify=function(b,c,e){var f=(T(b),a.verify(a,b,c,e));if(f!==!0){if("object"==typeof f&&!d.util.isArray(f)){var g=new Error("The application rejected the certificate.");throw g.send=!0,g.alert={level:k.Alert.Level.fatal,description:k.Alert.Description.bad_certificate},f.message&&(g.message=f.message),f.alert&&(g.alert.description=f.alert),g}f!==b&&(f=U(f))}return f},d.pki.verifyCertificateChain(a.caStore,b,c)}catch(f){var g=f;("object"!=typeof g||d.util.isArray(g))&&(g={send:!0,alert:{level:k.Alert.Level.fatal,description:T(f)}}),"send"in g||(g.send=!0),"alert"in g||(g.alert={level:k.Alert.Level.fatal,description:T(g.error)}),a.error(a,g)}return!a.fail},k.createSessionCache=function(a,b){var c=null;if(a&&a.getSession&&a.setSession&&a.order)c=a;else{c={},c.cache=a||{},c.capacity=Math.max(b||100,1),c.order=[];for(var e in a)c.order.length<=b?c.order.push(e):delete a[e];c.getSession=function(a){var b=null,e=null;if(a?e=d.util.bytesToHex(a):c.order.length>0&&(e=c.order[0]),null!==e&&e in c.cache){b=c.cache[e],delete c.cache[e];for(var f in c.order)if(c.order[f]===e){c.order.splice(f,1);break}}return b},c.setSession=function(a,b){if(c.order.length===c.capacity){var e=c.order.shift();delete c.cache[e]}var e=d.util.bytesToHex(a);c.order.push(e),c.cache[e]=b}}return c},k.createConnection=function(a){var b=null;b=a.caStore?d.util.isArray(a.caStore)?d.pki.createCaStore(a.caStore):a.caStore:d.pki.createCaStore();var c=a.cipherSuites||null;if(null===c){c=[];for(var e in k.CipherSuites)c.push(k.CipherSuites[e])}var f=a.server?k.ConnectionEnd.server:k.ConnectionEnd.client,g=a.sessionCache?k.createSessionCache(a.sessionCache):null,h={version:{major:k.Version.major,minor:k.Version.minor},entity:f,sessionId:a.sessionId,caStore:b,sessionCache:g,cipherSuites:c,connected:a.connected,virtualHost:a.virtualHost||null,verifyClient:a.verifyClient||!1,verify:a.verify||function(a,b,c,d){return b},verifyOptions:a.verifyOptions||{},getCertificate:a.getCertificate||null,getPrivateKey:a.getPrivateKey||null,getSignature:a.getSignature||null,input:d.util.createBuffer(),tlsData:d.util.createBuffer(),data:d.util.createBuffer(),tlsDataReady:a.tlsDataReady,dataReady:a.dataReady,heartbeatReceived:a.heartbeatReceived,closed:a.closed,error:function(b,c){c.origin=c.origin||(b.entity===k.ConnectionEnd.client?"client":"server"),c.send&&(k.queue(b,k.createAlert(b,c.alert)),k.flush(b));var d=c.fatal!==!1;d&&(b.fail=!0),a.error(b,c),d&&b.close(!1)},deflate:a.deflate||null,inflate:a.inflate||null};h.reset=function(a){h.version={major:k.Version.major,minor:k.Version.minor},h.record=null,h.session=null,h.peerCertificate=null,h.state={pending:null,current:null},h.expect=h.entity===k.ConnectionEnd.client?l:u,h.fragmented=null,h.records=[],h.open=!1,h.handshakes=0,h.handshaking=!1,h.isConnected=!1,h.fail=!(a||"undefined"==typeof a),h.input.clear(),h.tlsData.clear(),h.data.clear(),h.state.current=k.createConnectionState(h)},h.reset();var i=function(a,b){var c=b.type-k.ContentType.change_cipher_spec,d=H[a.entity][a.expect];c in d?d[c](a,b):k.handleUnexpected(a,b)},j=function(a){var b=0,c=a.input,e=c.length();if(e<5)b=5-e;else{a.record={type:c.getByte(),version:{major:c.getByte(),minor:c.getByte()},length:c.getInt16(),fragment:d.util.createBuffer(),ready:!1};var f=a.record.version.major===a.version.major;f&&a.session&&a.session.version&&(f=a.record.version.minor===a.version.minor),f||a.error(a,{message:"Incompatible TLS version.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.protocol_version}})}return b},m=function(a){var b=0,c=a.input,d=c.length();if(d<a.record.length)b=a.record.length-d;else{a.record.fragment.putBytes(c.getBytes(a.record.length)),c.compact();var e=a.state.current.read;e.update(a,a.record)&&(null!==a.fragmented&&(a.fragmented.type===a.record.type?(a.fragmented.fragment.putBuffer(a.record.fragment),a.record=a.fragmented):a.error(a,{message:"Invalid fragmented record.",send:!0,alert:{level:k.Alert.Level.fatal,description:k.Alert.Description.unexpected_message}})),a.record.ready=!0)}return b};return h.handshake=function(a){if(h.entity!==k.ConnectionEnd.client)h.error(h,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(h.handshaking)h.error(h,{message:"Handshake already in progress.",fatal:!1});else{h.fail&&!h.open&&0===h.handshakes&&(h.fail=!1),h.handshaking=!0,a=a||"";var b=null;a.length>0&&(h.sessionCache&&(b=h.sessionCache.getSession(a)),null===b&&(a="")),0===a.length&&h.sessionCache&&(b=h.sessionCache.getSession(),null!==b&&(a=b.id)),h.session={id:a,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:d.md.md5.create(),sha1:d.md.sha1.create()},b&&(h.version=b.version,h.session.sp=b.sp),h.session.sp.client_random=k.createRandom().getBytes(),h.open=!0,k.queue(h,k.createRecord(h,{type:k.ContentType.handshake,data:k.createClientHello(h)})),k.flush(h)}},h.process=function(a){var b=0;return a&&h.input.putBytes(a),h.fail||(null!==h.record&&h.record.ready&&h.record.fragment.isEmpty()&&(h.record=null),null===h.record&&(b=j(h)),h.fail||null===h.record||h.record.ready||(b=m(h)),!h.fail&&null!==h.record&&h.record.ready&&i(h,h.record)),b},h.prepare=function(a){return k.queue(h,k.createRecord(h,{type:k.ContentType.application_data,data:d.util.createBuffer(a)})),k.flush(h)},h.prepareHeartbeatRequest=function(a,b){return a instanceof d.util.ByteBuffer&&(a=a.bytes()),"undefined"==typeof b&&(b=a.length),h.expectedHeartbeatPayload=a,k.queue(h,k.createRecord(h,{type:k.ContentType.heartbeat,data:k.createHeartbeat(k.HeartbeatMessageType.heartbeat_request,a,b)})),k.flush(h)},h.close=function(a){if(!h.fail&&h.sessionCache&&h.session){var b={id:h.session.id,version:h.session.version,sp:h.session.sp};b.sp.keys=null,h.sessionCache.setSession(b.id,b)}h.open&&(h.open=!1,h.input.clear(),(h.isConnected||h.handshaking)&&(h.isConnected=h.handshaking=!1,k.queue(h,k.createAlert(h,{level:k.Alert.Level.warning,description:k.Alert.Description.close_notify})),k.flush(h)),h.closed(h)),h.reset(a)},h},b.exports=d.tls=d.tls||{};for(var V in k)"function"!=typeof k[V]&&(d.tls[V]=k[V]);d.tls.prf_tls1=e,d.tls.hmac_sha1=f,d.tls.createSessionCache=k.createSessionCache,d.tls.createConnection=k.createConnection},{"./asn1":40,"./forge":47,"./hmac":48,"./md5":55,"./pem":61,"./pki":66,"./random":70,"./sha1":73,"./util":79}],79:[function(a,b,c){(function(c,d,e,f,g,h,i,j){function k(a){if(8!==a&&16!==a&&24!==a&&32!==a)throw new Error("Only 8, 16, 24, or 32 bits supported: "+a)}function l(a){if(this.data="",this.read=0,"string"==typeof a)this.data=a;else if(p.isArrayBuffer(a)||p.isArrayBufferView(a))if("undefined"!=typeof e&&a instanceof e)this.data=a.toString("binary");else{var b=new Uint8Array(a);try{this.data=String.fromCharCode.apply(null,b)}catch(c){for(var d=0;d<b.length;++d)this.putByte(b[d])}}else(a instanceof l||"object"==typeof a&&"string"==typeof a.data&&"number"==typeof a.read)&&(this.data=a.data,this.read=a.read);this._constructedStringLength=0}function m(a,b){b=b||{},this.read=b.readOffset||0,this.growSize=b.growSize||1024;var c=p.isArrayBuffer(a),d=p.isArrayBufferView(a);return c||d?(c?this.data=new DataView(a):this.data=new DataView(a.buffer,a.byteOffset,a.byteLength),void(this.write="writeOffset"in b?b.writeOffset:this.data.byteLength)):(this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==a&&void 0!==a&&this.putBytes(a),void("writeOffset"in b&&(this.write=b.writeOffset)))}var n=a("./forge"),o=a("./baseN"),p=b.exports=n.util=n.util||{};
!function(){function a(a){if(a.source===window&&a.data===b){a.stopPropagation();var c=d.slice();d.length=0,c.forEach(function(a){a()})}}if("undefined"!=typeof c&&c.nextTick&&!c.browser)return p.nextTick=c.nextTick,void("function"==typeof j?p.setImmediate=j:p.setImmediate=p.nextTick);if("function"==typeof j)return p.setImmediate=function(){return j.apply(void 0,arguments)},void(p.nextTick=function(a){return j(a)});if(p.setImmediate=function(a){setTimeout(a,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var b="forge.setImmediate",d=[];p.setImmediate=function(a){d.push(a),1===d.length&&window.postMessage(b,"*")},window.addEventListener("message",a,!0)}if("undefined"!=typeof MutationObserver){var e=Date.now(),f=!0,g=document.createElement("div"),d=[];new MutationObserver(function(){var a=d.slice();d.length=0,a.forEach(function(a){a()})}).observe(g,{attributes:!0});var h=p.setImmediate;p.setImmediate=function(a){Date.now()-e>15?(e=Date.now(),h(a)):(d.push(a),1===d.length&&g.setAttribute("a",f=!f))}}p.nextTick=p.setImmediate}(),p.isNodejs="undefined"!=typeof c&&c.versions&&c.versions.node,p.globalScope=function(){return p.isNodejs?d:"undefined"==typeof self?window:self}(),p.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},p.isArrayBuffer=function(a){return"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer},p.isArrayBufferView=function(a){return a&&p.isArrayBuffer(a.buffer)&&void 0!==a.byteLength},p.ByteBuffer=l,p.ByteStringBuffer=l;var q=4096;p.ByteStringBuffer.prototype._optimizeConstructedString=function(a){this._constructedStringLength+=a,this._constructedStringLength>q&&(this.data.substr(0,1),this._constructedStringLength=0)},p.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},p.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},p.ByteStringBuffer.prototype.putByte=function(a){return this.putBytes(String.fromCharCode(a))},p.ByteStringBuffer.prototype.fillWithByte=function(a,b){a=String.fromCharCode(a);for(var c=this.data;b>0;)1&b&&(c+=a),b>>>=1,b>0&&(a+=a);return this.data=c,this._optimizeConstructedString(b),this},p.ByteStringBuffer.prototype.putBytes=function(a){return this.data+=a,this._optimizeConstructedString(a.length),this},p.ByteStringBuffer.prototype.putString=function(a){return this.putBytes(p.encodeUtf8(a))},p.ByteStringBuffer.prototype.putInt16=function(a){return this.putBytes(String.fromCharCode(a>>8&255)+String.fromCharCode(255&a))},p.ByteStringBuffer.prototype.putInt24=function(a){return this.putBytes(String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a))},p.ByteStringBuffer.prototype.putInt32=function(a){return this.putBytes(String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a))},p.ByteStringBuffer.prototype.putInt16Le=function(a){return this.putBytes(String.fromCharCode(255&a)+String.fromCharCode(a>>8&255))},p.ByteStringBuffer.prototype.putInt24Le=function(a){return this.putBytes(String.fromCharCode(255&a)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255))},p.ByteStringBuffer.prototype.putInt32Le=function(a){return this.putBytes(String.fromCharCode(255&a)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>24&255))},p.ByteStringBuffer.prototype.putInt=function(a,b){k(b);var c="";do b-=8,c+=String.fromCharCode(a>>b&255);while(b>0);return this.putBytes(c)},p.ByteStringBuffer.prototype.putSignedInt=function(a,b){return a<0&&(a+=2<<b-1),this.putInt(a,b)},p.ByteStringBuffer.prototype.putBuffer=function(a){return this.putBytes(a.getBytes())},p.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},p.ByteStringBuffer.prototype.getInt16=function(){var a=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,a},p.ByteStringBuffer.prototype.getInt24=function(){var a=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,a},p.ByteStringBuffer.prototype.getInt32=function(){var a=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,a},p.ByteStringBuffer.prototype.getInt16Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,a},p.ByteStringBuffer.prototype.getInt24Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,a},p.ByteStringBuffer.prototype.getInt32Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,a},p.ByteStringBuffer.prototype.getInt=function(a){k(a);var b=0;do b=(b<<8)+this.data.charCodeAt(this.read++),a-=8;while(a>0);return b},p.ByteStringBuffer.prototype.getSignedInt=function(a){var b=this.getInt(a),c=2<<a-2;return b>=c&&(b-=c<<1),b},p.ByteStringBuffer.prototype.getBytes=function(a){var b;return a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear()),b},p.ByteStringBuffer.prototype.bytes=function(a){return"undefined"==typeof a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)},p.ByteStringBuffer.prototype.at=function(a){return this.data.charCodeAt(this.read+a)},p.ByteStringBuffer.prototype.setAt=function(a,b){return this.data=this.data.substr(0,this.read+a)+String.fromCharCode(b)+this.data.substr(this.read+a+1),this},p.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},p.ByteStringBuffer.prototype.copy=function(){var a=p.createBuffer(this.data);return a.read=this.read,a},p.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},p.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},p.ByteStringBuffer.prototype.truncate=function(a){var b=Math.max(0,this.length()-a);return this.data=this.data.substr(this.read,b),this.read=0,this},p.ByteStringBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.length;++b){var c=this.data.charCodeAt(b);c<16&&(a+="0"),a+=c.toString(16)}return a},p.ByteStringBuffer.prototype.toString=function(){return p.decodeUtf8(this.bytes())},p.DataBuffer=m,p.DataBuffer.prototype.length=function(){return this.write-this.read},p.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},p.DataBuffer.prototype.accommodate=function(a,b){if(this.length()>=a)return this;b=Math.max(b||this.growSize,a);var c=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),d=new Uint8Array(this.length()+b);return d.set(c),this.data=new DataView(d.buffer),this},p.DataBuffer.prototype.putByte=function(a){return this.accommodate(1),this.data.setUint8(this.write++,a),this},p.DataBuffer.prototype.fillWithByte=function(a,b){this.accommodate(b);for(var c=0;c<b;++c)this.data.setUint8(a);return this},p.DataBuffer.prototype.putBytes=function(a,b){if(p.isArrayBufferView(a)){var c=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),d=c.byteLength-c.byteOffset;this.accommodate(d);var e=new Uint8Array(this.data.buffer,this.write);return e.set(c),this.write+=d,this}if(p.isArrayBuffer(a)){var c=new Uint8Array(a);this.accommodate(c.byteLength);var e=new Uint8Array(this.data.buffer);return e.set(c,this.write),this.write+=c.byteLength,this}if(a instanceof p.DataBuffer||"object"==typeof a&&"number"==typeof a.read&&"number"==typeof a.write&&p.isArrayBufferView(a.data)){var c=new Uint8Array(a.data.byteLength,a.read,a.length());this.accommodate(c.byteLength);var e=new Uint8Array(a.data.byteLength,this.write);return e.set(c),this.write+=c.byteLength,this}if(a instanceof p.ByteStringBuffer&&(a=a.data,b="binary"),b=b||"binary","string"==typeof a){var f;if("hex"===b)return this.accommodate(Math.ceil(a.length/2)),f=new Uint8Array(this.data.buffer,this.write),this.write+=p.binary.hex.decode(a,f,this.write),this;if("base64"===b)return this.accommodate(3*Math.ceil(a.length/4)),f=new Uint8Array(this.data.buffer,this.write),this.write+=p.binary.base64.decode(a,f,this.write),this;if("utf8"===b&&(a=p.encodeUtf8(a),b="binary"),"binary"===b||"raw"===b)return this.accommodate(a.length),f=new Uint8Array(this.data.buffer,this.write),this.write+=p.binary.raw.decode(f),this;if("utf16"===b)return this.accommodate(2*a.length),f=new Uint16Array(this.data.buffer,this.write),this.write+=p.text.utf16.encode(f),this;throw new Error("Invalid encoding: "+b)}throw Error("Invalid parameter: "+a)},p.DataBuffer.prototype.putBuffer=function(a){return this.putBytes(a),a.clear(),this},p.DataBuffer.prototype.putString=function(a){return this.putBytes(a,"utf16")},p.DataBuffer.prototype.putInt16=function(a){return this.accommodate(2),this.data.setInt16(this.write,a),this.write+=2,this},p.DataBuffer.prototype.putInt24=function(a){return this.accommodate(3),this.data.setInt16(this.write,a>>8&65535),this.data.setInt8(this.write,a>>16&255),this.write+=3,this},p.DataBuffer.prototype.putInt32=function(a){return this.accommodate(4),this.data.setInt32(this.write,a),this.write+=4,this},p.DataBuffer.prototype.putInt16Le=function(a){return this.accommodate(2),this.data.setInt16(this.write,a,!0),this.write+=2,this},p.DataBuffer.prototype.putInt24Le=function(a){return this.accommodate(3),this.data.setInt8(this.write,a>>16&255),this.data.setInt16(this.write,a>>8&65535,!0),this.write+=3,this},p.DataBuffer.prototype.putInt32Le=function(a){return this.accommodate(4),this.data.setInt32(this.write,a,!0),this.write+=4,this},p.DataBuffer.prototype.putInt=function(a,b){k(b),this.accommodate(b/8);do b-=8,this.data.setInt8(this.write++,a>>b&255);while(b>0);return this},p.DataBuffer.prototype.putSignedInt=function(a,b){return k(b),this.accommodate(b/8),a<0&&(a+=2<<b-1),this.putInt(a,b)},p.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},p.DataBuffer.prototype.getInt16=function(){var a=this.data.getInt16(this.read);return this.read+=2,a},p.DataBuffer.prototype.getInt24=function(){var a=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,a},p.DataBuffer.prototype.getInt32=function(){var a=this.data.getInt32(this.read);return this.read+=4,a},p.DataBuffer.prototype.getInt16Le=function(){var a=this.data.getInt16(this.read,!0);return this.read+=2,a},p.DataBuffer.prototype.getInt24Le=function(){var a=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,a},p.DataBuffer.prototype.getInt32Le=function(){var a=this.data.getInt32(this.read,!0);return this.read+=4,a},p.DataBuffer.prototype.getInt=function(a){k(a);var b=0;do b=(b<<8)+this.data.getInt8(this.read++),a-=8;while(a>0);return b},p.DataBuffer.prototype.getSignedInt=function(a){var b=this.getInt(a),c=2<<a-2;return b>=c&&(b-=c<<1),b},p.DataBuffer.prototype.getBytes=function(a){var b;return a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear()),b},p.DataBuffer.prototype.bytes=function(a){return"undefined"==typeof a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)},p.DataBuffer.prototype.at=function(a){return this.data.getUint8(this.read+a)},p.DataBuffer.prototype.setAt=function(a,b){return this.data.setUint8(a,b),this},p.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},p.DataBuffer.prototype.copy=function(){return new p.DataBuffer(this)},p.DataBuffer.prototype.compact=function(){if(this.read>0){var a=new Uint8Array(this.data.buffer,this.read),b=new Uint8Array(a.byteLength);b.set(a),this.data=new DataView(b),this.write-=this.read,this.read=0}return this},p.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},p.DataBuffer.prototype.truncate=function(a){return this.write=Math.max(0,this.length()-a),this.read=Math.min(this.read,this.write),this},p.DataBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.byteLength;++b){var c=this.data.getUint8(b);c<16&&(a+="0"),a+=c.toString(16)}return a},p.DataBuffer.prototype.toString=function(a){var b=new Uint8Array(this.data,this.read,this.length());if(a=a||"utf8","binary"===a||"raw"===a)return p.binary.raw.encode(b);if("hex"===a)return p.binary.hex.encode(b);if("base64"===a)return p.binary.base64.encode(b);if("utf8"===a)return p.text.utf8.decode(b);if("utf16"===a)return p.text.utf16.decode(b);throw new Error("Invalid encoding: "+a)},p.createBuffer=function(a,b){return b=b||"raw",void 0!==a&&"utf8"===b&&(a=p.encodeUtf8(a)),new p.ByteBuffer(a)},p.fillString=function(a,b){for(var c="";b>0;)1&b&&(c+=a),b>>>=1,b>0&&(a+=a);return c},p.xorBytes=function(a,b,c){for(var d="",e="",f="",g=0,h=0;c>0;--c,++g)e=a.charCodeAt(g)^b.charCodeAt(g),h>=10&&(d+=f,f="",h=0),f+=String.fromCharCode(e),++h;return d+=f},p.hexToBytes=function(a){var b="",c=0;for(a.length&!0&&(c=1,b+=String.fromCharCode(parseInt(a[0],16)));c<a.length;c+=2)b+=String.fromCharCode(parseInt(a.substr(c,2),16));return b},p.bytesToHex=function(a){return p.createBuffer(a).toHex()},p.int32ToBytes=function(a){return String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a)};var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],t="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";p.encode64=function(a,b){for(var c,d,e,f="",g="",h=0;h<a.length;)c=a.charCodeAt(h++),d=a.charCodeAt(h++),e=a.charCodeAt(h++),f+=r.charAt(c>>2),f+=r.charAt((3&c)<<4|d>>4),isNaN(d)?f+="==":(f+=r.charAt((15&d)<<2|e>>6),f+=isNaN(e)?"=":r.charAt(63&e)),b&&f.length>b&&(g+=f.substr(0,b)+"\r\n",f=f.substr(b));return g+=f},p.decode64=function(a){a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var b,c,d,e,f="",g=0;g<a.length;)b=s[a.charCodeAt(g++)-43],c=s[a.charCodeAt(g++)-43],d=s[a.charCodeAt(g++)-43],e=s[a.charCodeAt(g++)-43],f+=String.fromCharCode(b<<2|c>>4),64!==d&&(f+=String.fromCharCode((15&c)<<4|d>>2),64!==e&&(f+=String.fromCharCode((3&d)<<6|e)));return f},p.encodeUtf8=function(a){return unescape(encodeURIComponent(a))},p.decodeUtf8=function(a){return decodeURIComponent(escape(a))},p.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:o.encode,decode:o.decode}},p.binary.raw.encode=function(a){return String.fromCharCode.apply(null,a)},p.binary.raw.decode=function(a,b,c){var d=b;d||(d=new Uint8Array(a.length)),c=c||0;for(var e=c,f=0;f<a.length;++f)d[e++]=a.charCodeAt(f);return b?e-c:d},p.binary.hex.encode=p.bytesToHex,p.binary.hex.decode=function(a,b,c){var d=b;d||(d=new Uint8Array(Math.ceil(a.length/2))),c=c||0;var e=0,f=c;for(1&a.length&&(e=1,d[f++]=parseInt(a[0],16));e<a.length;e+=2)d[f++]=parseInt(a.substr(e,2),16);return b?f-c:d},p.binary.base64.encode=function(a,b){for(var c,d,e,f="",g="",h=0;h<a.byteLength;)c=a[h++],d=a[h++],e=a[h++],f+=r.charAt(c>>2),f+=r.charAt((3&c)<<4|d>>4),isNaN(d)?f+="==":(f+=r.charAt((15&d)<<2|e>>6),f+=isNaN(e)?"=":r.charAt(63&e)),b&&f.length>b&&(g+=f.substr(0,b)+"\r\n",f=f.substr(b));return g+=f},p.binary.base64.decode=function(a,b,c){var d=b;d||(d=new Uint8Array(3*Math.ceil(a.length/4))),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,""),c=c||0;for(var e,f,g,h,i=0,j=c;i<a.length;)e=s[a.charCodeAt(i++)-43],f=s[a.charCodeAt(i++)-43],g=s[a.charCodeAt(i++)-43],h=s[a.charCodeAt(i++)-43],d[j++]=e<<2|f>>4,64!==g&&(d[j++]=(15&f)<<4|g>>2,64!==h&&(d[j++]=(3&g)<<6|h));return b?j-c:d.subarray(0,j)},p.binary.base58.encode=function(a,b){return p.binary.baseN.encode(a,t,b)},p.binary.base58.decode=function(a,b){return p.binary.baseN.decode(a,t,b)},p.text={utf8:{},utf16:{}},p.text.utf8.encode=function(a,b,c){a=p.encodeUtf8(a);var d=b;d||(d=new Uint8Array(a.length)),c=c||0;for(var e=c,f=0;f<a.length;++f)d[e++]=a.charCodeAt(f);return b?e-c:d},p.text.utf8.decode=function(a){return p.decodeUtf8(String.fromCharCode.apply(null,a))},p.text.utf16.encode=function(a,b,c){var d=b;d||(d=new Uint8Array(2*a.length));var e=new Uint16Array(d.buffer);c=c||0;for(var f=c,g=c,h=0;h<a.length;++h)e[g++]=a.charCodeAt(h),f+=2;return b?f-c:d},p.text.utf16.decode=function(a){return String.fromCharCode.apply(null,new Uint16Array(a.buffer))},p.deflate=function(a,b,c){if(b=p.decode64(a.deflate(p.encode64(b)).rval),c){var d=2,e=b.charCodeAt(1);32&e&&(d=6),b=b.substring(d,b.length-4)}return b},p.inflate=function(a,b,c){var d=a.inflate(p.encode64(b)).rval;return null===d?null:p.decode64(d)};var u=function(a,b,c){if(!a)throw new Error("WebStorage not available.");var d;if(null===c?d=a.removeItem(b):(c=p.encode64(JSON.stringify(c)),d=a.setItem(b,c)),"undefined"!=typeof d&&d.rval!==!0){var e=new Error(d.error.message);throw e.id=d.error.id,e.name=d.error.name,e}},v=function(a,b){if(!a)throw new Error("WebStorage not available.");var c=a.getItem(b);if(a.init)if(null===c.rval){if(c.error){var d=new Error(c.error.message);throw d.id=c.error.id,d.name=c.error.name,d}c=null}else c=c.rval;return null!==c&&(c=JSON.parse(p.decode64(c))),c},w=function(a,b,c,d){var e=v(a,b);null===e&&(e={}),e[c]=d,u(a,b,e)},x=function(a,b,c){var d=v(a,b);return null!==d&&(d=c in d?d[c]:null),d},y=function(a,b,c){var d=v(a,b);if(null!==d&&c in d){delete d[c];var e=!0;for(var f in d){e=!1;break}e&&(d=null),u(a,b,d)}},z=function(a,b){u(a,b,null)},A=function(a,b,c){var d=null;"undefined"==typeof c&&(c=["web","flash"]);var e,f=!1,g=null;for(var h in c){e=c[h];try{if("flash"===e||"both"===e){if(null===b[0])throw new Error("Flash local storage not available.");d=a.apply(this,b),f="flash"===e}"web"!==e&&"both"!==e||(b[0]=localStorage,d=a.apply(this,b),f=!0)}catch(i){g=i}if(f)break}if(!f)throw g;return d};p.setItem=function(a,b,c,d,e){A(w,arguments,e)},p.getItem=function(a,b,c,d){return A(x,arguments,d)},p.removeItem=function(a,b,c,d){A(y,arguments,d)},p.clearItems=function(a,b,c){A(z,arguments,c)},p.parseUrl=function(a){var b=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;b.lastIndex=0;var c=b.exec(a),d=null===c?null:{full:a,scheme:c[1],host:c[2],port:c[3],path:c[4]};return d&&(d.fullHost=d.host,d.port?80!==d.port&&"http"===d.scheme?d.fullHost+=":"+d.port:443!==d.port&&"https"===d.scheme&&(d.fullHost+=":"+d.port):"http"===d.scheme?d.port=80:"https"===d.scheme&&(d.port=443),d.full=d.scheme+"://"+d.fullHost),d};var B=null;p.getQueryVariables=function(a){var b,c=function(a){for(var b={},c=a.split("&"),d=0;d<c.length;d++){var e,f,g=c[d].indexOf("=");g>0?(e=c[d].substring(0,g),f=c[d].substring(g+1)):(e=c[d],f=null),e in b||(b[e]=[]),e in Object.prototype||null===f||b[e].push(unescape(f))}return b};return"undefined"==typeof a?(null===B&&(B="undefined"!=typeof window&&window.location&&window.location.search?c(window.location.search.substring(1)):{}),b=B):b=c(a),b},p.parseFragment=function(a){var b=a,c="",d=a.indexOf("?");d>0&&(b=a.substring(0,d),c=a.substring(d+1));var e=b.split("/");e.length>0&&""===e[0]&&e.shift();var f=""===c?{}:p.getQueryVariables(c);return{pathString:b,queryString:c,path:e,query:f}},p.makeRequest=function(a){var b=p.parseFragment(a),c={path:b.pathString,query:b.queryString,getPath:function(a){return"undefined"==typeof a?b.path:b.path[a]},getQuery:function(a,c){var d;return"undefined"==typeof a?d=b.query:(d=b.query[a],d&&"undefined"!=typeof c&&(d=d[c])),d},getQueryLast:function(a,b){var d,e=c.getQuery(a);return d=e?e[e.length-1]:b}};return c},p.makeLink=function(a,b,c){a=jQuery.isArray(a)?a.join("/"):a;var d=jQuery.param(b||{});return c=c||"",a+(d.length>0?"?"+d:"")+(c.length>0?"#"+c:"")},p.setPath=function(a,b,c){if("object"==typeof a&&null!==a)for(var d=0,e=b.length;d<e;){var f=b[d++];if(d==e)a[f]=c;else{var g=f in a;(!g||g&&"object"!=typeof a[f]||g&&null===a[f])&&(a[f]={}),a=a[f]}}},p.getPath=function(a,b,c){for(var d=0,e=b.length,f=!0;f&&d<e&&"object"==typeof a&&null!==a;){var g=b[d++];f=g in a,f&&(a=a[g])}return f?a:c},p.deletePath=function(a,b){if("object"==typeof a&&null!==a)for(var c=0,d=b.length;c<d;){var e=b[c++];if(c==d)delete a[e];else{if(!(e in a)||"object"!=typeof a[e]||null===a[e])break;a=a[e]}}},p.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},p.format=function(a){for(var b,c,d=/%./g,e=0,f=[],g=0;b=d.exec(a);){c=a.substring(g,d.lastIndex-2),c.length>0&&f.push(c),g=d.lastIndex;var h=b[0][1];switch(h){case"s":case"o":e<arguments.length?f.push(arguments[e++ +1]):f.push("<?>");break;case"%":f.push("%");break;default:f.push("<%"+h+"?>")}}return f.push(a.substring(g)),f.join("")},p.formatNumber=function(a,b,c,d){var e=a,f=isNaN(b=Math.abs(b))?2:b,g=void 0===c?",":c,h=void 0===d?".":d,i=e<0?"-":"",j=parseInt(e=Math.abs(+e||0).toFixed(f),10)+"",k=j.length>3?j.length%3:0;return i+(k?j.substr(0,k)+h:"")+j.substr(k).replace(/(\d{3})(?=\d)/g,"$1"+h)+(f?g+Math.abs(e-j).toFixed(f).slice(2):"")},p.formatSize=function(a){return a=a>=1073741824?p.formatNumber(a/1073741824,2,".","")+" GiB":a>=1048576?p.formatNumber(a/1048576,2,".","")+" MiB":a>=1024?p.formatNumber(a/1024,0)+" KiB":p.formatNumber(a,0)+" bytes"},p.bytesFromIP=function(a){return a.indexOf(".")!==-1?p.bytesFromIPv4(a):a.indexOf(":")!==-1?p.bytesFromIPv6(a):null},p.bytesFromIPv4=function(a){if(a=a.split("."),4!==a.length)return null;for(var b=p.createBuffer(),c=0;c<a.length;++c){var d=parseInt(a[c],10);if(isNaN(d))return null;b.putByte(d)}return b.getBytes()},p.bytesFromIPv6=function(a){var b=0;a=a.split(":").filter(function(a){return 0===a.length&&++b,!0});for(var c=2*(8-a.length+b),d=p.createBuffer(),e=0;e<8;++e)if(a[e]&&0!==a[e].length){var f=p.hexToBytes(a[e]);f.length<2&&d.putByte(0),d.putBytes(f)}else d.fillWithByte(0,c),c=0;return d.getBytes()},p.bytesToIP=function(a){return 4===a.length?p.bytesToIPv4(a):16===a.length?p.bytesToIPv6(a):null},p.bytesToIPv4=function(a){if(4!==a.length)return null;for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b.join(".")},p.bytesToIPv6=function(a){if(16!==a.length)return null;for(var b=[],c=[],d=0,e=0;e<a.length;e+=2){for(var f=p.bytesToHex(a[e]+a[e+1]);"0"===f[0]&&"0"!==f;)f=f.substr(1);if("0"===f){var g=c[c.length-1],h=b.length;g&&h===g.end+1?(g.end=h,g.end-g.start>c[d].end-c[d].start&&(d=c.length-1)):c.push({start:h,end:h})}b.push(f)}if(c.length>0){var i=c[d];i.end-i.start>0&&(b.splice(i.start,i.end-i.start+1,""),0===i.start&&b.unshift(""),7===i.end&&b.push(""))}return b.join(":")},p.estimateCores=function(a,b){function c(a,g,h){if(0===g){var i=Math.floor(a.reduce(function(a,b){return a+b},0)/a.length);return p.cores=Math.max(1,i),URL.revokeObjectURL(f),b(null,p.cores)}d(h,function(b,d){a.push(e(h,d)),c(a,g-1,h)})}function d(a,b){for(var c=[],d=[],e=0;e<a;++e){var g=new Worker(f);g.addEventListener("message",function(e){if(d.push(e.data),d.length===a){for(var f=0;f<a;++f)c[f].terminate();b(null,d)}}),c.push(g)}for(var e=0;e<a;++e)c[e].postMessage(e)}function e(a,b){for(var c=[],d=0;d<a;++d)for(var e=b[d],f=c[d]=[],g=0;g<a;++g)if(d!==g){var h=b[g];(e.st>h.st&&e.st<h.et||h.st>e.st&&h.st<e.et)&&f.push(g)}return c.reduce(function(a,b){return Math.max(a,b.length)},0)}if("function"==typeof a&&(b=a,a={}),a=a||{},"cores"in p&&!a.update)return b(null,p.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return p.cores=navigator.hardwareConcurrency,b(null,p.cores);if("undefined"==typeof Worker)return p.cores=1,b(null,p.cores);if("undefined"==typeof Blob)return p.cores=2,b(null,p.cores);var f=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var b=Date.now(),c=b+4;Date.now()<c;);self.postMessage({st:b,et:c})})}.toString(),")()"],{type:"application/javascript"}));c([],5,16)}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],a("timers").setImmediate)},{"./baseN":41,"./forge":47,_process:81,buffer:18,timers:82}],80:[function(a,b,c){function d(a,b){"string"==typeof b&&(b={shortName:b});for(var c,d=null,e=0;null===d&&e<a.attributes.length;++e)c=a.attributes[e],b.type&&b.type===c.type?d=c:b.name&&b.name===c.name?d=c:b.shortName&&b.shortName===c.shortName&&(d=c);return d}function e(a){for(var b,c,d=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]),e=a.attributes,f=0;f<e.length;++f){b=e[f];var g=b.value,h=l.Type.PRINTABLESTRING;"valueTagClass"in b&&(h=b.valueTagClass,h===l.Type.UTF8&&(g=k.util.encodeUtf8(g))),c=l.create(l.Class.UNIVERSAL,l.Type.SET,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(b.type).getBytes()),l.create(l.Class.UNIVERSAL,h,!1,g)])]),d.value.push(c)}return d}function f(a){for(var b,c=0;c<a.length;++c){if(b=a[c],"undefined"==typeof b.name&&(b.type&&b.type in m.oids?b.name=m.oids[b.type]:b.shortName&&b.shortName in o&&(b.name=m.oids[o[b.shortName]])),"undefined"==typeof b.type){if(!(b.name&&b.name in m.oids)){var d=new Error("Attribute type not specified.");throw d.attribute=b,d}b.type=m.oids[b.name]}if("undefined"==typeof b.shortName&&b.name&&b.name in o&&(b.shortName=o[b.name]),b.type===n.extensionRequest&&(b.valueConstructed=!0,b.valueTagClass=l.Type.SEQUENCE,!b.value&&b.extensions)){b.value=[];for(var e=0;e<b.extensions.length;++e)b.value.push(m.certificateExtensionToAsn1(g(b.extensions[e])))}if("undefined"==typeof b.value){var d=new Error("Attribute value not specified.");throw d.attribute=b,d}}}function g(a,b){if(b=b||{},"undefined"==typeof a.name&&a.id&&a.id in m.oids&&(a.name=m.oids[a.id]),"undefined"==typeof a.id){if(!(a.name&&a.name in m.oids)){var c=new Error("Extension ID not specified.");throw c.extension=a,c}a.id=m.oids[a.name]}if("undefined"!=typeof a.value)return a;if("keyUsage"===a.name){var d=0,f=0,g=0;a.digitalSignature&&(f|=128,d=7),a.nonRepudiation&&(f|=64,d=6),a.keyEncipherment&&(f|=32,d=5),a.dataEncipherment&&(f|=16,d=4),a.keyAgreement&&(f|=8,d=3),a.keyCertSign&&(f|=4,d=2),a.cRLSign&&(f|=2,d=1),a.encipherOnly&&(f|=1,d=0),a.decipherOnly&&(g|=128,d=7);var h=String.fromCharCode(d);0!==g?h+=String.fromCharCode(f)+String.fromCharCode(g):0!==f&&(h+=String.fromCharCode(f)),a.value=l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,h)}else if("basicConstraints"===a.name)a.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]),a.cA&&a.value.value.push(l.create(l.Class.UNIVERSAL,l.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in a&&a.value.value.push(l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(a.pathLenConstraint).getBytes()));else if("extKeyUsage"===a.name){a.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);var i=a.value.value;for(var j in a)a[j]===!0&&(j in n?i.push(l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(n[j]).getBytes())):j.indexOf(".")!==-1&&i.push(l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(j).getBytes())))}else if("nsCertType"===a.name){var d=0,f=0;a.client&&(f|=128,d=7),a.server&&(f|=64,d=6),a.email&&(f|=32,d=5),a.objsign&&(f|=16,d=4),a.reserved&&(f|=8,d=3),a.sslCA&&(f|=4,d=2),a.emailCA&&(f|=2,d=1),a.objCA&&(f|=1,d=0);var h=String.fromCharCode(d);0!==f&&(h+=String.fromCharCode(f)),a.value=l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,h)}else if("subjectAltName"===a.name||"issuerAltName"===a.name){a.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);for(var o,p=0;p<a.altNames.length;++p){o=a.altNames[p];var h=o.value;if(7===o.type&&o.ip){if(h=k.util.bytesFromIP(o.ip),null===h){var c=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw c.extension=a,c}}else 8===o.type&&(h=o.oid?l.oidToDer(l.oidToDer(o.oid)):l.oidToDer(h));a.value.value.push(l.create(l.Class.CONTEXT_SPECIFIC,o.type,!1,h))}}else if("nsComment"===a.name&&b.cert){if(!/^[\x00-\x7F]*$/.test(a.comment)||a.comment.length<1||a.comment.length>128)throw new Error('Invalid "nsComment" content.');a.value=l.create(l.Class.UNIVERSAL,l.Type.IA5STRING,!1,a.comment)}else if("subjectKeyIdentifier"===a.name&&b.cert){var q=b.cert.generateSubjectKeyIdentifier();a.subjectKeyIdentifier=q.toHex(),a.value=l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,q.getBytes())}else if("authorityKeyIdentifier"===a.name&&b.cert){a.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);var i=a.value.value;if(a.keyIdentifier){var r=a.keyIdentifier===!0?b.cert.generateSubjectKeyIdentifier().getBytes():a.keyIdentifier;i.push(l.create(l.Class.CONTEXT_SPECIFIC,0,!1,r))}if(a.authorityCertIssuer){var s=[l.create(l.Class.CONTEXT_SPECIFIC,4,!0,[e(a.authorityCertIssuer===!0?b.cert.issuer:a.authorityCertIssuer)])];i.push(l.create(l.Class.CONTEXT_SPECIFIC,1,!0,s))}if(a.serialNumber){var t=k.util.hexToBytes(a.serialNumber===!0?b.cert.serialNumber:a.serialNumber);i.push(l.create(l.Class.CONTEXT_SPECIFIC,2,!1,t))}}else if("cRLDistributionPoints"===a.name){a.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);for(var o,i=a.value.value,u=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]),v=l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[]),p=0;p<a.altNames.length;++p){o=a.altNames[p];var h=o.value;if(7===o.type&&o.ip){if(h=k.util.bytesFromIP(o.ip),null===h){var c=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw c.extension=a,c}}else 8===o.type&&(h=o.oid?l.oidToDer(l.oidToDer(o.oid)):l.oidToDer(h));v.value.push(l.create(l.Class.CONTEXT_SPECIFIC,o.type,!1,h))}u.value.push(l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[v])),i.push(u)}if("undefined"==typeof a.value){var c=new Error("Extension value not specified.");throw c.extension=a,c}return a}function h(a,b){switch(a){case n["RSASSA-PSS"]:var c=[];return void 0!==b.hash.algorithmOid&&c.push(l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(b.hash.algorithmOid).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")])])),void 0!==b.mgf.algorithmOid&&c.push(l.create(l.Class.CONTEXT_SPECIFIC,1,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(b.mgf.algorithmOid).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(b.mgf.hash.algorithmOid).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")])])])),void 0!==b.saltLength&&c.push(l.create(l.Class.CONTEXT_SPECIFIC,2,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(b.saltLength).getBytes())])),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,c);default:return l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")}}function i(a){var b=l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===a.attributes.length)return b;for(var c=a.attributes,d=0;d<c.length;++d){var e=c[d],f=e.value,g=l.Type.UTF8;"valueTagClass"in e&&(g=e.valueTagClass),g===l.Type.UTF8&&(f=k.util.encodeUtf8(f));var h=!1;"valueConstructed"in e&&(h=e.valueConstructed);var i=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(e.type).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SET,!0,[l.create(l.Class.UNIVERSAL,g,h,f)])]);b.value.push(i)}return b}function j(a){return a>=v&&a<w?l.create(l.Class.UNIVERSAL,l.Type.UTCTIME,!1,l.dateToUtcTime(a)):l.create(l.Class.UNIVERSAL,l.Type.GENERALIZEDTIME,!1,l.dateToGeneralizedTime(a))}var k=a("./forge");a("./aes"),a("./asn1"),a("./des"),a("./md"),a("./mgf"),a("./oids"),a("./pem"),a("./pss"),a("./rsa"),a("./util");var l=k.asn1,m=b.exports=k.pki=k.pki||{},n=m.oids,o={};o.CN=n.commonName,o.commonName="CN",o.C=n.countryName,o.countryName="C",o.L=n.localityName,o.localityName="L",o.ST=n.stateOrProvinceName,o.stateOrProvinceName="ST",o.O=n.organizationName,o.organizationName="O",o.OU=n.organizationalUnitName,
o.organizationalUnitName="OU",o.E=n.emailAddress,o.emailAddress="E";var p=k.pki.rsa.publicKeyValidator,q={name:"Certificate",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:l.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:l.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:l.Class.UNIVERSAL,type:l.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:l.Class.UNIVERSAL,type:l.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:l.Class.UNIVERSAL,type:l.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:l.Class.UNIVERSAL,type:l.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},p,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:l.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:l.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:l.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:l.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},r={name:"rsapss",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:l.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:l.Class.UNIVERSAL,type:l.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:l.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:l.Class.UNIVERSAL,type:l.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:l.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:l.Class.UNIVERSAL,type:l.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:l.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:l.Class.UNIVERSAL,type:l.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},s={name:"CertificationRequestInfo",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},p,{name:"CertificationRequestInfo.attributes",tagClass:l.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:l.Class.UNIVERSAL,type:l.Type.SET,constructed:!0}]}]}]},t={name:"CertificationRequest",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[s,{name:"CertificationRequest.signatureAlgorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:l.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};m.RDNAttributesAsArray=function(a,b){for(var c,d,e,f=[],g=0;g<a.value.length;++g){c=a.value[g];for(var h=0;h<c.value.length;++h)e={},d=c.value[h],e.type=l.derToOid(d.value[0].value),e.value=d.value[1].value,e.valueTagClass=d.value[1].type,e.type in n&&(e.name=n[e.type],e.name in o&&(e.shortName=o[e.name])),b&&(b.update(e.type),b.update(e.value)),f.push(e)}return f},m.CRIAttributesAsArray=function(a){for(var b=[],c=0;c<a.length;++c)for(var d=a[c],e=l.derToOid(d.value[0].value),f=d.value[1].value,g=0;g<f.length;++g){var h={};if(h.type=e,h.value=f[g].value,h.valueTagClass=f[g].type,h.type in n&&(h.name=n[h.type],h.name in o&&(h.shortName=o[h.name])),h.type===n.extensionRequest){h.extensions=[];for(var i=0;i<h.value.length;++i)h.extensions.push(m.certificateExtensionFromAsn1(h.value[i]))}b.push(h)}return b};var u=function(a,b,c){var d={};if(a!==n["RSASSA-PSS"])return d;c&&(d={hash:{algorithmOid:n.sha1},mgf:{algorithmOid:n.mgf1,hash:{algorithmOid:n.sha1}},saltLength:20});var e={},f=[];if(!l.validate(b,r,e,f)){var g=new Error("Cannot read RSASSA-PSS parameter block.");throw g.errors=f,g}return void 0!==e.hashOid&&(d.hash=d.hash||{},d.hash.algorithmOid=l.derToOid(e.hashOid)),void 0!==e.maskGenOid&&(d.mgf=d.mgf||{},d.mgf.algorithmOid=l.derToOid(e.maskGenOid),d.mgf.hash=d.mgf.hash||{},d.mgf.hash.algorithmOid=l.derToOid(e.maskGenHashOid)),void 0!==e.saltLength&&(d.saltLength=e.saltLength.charCodeAt(0)),d};m.certificateFromPem=function(a,b,c){var d=k.pem.decode(a)[0];if("CERTIFICATE"!==d.type&&"X509 CERTIFICATE"!==d.type&&"TRUSTED CERTIFICATE"!==d.type){var e=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw e.headerType=d.type,e}if(d.procType&&"ENCRYPTED"===d.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var f=l.fromDer(d.body,c);return m.certificateFromAsn1(f,b)},m.certificateToPem=function(a,b){var c={type:"CERTIFICATE",body:l.toDer(m.certificateToAsn1(a)).getBytes()};return k.pem.encode(c,{maxline:b})},m.publicKeyFromPem=function(a){var b=k.pem.decode(a)[0];if("PUBLIC KEY"!==b.type&&"RSA PUBLIC KEY"!==b.type){var c=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw c.headerType=b.type,c}if(b.procType&&"ENCRYPTED"===b.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var d=l.fromDer(b.body);return m.publicKeyFromAsn1(d)},m.publicKeyToPem=function(a,b){var c={type:"PUBLIC KEY",body:l.toDer(m.publicKeyToAsn1(a)).getBytes()};return k.pem.encode(c,{maxline:b})},m.publicKeyToRSAPublicKeyPem=function(a,b){var c={type:"RSA PUBLIC KEY",body:l.toDer(m.publicKeyToRSAPublicKey(a)).getBytes()};return k.pem.encode(c,{maxline:b})},m.getPublicKeyFingerprint=function(a,b){b=b||{};var c,d=b.md||k.md.sha1.create(),e=b.type||"RSAPublicKey";switch(e){case"RSAPublicKey":c=l.toDer(m.publicKeyToRSAPublicKey(a)).getBytes();break;case"SubjectPublicKeyInfo":c=l.toDer(m.publicKeyToAsn1(a)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+b.type+'".')}d.start(),d.update(c);var f=d.digest();if("hex"===b.encoding){var g=f.toHex();return b.delimiter?g.match(/.{2}/g).join(b.delimiter):g}if("binary"===b.encoding)return f.getBytes();if(b.encoding)throw new Error('Unknown encoding "'+b.encoding+'".');return f},m.certificationRequestFromPem=function(a,b,c){var d=k.pem.decode(a)[0];if("CERTIFICATE REQUEST"!==d.type){var e=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw e.headerType=d.type,e}if(d.procType&&"ENCRYPTED"===d.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var f=l.fromDer(d.body,c);return m.certificationRequestFromAsn1(f,b)},m.certificationRequestToPem=function(a,b){var c={type:"CERTIFICATE REQUEST",body:l.toDer(m.certificationRequestToAsn1(a)).getBytes()};return k.pem.encode(c,{maxline:b})},m.createCertificate=function(){var a={};return a.version=2,a.serialNumber="00",a.signatureOid=null,a.signature=null,a.siginfo={},a.siginfo.algorithmOid=null,a.validity={},a.validity.notBefore=new Date,a.validity.notAfter=new Date,a.issuer={},a.issuer.getField=function(b){return d(a.issuer,b)},a.issuer.addField=function(b){f([b]),a.issuer.attributes.push(b)},a.issuer.attributes=[],a.issuer.hash=null,a.subject={},a.subject.getField=function(b){return d(a.subject,b)},a.subject.addField=function(b){f([b]),a.subject.attributes.push(b)},a.subject.attributes=[],a.subject.hash=null,a.extensions=[],a.publicKey=null,a.md=null,a.setSubject=function(b,c){f(b),a.subject.attributes=b,delete a.subject.uniqueId,c&&(a.subject.uniqueId=c),a.subject.hash=null},a.setIssuer=function(b,c){f(b),a.issuer.attributes=b,delete a.issuer.uniqueId,c&&(a.issuer.uniqueId=c),a.issuer.hash=null},a.setExtensions=function(b){for(var c=0;c<b.length;++c)g(b[c],{cert:a});a.extensions=b},a.getExtension=function(b){"string"==typeof b&&(b={name:b});for(var c,d=null,e=0;null===d&&e<a.extensions.length;++e)c=a.extensions[e],b.id&&c.id===b.id?d=c:b.name&&c.name===b.name&&(d=c);return d},a.sign=function(b,c){a.md=c||k.md.sha1.create();var d=n[a.md.algorithm+"WithRSAEncryption"];if(!d){var e=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw e.algorithm=a.md.algorithm,e}a.signatureOid=a.siginfo.algorithmOid=d,a.tbsCertificate=m.getTBSCertificate(a);var f=l.toDer(a.tbsCertificate);a.md.update(f.getBytes()),a.signature=b.sign(a.md)},a.verify=function(b){var c=!1;if(!a.issued(b)){var d=b.issuer,e=a.subject,f=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw f.expectedIssuer=d.attributes,f.actualIssuer=e.attributes,f}var g=b.md;if(null===g){if(b.signatureOid in n){var h=n[b.signatureOid];switch(h){case"sha1WithRSAEncryption":g=k.md.sha1.create();break;case"md5WithRSAEncryption":g=k.md.md5.create();break;case"sha256WithRSAEncryption":g=k.md.sha256.create();break;case"sha384WithRSAEncryption":g=k.md.sha384.create();break;case"sha512WithRSAEncryption":g=k.md.sha512.create();break;case"RSASSA-PSS":g=k.md.sha256.create()}}if(null===g){var f=new Error("Could not compute certificate digest. Unknown signature OID.");throw f.signatureOid=b.signatureOid,f}var i=b.tbsCertificate||m.getTBSCertificate(b),j=l.toDer(i);g.update(j.getBytes())}if(null!==g){var o;switch(b.signatureOid){case n.sha1WithRSAEncryption:o=void 0;break;case n["RSASSA-PSS"]:var p,q;if(p=n[b.signatureParameters.mgf.hash.algorithmOid],void 0===p||void 0===k.md[p]){var f=new Error("Unsupported MGF hash function.");throw f.oid=b.signatureParameters.mgf.hash.algorithmOid,f.name=p,f}if(q=n[b.signatureParameters.mgf.algorithmOid],void 0===q||void 0===k.mgf[q]){var f=new Error("Unsupported MGF function.");throw f.oid=b.signatureParameters.mgf.algorithmOid,f.name=q,f}if(q=k.mgf[q].create(k.md[p].create()),p=n[b.signatureParameters.hash.algorithmOid],void 0===p||void 0===k.md[p])throw{message:"Unsupported RSASSA-PSS hash function.",oid:b.signatureParameters.hash.algorithmOid,name:p};o=k.pss.create(k.md[p].create(),q,b.signatureParameters.saltLength)}c=a.publicKey.verify(g.digest().getBytes(),b.signature,o)}return c},a.isIssuer=function(b){var c=!1,d=a.issuer,e=b.subject;if(d.hash&&e.hash)c=d.hash===e.hash;else if(d.attributes.length===e.attributes.length){c=!0;for(var f,g,h=0;c&&h<d.attributes.length;++h)f=d.attributes[h],g=e.attributes[h],f.type===g.type&&f.value===g.value||(c=!1)}return c},a.issued=function(b){return b.isIssuer(a)},a.generateSubjectKeyIdentifier=function(){return m.getPublicKeyFingerprint(a.publicKey,{type:"RSAPublicKey"})},a.verifySubjectKeyIdentifier=function(){for(var b=n.subjectKeyIdentifier,c=0;c<a.extensions.length;++c){var d=a.extensions[c];if(d.id===b){var e=a.generateSubjectKeyIdentifier().getBytes();return k.util.hexToBytes(d.subjectKeyIdentifier)===e}}return!1},a},m.certificateFromAsn1=function(a,b){var c={},e=[];if(!l.validate(a,q,c,e)){var g=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw g.errors=e,g}var h=l.derToOid(c.publicKeyOid);if(h!==m.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var i=m.createCertificate();i.version=c.certVersion?c.certVersion.charCodeAt(0):0;var j=k.util.createBuffer(c.certSerialNumber);i.serialNumber=j.toHex(),i.signatureOid=k.asn1.derToOid(c.certSignatureOid),i.signatureParameters=u(i.signatureOid,c.certSignatureParams,!0),i.siginfo.algorithmOid=k.asn1.derToOid(c.certinfoSignatureOid),i.siginfo.parameters=u(i.siginfo.algorithmOid,c.certinfoSignatureParams,!1),i.signature=c.certSignature;var o=[];if(void 0!==c.certValidity1UTCTime&&o.push(l.utcTimeToDate(c.certValidity1UTCTime)),void 0!==c.certValidity2GeneralizedTime&&o.push(l.generalizedTimeToDate(c.certValidity2GeneralizedTime)),void 0!==c.certValidity3UTCTime&&o.push(l.utcTimeToDate(c.certValidity3UTCTime)),void 0!==c.certValidity4GeneralizedTime&&o.push(l.generalizedTimeToDate(c.certValidity4GeneralizedTime)),o.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(o.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(i.validity.notBefore=o[0],i.validity.notAfter=o[1],i.tbsCertificate=c.tbsCertificate,b){if(i.md=null,i.signatureOid in n){var h=n[i.signatureOid];switch(h){case"sha1WithRSAEncryption":i.md=k.md.sha1.create();break;case"md5WithRSAEncryption":i.md=k.md.md5.create();break;case"sha256WithRSAEncryption":i.md=k.md.sha256.create();break;case"sha384WithRSAEncryption":i.md=k.md.sha384.create();break;case"sha512WithRSAEncryption":i.md=k.md.sha512.create();break;case"RSASSA-PSS":i.md=k.md.sha256.create()}}if(null===i.md){var g=new Error("Could not compute certificate digest. Unknown signature OID.");throw g.signatureOid=i.signatureOid,g}var p=l.toDer(i.tbsCertificate);i.md.update(p.getBytes())}var r=k.md.sha1.create();i.issuer.getField=function(a){return d(i.issuer,a)},i.issuer.addField=function(a){f([a]),i.issuer.attributes.push(a)},i.issuer.attributes=m.RDNAttributesAsArray(c.certIssuer,r),c.certIssuerUniqueId&&(i.issuer.uniqueId=c.certIssuerUniqueId),i.issuer.hash=r.digest().toHex();var s=k.md.sha1.create();return i.subject.getField=function(a){return d(i.subject,a)},i.subject.addField=function(a){f([a]),i.subject.attributes.push(a)},i.subject.attributes=m.RDNAttributesAsArray(c.certSubject,s),c.certSubjectUniqueId&&(i.subject.uniqueId=c.certSubjectUniqueId),i.subject.hash=s.digest().toHex(),c.certExtensions?i.extensions=m.certificateExtensionsFromAsn1(c.certExtensions):i.extensions=[],i.publicKey=m.publicKeyFromAsn1(c.subjectPublicKeyInfo),i},m.certificateExtensionsFromAsn1=function(a){for(var b=[],c=0;c<a.value.length;++c)for(var d=a.value[c],e=0;e<d.value.length;++e)b.push(m.certificateExtensionFromAsn1(d.value[e]));return b},m.certificateExtensionFromAsn1=function(a){var b={};if(b.id=l.derToOid(a.value[0].value),b.critical=!1,a.value[1].type===l.Type.BOOLEAN?(b.critical=0!==a.value[1].value.charCodeAt(0),b.value=a.value[2].value):b.value=a.value[1].value,b.id in n)if(b.name=n[b.id],"keyUsage"===b.name){var c=l.fromDer(b.value),d=0,e=0;c.value.length>1&&(d=c.value.charCodeAt(1),e=c.value.length>2?c.value.charCodeAt(2):0),b.digitalSignature=128===(128&d),b.nonRepudiation=64===(64&d),b.keyEncipherment=32===(32&d),b.dataEncipherment=16===(16&d),b.keyAgreement=8===(8&d),b.keyCertSign=4===(4&d),b.cRLSign=2===(2&d),b.encipherOnly=1===(1&d),b.decipherOnly=128===(128&e)}else if("basicConstraints"===b.name){var c=l.fromDer(b.value);c.value.length>0&&c.value[0].type===l.Type.BOOLEAN?b.cA=0!==c.value[0].value.charCodeAt(0):b.cA=!1;var f=null;c.value.length>0&&c.value[0].type===l.Type.INTEGER?f=c.value[0].value:c.value.length>1&&(f=c.value[1].value),null!==f&&(b.pathLenConstraint=l.derToInteger(f))}else if("extKeyUsage"===b.name)for(var c=l.fromDer(b.value),g=0;g<c.value.length;++g){var h=l.derToOid(c.value[g].value);h in n?b[n[h]]=!0:b[h]=!0}else if("nsCertType"===b.name){var c=l.fromDer(b.value),d=0;c.value.length>1&&(d=c.value.charCodeAt(1)),b.client=128===(128&d),b.server=64===(64&d),b.email=32===(32&d),b.objsign=16===(16&d),b.reserved=8===(8&d),b.sslCA=4===(4&d),b.emailCA=2===(2&d),b.objCA=1===(1&d)}else if("subjectAltName"===b.name||"issuerAltName"===b.name){b.altNames=[];for(var i,c=l.fromDer(b.value),j=0;j<c.value.length;++j){i=c.value[j];var m={type:i.type,value:i.value};switch(b.altNames.push(m),i.type){case 1:case 2:case 6:break;case 7:m.ip=k.util.bytesToIP(i.value);break;case 8:m.oid=l.derToOid(i.value)}}}else if("subjectKeyIdentifier"===b.name){var c=l.fromDer(b.value);b.subjectKeyIdentifier=k.util.bytesToHex(c.value)}return b},m.certificationRequestFromAsn1=function(a,b){var c={},e=[];if(!l.validate(a,t,c,e)){var g=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw g.errors=e,g}var h=l.derToOid(c.publicKeyOid);if(h!==m.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var i=m.createCertificationRequest();if(i.version=c.csrVersion?c.csrVersion.charCodeAt(0):0,i.signatureOid=k.asn1.derToOid(c.csrSignatureOid),i.signatureParameters=u(i.signatureOid,c.csrSignatureParams,!0),i.siginfo.algorithmOid=k.asn1.derToOid(c.csrSignatureOid),i.siginfo.parameters=u(i.siginfo.algorithmOid,c.csrSignatureParams,!1),i.signature=c.csrSignature,i.certificationRequestInfo=c.certificationRequestInfo,b){if(i.md=null,i.signatureOid in n){var h=n[i.signatureOid];switch(h){case"sha1WithRSAEncryption":i.md=k.md.sha1.create();break;case"md5WithRSAEncryption":i.md=k.md.md5.create();break;case"sha256WithRSAEncryption":i.md=k.md.sha256.create();break;case"sha384WithRSAEncryption":i.md=k.md.sha384.create();break;case"sha512WithRSAEncryption":i.md=k.md.sha512.create();break;case"RSASSA-PSS":i.md=k.md.sha256.create()}}if(null===i.md){var g=new Error("Could not compute certification request digest. Unknown signature OID.");throw g.signatureOid=i.signatureOid,g}var j=l.toDer(i.certificationRequestInfo);i.md.update(j.getBytes())}var o=k.md.sha1.create();return i.subject.getField=function(a){return d(i.subject,a)},i.subject.addField=function(a){f([a]),i.subject.attributes.push(a)},i.subject.attributes=m.RDNAttributesAsArray(c.certificationRequestInfoSubject,o),i.subject.hash=o.digest().toHex(),i.publicKey=m.publicKeyFromAsn1(c.subjectPublicKeyInfo),i.getAttribute=function(a){return d(i,a)},i.addAttribute=function(a){f([a]),i.attributes.push(a)},i.attributes=m.CRIAttributesAsArray(c.certificationRequestInfoAttributes||[]),i},m.createCertificationRequest=function(){var a={};return a.version=0,a.signatureOid=null,a.signature=null,a.siginfo={},a.siginfo.algorithmOid=null,a.subject={},a.subject.getField=function(b){return d(a.subject,b)},a.subject.addField=function(b){f([b]),a.subject.attributes.push(b)},a.subject.attributes=[],a.subject.hash=null,a.publicKey=null,a.attributes=[],a.getAttribute=function(b){return d(a,b)},a.addAttribute=function(b){f([b]),a.attributes.push(b)},a.md=null,a.setSubject=function(b){f(b),a.subject.attributes=b,a.subject.hash=null},a.setAttributes=function(b){f(b),a.attributes=b},a.sign=function(b,c){a.md=c||k.md.sha1.create();var d=n[a.md.algorithm+"WithRSAEncryption"];if(!d){var e=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw e.algorithm=a.md.algorithm,e}a.signatureOid=a.siginfo.algorithmOid=d,a.certificationRequestInfo=m.getCertificationRequestInfo(a);var f=l.toDer(a.certificationRequestInfo);a.md.update(f.getBytes()),a.signature=b.sign(a.md)},a.verify=function(){var b=!1,c=a.md;if(null===c){if(a.signatureOid in n){var d=n[a.signatureOid];switch(d){case"sha1WithRSAEncryption":c=k.md.sha1.create();break;case"md5WithRSAEncryption":c=k.md.md5.create();break;case"sha256WithRSAEncryption":c=k.md.sha256.create();break;case"sha384WithRSAEncryption":c=k.md.sha384.create();break;case"sha512WithRSAEncryption":c=k.md.sha512.create();break;case"RSASSA-PSS":c=k.md.sha256.create()}}if(null===c){var e=new Error("Could not compute certification request digest. Unknown signature OID.");throw e.signatureOid=a.signatureOid,e}var f=a.certificationRequestInfo||m.getCertificationRequestInfo(a),g=l.toDer(f);c.update(g.getBytes())}if(null!==c){var h;switch(a.signatureOid){case n.sha1WithRSAEncryption:break;case n["RSASSA-PSS"]:var i,j;if(i=n[a.signatureParameters.mgf.hash.algorithmOid],void 0===i||void 0===k.md[i]){var e=new Error("Unsupported MGF hash function.");throw e.oid=a.signatureParameters.mgf.hash.algorithmOid,e.name=i,e}if(j=n[a.signatureParameters.mgf.algorithmOid],void 0===j||void 0===k.mgf[j]){var e=new Error("Unsupported MGF function.");throw e.oid=a.signatureParameters.mgf.algorithmOid,e.name=j,e}if(j=k.mgf[j].create(k.md[i].create()),i=n[a.signatureParameters.hash.algorithmOid],void 0===i||void 0===k.md[i]){var e=new Error("Unsupported RSASSA-PSS hash function.");throw e.oid=a.signatureParameters.hash.algorithmOid,e.name=i,e}h=k.pss.create(k.md[i].create(),j,a.signatureParameters.saltLength)}b=a.publicKey.verify(c.digest().getBytes(),a.signature,h)}return b},a};var v=new Date("1950-01-01T00:00:00Z"),w=new Date("2050-01-01T00:00:00Z");m.getTBSCertificate=function(a){var b=j(a.validity.notBefore),c=j(a.validity.notAfter),d=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(a.version).getBytes())]),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,k.util.hexToBytes(a.serialNumber)),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(a.siginfo.algorithmOid).getBytes()),h(a.siginfo.algorithmOid,a.siginfo.parameters)]),e(a.issuer),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[b,c]),e(a.subject),m.publicKeyToAsn1(a.publicKey)]);return a.issuer.uniqueId&&d.value.push(l.create(l.Class.CONTEXT_SPECIFIC,1,!0,[l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,String.fromCharCode(0)+a.issuer.uniqueId)])),a.subject.uniqueId&&d.value.push(l.create(l.Class.CONTEXT_SPECIFIC,2,!0,[l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,String.fromCharCode(0)+a.subject.uniqueId)])),a.extensions.length>0&&d.value.push(m.certificateExtensionsToAsn1(a.extensions)),d},m.getCertificationRequestInfo=function(a){var b=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(a.version).getBytes()),e(a.subject),m.publicKeyToAsn1(a.publicKey),i(a)]);return b},m.distinguishedNameToAsn1=function(a){return e(a)},m.certificateToAsn1=function(a){var b=a.tbsCertificate||m.getTBSCertificate(a);return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[b,l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(a.signatureOid).getBytes()),h(a.signatureOid,a.signatureParameters)]),l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])},m.certificateExtensionsToAsn1=function(a){var b=l.create(l.Class.CONTEXT_SPECIFIC,3,!0,[]),c=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);b.value.push(c);for(var d=0;d<a.length;++d)c.value.push(m.certificateExtensionToAsn1(a[d]));return b},m.certificateExtensionToAsn1=function(a){var b=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);b.value.push(l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(a.id).getBytes())),a.critical&&b.value.push(l.create(l.Class.UNIVERSAL,l.Type.BOOLEAN,!1,String.fromCharCode(255)));var c=a.value;return"string"!=typeof a.value&&(c=l.toDer(c).getBytes()),b.value.push(l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,c)),b},m.certificationRequestToAsn1=function(a){var b=a.certificationRequestInfo||m.getCertificationRequestInfo(a);return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[b,l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(a.signatureOid).getBytes()),h(a.signatureOid,a.signatureParameters)]),l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])},m.createCaStore=function(a){function b(a){return c(a),d.certs[a.hash]||null}function c(a){if(!a.hash){var b=k.md.sha1.create();a.attributes=m.RDNAttributesAsArray(e(a),b),a.hash=b.digest().toHex()}}var d={certs:{}};if(d.getIssuer=function(a){var c=b(a.issuer);return c},d.addCertificate=function(a){if("string"==typeof a&&(a=k.pki.certificateFromPem(a)),c(a.subject),!d.hasCertificate(a))if(a.subject.hash in d.certs){var b=d.certs[a.subject.hash];k.util.isArray(b)||(b=[b]),b.push(a),d.certs[a.subject.hash]=b}else d.certs[a.subject.hash]=a},d.hasCertificate=function(a){"string"==typeof a&&(a=k.pki.certificateFromPem(a));var c=b(a.subject);if(!c)return!1;k.util.isArray(c)||(c=[c]);for(var d=l.toDer(m.certificateToAsn1(a)).getBytes(),e=0;e<c.length;++e){var f=l.toDer(m.certificateToAsn1(c[e])).getBytes();if(d===f)return!0}return!1},d.listAllCertificates=function(){var a=[];for(var b in d.certs)if(d.certs.hasOwnProperty(b)){var c=d.certs[b];if(k.util.isArray(c))for(var e=0;e<c.length;++e)a.push(c[e]);else a.push(c)}return a},d.removeCertificate=function(a){var e;if("string"==typeof a&&(a=k.pki.certificateFromPem(a)),c(a.subject),!d.hasCertificate(a))return null;var f=b(a.subject);if(!k.util.isArray(f))return e=d.certs[a.subject.hash],delete d.certs[a.subject.hash],e;for(var g=l.toDer(m.certificateToAsn1(a)).getBytes(),h=0;h<f.length;++h){var i=l.toDer(m.certificateToAsn1(f[h])).getBytes();g===i&&(e=f[h],f.splice(h,1))}return 0===f.length&&delete d.certs[a.subject.hash],e},a)for(var f=0;f<a.length;++f){var g=a[f];d.addCertificate(g)}return d},m.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},m.verifyCertificateChain=function(a,b,c){"function"==typeof c&&(c={verify:c}),c=c||{},b=b.slice(0);var d=b.slice(0),e=c.validityCheckDate;"undefined"==typeof e&&(e=new Date);var f=!0,g=null,h=0;do{var i=b.shift(),j=null,l=!1;if(e&&(e<i.validity.notBefore||e>i.validity.notAfter)&&(g={message:"Certificate is not valid yet or has expired.",error:m.certificateError.certificate_expired,notBefore:i.validity.notBefore,notAfter:i.validity.notAfter,now:e}),null===g){if(j=b[0]||a.getIssuer(i),null===j&&i.isIssuer(i)&&(l=!0,j=i),j){var n=j;k.util.isArray(n)||(n=[n]);for(var o=!1;!o&&n.length>0;){j=n.shift();try{o=j.verify(i)}catch(p){}}o||(g={message:"Certificate signature is invalid.",error:m.certificateError.bad_certificate})}null!==g||j&&!l||a.hasCertificate(i)||(g={message:"Certificate is not trusted.",error:m.certificateError.unknown_ca})}if(null===g&&j&&!i.isIssuer(j)&&(g={message:"Certificate issuer is invalid.",error:m.certificateError.bad_certificate}),null===g)for(var q={keyUsage:!0,basicConstraints:!0},r=0;null===g&&r<i.extensions.length;++r){var s=i.extensions[r];!s.critical||s.name in q||(g={message:"Certificate has an unsupported critical extension.",error:m.certificateError.unsupported_certificate})}if(null===g&&(!f||0===b.length&&(!j||l))){var t=i.getExtension("basicConstraints"),u=i.getExtension("keyUsage");if(null!==u&&(u.keyCertSign&&null!==t||(g={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:m.certificateError.bad_certificate})),null!==g||null===t||t.cA||(g={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:m.certificateError.bad_certificate}),null===g&&null!==u&&"pathLenConstraint"in t){var v=h-1;v>t.pathLenConstraint&&(g={message:"Certificate basicConstraints pathLenConstraint violated.",error:m.certificateError.bad_certificate})}}var w=null===g||g.error,x=c.verify?c.verify(w,h,d):w;if(x!==!0)throw w===!0&&(g={message:"The application rejected the certificate.",error:m.certificateError.bad_certificate}),(x||0===x)&&("object"!=typeof x||k.util.isArray(x)?"string"==typeof x&&(g.error=x):(x.message&&(g.message=x.message),x.error&&(g.error=x.error))),g;g=null,f=!1,++h}while(b.length>0);return!0}},{"./aes":37,"./asn1":40,"./des":45,"./forge":47,"./md":54,"./mgf":56,"./oids":58,"./pem":61,"./pss":69,"./rsa":72,"./util":79}],81:[function(a,b,c){function d(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(a){if(l===setTimeout)return setTimeout(a,0);if((l===d||!l)&&setTimeout)return l=setTimeout,setTimeout(a,0);try{return l(a,0)}catch(b){try{return l.call(null,a,0)}catch(b){return l.call(this,a,0)}}}function g(a){if(m===clearTimeout)return clearTimeout(a);if((m===e||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(a);try{return m(a)}catch(b){try{return m.call(null,a)}catch(b){return m.call(this,a)}}}function h(){q&&o&&(q=!1,o.length?p=o.concat(p):r=-1,p.length&&i())}function i(){if(!q){var a=f(h);q=!0;for(var b=p.length;b;){for(o=p,p=[];++r<b;)o&&o[r].run();r=-1,b=p.length}o=null,q=!1,g(a)}}function j(a,b){this.fun=a,this.array=b}function k(){}
var l,m,n=b.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:d}catch(a){l=d}try{m="function"==typeof clearTimeout?clearTimeout:e}catch(a){m=e}}();var o,p=[],q=!1,r=-1;n.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];p.push(new j(a,b)),1!==p.length||q||f(i)},j.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=k,n.addListener=k,n.once=k,n.off=k,n.removeListener=k,n.removeAllListeners=k,n.emit=k,n.prependListener=k,n.prependOnceListener=k,n.listeners=function(a){return[]},n.binding=function(a){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(a){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],82:[function(a,b,c){(function(b,d){function e(a,b){this._id=a,this._clearFn=b}var f=a("process/browser.js").nextTick,g=Function.prototype.apply,h=Array.prototype.slice,i={},j=0;c.setTimeout=function(){return new e(g.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new e(g.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(a){a.close()},e.prototype.unref=e.prototype.ref=function(){},e.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(a,b){clearTimeout(a._idleTimeoutId),a._idleTimeout=b},c.unenroll=function(a){clearTimeout(a._idleTimeoutId),a._idleTimeout=-1},c._unrefActive=c.active=function(a){clearTimeout(a._idleTimeoutId);var b=a._idleTimeout;b>=0&&(a._idleTimeoutId=setTimeout(function(){a._onTimeout&&a._onTimeout()},b))},c.setImmediate="function"==typeof b?b:function(a){var b=j++,d=!(arguments.length<2)&&h.call(arguments,1);return i[b]=!0,f(function(){i[b]&&(d?a.apply(null,d):a.call(null),c.clearImmediate(b))}),b},c.clearImmediate="function"==typeof d?d:function(a){delete i[a]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":81,timers:82}],83:[function(a,b,c){b.exports={name:"elliptic-expo",version:"6.5.2",description:"EC cryptography for Expo",main:"lib/elliptic.js",files:["lib"],scripts:{jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",lint:"npm run jscs && npm run jshint",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:enyalabs/elliptic-expo"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Jan Liphardt",license:"MIT",bugs:{url:"https://github.com/enyalabs/elliptic-expo/issues"},homepage:"https://github.com/enyalabs/elliptic-expo",devDependencies:{brfs:"^1.4.3",coveralls:"^3.0.8",grunt:"^1.0.4","grunt-browserify":"^5.0.0","grunt-cli":"^1.2.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.2",jscs:"^3.0.7",jshint:"^2.10.3",mocha:"^6.2.2"},dependencies:{benchmark:"^2.1.4","bn.js":"^5.1.1",buffer:"^5.4.3","hash.js":"^1.0.0","hmac-drbg":"^1.0.0",inherits:"^2.0.1","minimalistic-assert":"^1.0.0","minimalistic-crypto-utils":"^1.0.0","node-forge":"^0.9.1"}}},{}]},{},[1])(1)});